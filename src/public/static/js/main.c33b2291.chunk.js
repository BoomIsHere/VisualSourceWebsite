(this.webpackJsonpkevin_online=this.webpackJsonpkevin_online||[]).push([[0],{1692:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=1692},1713:function(e,t,a){},1714:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(105),c=a.n(i),o=a(1716),s=a(15),l=a(72),d=Object(l.a)();function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.search,t={},a=function(e,a){-1!==e.indexOf("[]")?(e=e.replace("[]",""),Array.isArray(t[e])?t[e].push(a):t[e]=[a]):t[e]=a};if(e)return e.replace("?","").split("&").forEach((function(e){var t=decodeURIComponent(e.split("=")[0]),n=decodeURIComponent(e.split("=")[1]);-1!==e.indexOf("=")&&a(t,n)})),t}function h(e,t){var a=t.replace,n=void 0!==a&&a,r=t.query,i="".concat(e).concat(function(e){var t,a=[],n=function(n){e.hasOwnProperty(n)&&(t=e[n],Array.isArray(t)?t.forEach((function(e){a.push("".concat(encodeURIComponent(n),"[]=").concat(encodeURIComponent(e)))})):a.push("".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(t))))};for(var r in e)n(r);return"?"+a.join("&")}(r));n?d.replace(i):d.push(i)}var f=a(30);function v(e){return r.a.createElement("div",{className:e.active?"active":"",onClick:function(){return h(e.route,{})}},e.children,r.a.createElement("span",null,e.text))}var p=[{text:"Home",route:"/",html:r.a.createElement("i",{className:"material-icons"},"home")},{text:"Play",route:"/play",html:r.a.createElement("i",{className:"material-icons"},"play_circle_filled")},{text:"Deck Editor",route:"/editor",html:r.a.createElement("i",{className:"material-icons"},"edit")},{text:"Account",route:"/account",html:r.a.createElement("i",{className:"material-icons"},"account_circle")},{text:"Settings",route:"/settings",html:r.a.createElement("i",{className:"material-icons"},"settings")}];function m(e){var t=Object(n.useState)(""),a=Object(s.a)(t,2),i=a[0],c=a[1];return Object(n.useEffect)((function(){f.b.read("version").then((function(e){return c(e.for)}))}),[]),r.a.createElement("nav",{id:"side-nav"},r.a.createElement("header",null,r.a.createElement("h5",null,"Kevin Online")),p.map((function(t,a){return a===e.activeTab?r.a.createElement(v,{key:a,active:!0,text:t.text,route:t.route},t.html):r.a.createElement(v,{key:a,active:!1,text:t.text,route:t.route},t.html)})),r.a.createElement("footer",null,r.a.createElement("p",null,"Version: ".concat(i))))}var g=a(646),_=a.n(g),y=a(106),b=a.n(y),k=a(163),w=a.n(k),E=a(53),O=a.n(E),x=a(209),j=a.n(x),C=a(22),S=a.n(C),D=a(329),I=a.n(D),P=a(10),T=a(14),G=a(21),N=a(20),R=a(11),A=null,M=function(e){Object(G.a)(a,e);var t=Object(N.a)(a);function a(){return Object(P.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,null,[{key:"getInstance",value:function(){return null==A&&(A=new a),A}}]),a}(R.Events.EventEmitter),z=new M,L=function(e){Object(G.a)(a,e);var t=Object(N.a)(a);function a(){var e;return Object(P.a)(this,a),(e=t.call(this,"Viwer")).card=null,e.flipTween=null,e.flipBackTween=null,e.screenX=560,e.screenY=400,e.backTexture="default",e.frontTexture="pyro_kevin",z.on("restart",(function(t){e.frontTexture=t.visual.front_texture,e.backTexture=t.visual.back_texture,e.scene.restart()})),e}return Object(T.a)(a,[{key:"preload",value:function(){var e,t,a,n,r=this,i=null===(e=f.a.getInst().data)||void 0===e?void 0:e.assets.find((function(e){return e.name===r.frontTexture})),c=null===(t=f.a.getInst().data)||void 0===t?void 0:t.assets.find((function(e){return e.name===r.backTexture}));this.load.image(this.frontTexture,null!==(a=null===i||void 0===i?void 0:i.texture)&&void 0!==a?a:"pyro_kevin.webp"),this.load.image(this.backTexture,null!==(n=null===c||void 0===c?void 0:c.texture)&&void 0!==n?n:"default_backing.webp")}},{key:"create",value:function(){var e=this,t=this.sys.game.canvas,a=t.width,n=t.height;this.card=this.add.sprite(a/2,n/2,this.frontTexture),this.card.setInteractive().setData("isFlipping",!1).setDisplaySize(this.screenX,this.screenY),this.card.on("pointerdown",(function(t){var a,n,r,i;(null===(a=e.card)||void 0===a?void 0:a.getData("isFlipping"))?null===(n=e.flipBackTween)||void 0===n||n.play():(null===(r=e.card)||void 0===r||r.setData("isFlipping",!0),null===(i=e.flipTween)||void 0===i||i.play())})),this.flipTween=this.tweens.create({targets:this.card,scaleY:.2,caleX:0,duration:200,ease:"Linear"}),this.flipTween.on("complete",(function(){var t;null===(t=e.card)||void 0===t||t.setTexture(e.backTexture).setDisplaySize(e.screenX,e.screenY)})),this.flipBackTween=this.tweens.create({targets:this.card,scaleY:1,scaleX:1,duration:200,ease:"Linear"}),this.flipBackTween.on("complete",(function(){var t;null===(t=e.card)||void 0===t||t.setTexture(e.frontTexture).setDisplaySize(e.screenX,e.screenY).setData("isFlipping",!1)}))}}]),a}(R.Scene),U=function(e){Object(G.a)(a,e);var t=Object(N.a)(a);function a(e){return Object(P.a)(this,a),t.call(this,{canvas:e,type:R.WEBGL,banner:!1,backgroundColor:"#F1F8FE",title:"Viewer",scene:L,scale:{mode:R.Scale.RESIZE},physics:{default:!1},version:"0.1.1-alpha",fps:{min:30,target:60},input:{keyboard:!0,gamepad:!1}})}return a}(R.Game);var W=I()();function B(){var e=Object(n.createRef)(),t=Object(n.useState)(!1),a=Object(s.a)(t,2),i=a[0],c=a[1],o=Object(n.useState)([]),l=Object(s.a)(o,2),d=l[0],u=l[1],v=Object(n.useState)([]),p=Object(s.a)(v,2),m=p[0],g=p[1],y=Object(n.useState)(0),k=Object(s.a)(y,2),E=k[0],x=k[1],C=Object(n.useState)(),D=Object(s.a)(C,2),I=D[0],P=D[1],T=Object(n.useState)(!1),G=Object(s.a)(T,2),N=G[0],R=(G[1],Object(n.useState)("")),A=Object(s.a)(R,2),M=(A[0],A[1]),L=function(){var e=0;return m.forEach((function(t){e+=t.amount})),x(e),e},B=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];h("/",{})};return Object(n.useEffect)((function(){var t;document.title="Kevin Online - Deck Editor",f.a.getInst().fetch().then((function(e){u(e.cards)})),L(),e.current&&(t=e.current,new U(t))}),[]),r.a.createElement("div",{id:"editor"},r.a.createElement(j.a,{title:"You have a unsaved deck!",visible:i,onClose:function(){return c(!1)},footer:[r.a.createElement(S.a,{key:1,onClick:function(){return B()}},"Save and Exit"),r.a.createElement(S.a,{key:2,onClick:function(){return B()}},"Exit")]},"Do you want to save the changes?"),r.a.createElement("div",{id:"card-viewer"},r.a.createElement(S.a,{type:"secondary",onClick:function(){N?B():c(!0)}},"Exit"),r.a.createElement("canvas",{ref:e}),void 0!==I?r.a.createElement(O.a,{shadow:!0},r.a.createElement(O.a.Body,null,r.a.createElement("h6",null,null===I||void 0===I?void 0:I.rarity),r.a.createElement("h2",null,I.name),r.a.createElement("p",null,I.description))):null),r.a.createElement("div",{id:"card-selection"},r.a.createElement("section",{id:"finder"},r.a.createElement("nav",null,r.a.createElement(w.a,{onCreate:function(e){return e},keygen:function(e){return"".concat(e).concat(Math.random().toPrecision(3))},data:["Common","Un-common","Rare","Spell","Trap"],placeholder:"Search",multiple:!0,onFilter:function(e){return function(t){return t.indexOf(e)>=0}},filterDelay:0}),r.a.createElement(S.a,{type:"primary"},"Search")),r.a.createElement("section",null,d.map((function(e){var t=m[e.index]?m[e.index].amount:0;return r.a.createElement(O.a,{key:e.name},r.a.createElement("h3",null,e.name),r.a.createElement("p",null,e.description),r.a.createElement("div",null,r.a.createElement("span",null,r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},r.a.createElement("defs",null,r.a.createElement("clipPath",{id:"clip-path"},r.a.createElement("rect",{className:"cls-1",width:"16",height:"16"}))),r.a.createElement("g",{id:"Symbol_96_1","data-name":"Symbol 96 \u2013 1",className:"cls-2"},r.a.createElement("path",{id:"Chat",className:"cls-3",d:"M5,8A.945.945,0,0,0,6,9h4a1,1,0,0,0,1-1,.945.945,0,0,0-1-1H6A1,1,0,0,0,5,8ZM0,5A4.951,4.951,0,0,1,5,0h6a4.951,4.951,0,0,1,5,5V15a.945.945,0,0,1-1,1H5a4.951,4.951,0,0,1-5-5Z"}))),t," of ",e.deck_settings.max_num_in_deck),r.a.createElement(S.a,{type:"link",onClick:function(){m[e.index]?e.deck_settings.max_num_in_deck>m[e.index].amount&&E<50&&(m[e.index].amount++,g(m),L()):E<50&&(m.push({id:e.index,amount:1}),g(m),L())}},"Add"),r.a.createElement(S.a,{type:"link",onClick:function(){z.emit("restart",d[e.index]),P(d[e.index])}},"View")))})))),r.a.createElement("div",{id:"deck"},r.a.createElement(b.a,{size:"small",placeholder:"Deck Name",type:"text",rules:[W.required,W.min(4)],onChange:function(e){M(e)}}),r.a.createElement("section",null,m.map((function(e){var t;return r.a.createElement(_.a,{key:e.id,onClose:function(){g(m.filter((function(t){return t.id!==e.id}))),setTimeout((function(){x(L())}),1)}},e.amount,null===(t=d[e.id])||void 0===t?void 0:t.name)}))),r.a.createElement("h2",null,m.length>0?E:0," of 50"))))}var Y=a(45),H=a.n(Y),V=a(135),F=null,K=function(){function e(t){Object(P.a)(this,e),this.workerInstance=void 0,this.listeners={},this.workerInstance=new Worker(t),this.workerInstance.onerror=this.onError.bind(this),this.workerInstance.onmessage=this.onMessage.bind(this)}return Object(T.a)(e,null,[{key:"getInstance",value:function(){return null==F&&(h("/play",{}),console.error("No Vaild Worker Instance")),F}},{key:"create",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"singleplayer";return null===F?F=new e("singleplayer"===t?"/workers/AIOpponentWorker.js":"/workers/OnlineOpponetWorker.js"):(F.terminate(),F=null,e.create(t))}},{key:"kill",value:function(){null!==F&&(F.terminate(),F=null)}}]),Object(T.a)(e,[{key:"onMessage",value:function(e){e.data.hasOwnProperty("name")&&(this.listeners[e.data.name]?this.listeners[e.data.name].apply(void 0,e.data.data):console.log(e))}},{key:"onError",value:function(e){console.error(e)}},{key:"send",value:function(e,t){return this.workerInstance.postMessage({name:e,data:[t]}),this}},{key:"terminate",value:function(){return this.workerInstance.terminate(),this}},{key:"addListeners",value:function(e,t){return this.listeners[e]=t,this}},{key:"removeAllListeners",value:function(){return this.listeners={},this}},{key:"removeListeners",value:function(e){return delete this.listeners[e],this}}]),e}();function Z(e,t,a){return Math.min(Math.max(e,a),t)}function q(e,t,a){return e*a+t*(1-a)}function X(e,t,a){return a?t:e}function J(e){return Math.floor(Math.random()*e)}var $=null,Q=function(){function e(){Object(P.a)(this,e),this.userDeck=[],this.opponentDeck=[],this.selected_deck="default"}return Object(T.a)(e,[{key:"init",value:function(){var e=this,t=K.getInstance();t.addListeners("send_deck",(function(){t.send("send_deck",{deck:e.userDeck})}))}},{key:"fetchOpponentDeck",value:function(){var e=Object(V.a)(H.a.mark((function e(){var t,a,n=this;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null!==(t=K.getInstance())&&t.send("request_deck",{}),e.next=4,new Promise((function(e,a){null===t||void 0===t||t.addListeners("request_deck",(function(t){n.opponentDeck=t.deck,e(t.deck)}))}));case 4:return a=e.sent,e.next=7,a;case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setDeck",value:function(e){var t=window.localStorage.getItem("deck_".concat(e));null!==t&&(this.userDeck=JSON.parse(t)),this.selected_deck=e}},{key:"getDecks",value:function(){for(var e=[],t=0;t<window.localStorage.length;t++){var a=window.localStorage.key(t);(null===a||void 0===a?void 0:a.includes("deck_"))&&e.push(a.split("_")[1])}return e}},{key:"loadDeck",value:function(){try{return this.userDeck=JSON.parse(window.localStorage.getItem("deck_".concat(this.selected_deck))),this.userDeck}catch(e){return console.log(e),null}}},{key:"saveDeck",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=arguments.length>1?arguments[1]:void 0;window.localStorage.setItem("deck_".concat(e),JSON.stringify(t))}},{key:"getRandomCard",value:function(e){switch(e){case"self":var t=this.userDeck[J(this.userDeck.length)];return t.ammount<0?this.getRandomCard(e):(t.ammount--,t.id);case"opponent":var a=this.opponentDeck[J(this.opponentDeck.length)];return a.ammount<0?this.getRandomCard(e):(a.ammount--,a.id);default:return 0}}},{key:"deckSet",get:function(){return this.userDeck.length>0}}],[{key:"getInstance",value:function(){return null==$&&($=new e),$}}]),e}(),ee=function(e){Object(G.a)(a,e);var t=Object(N.a)(a);function a(){var e;return Object(P.a)(this,a),(e=t.call(this,"loading")).cardManager=Q.getInstance(),e}return Object(T.a)(a,[{key:"preload",value:function(){var e=this;this.cardManager.loadDeck();var t=this.game.config.width,a=this.game.config.height,n=this.add.graphics(),r=this.add.graphics().fillStyle(2236962,.8).fillRect(t/3+150,a/2+100,320,50),i=this.make.text({x:t/2,y:a/2+80,text:"Loading...",style:{font:"20px",fill:"#ffffff"}}).setOrigin(.5,.5),c=this.make.text({x:t/2,y:a/2+125,text:"0%",style:{font:"18px",fill:"#ffffff"}}).setOrigin(.5,.5),o=this.make.text({x:t/2,y:a/2+160,text:"",style:{font:"18px",fill:"#ffffff"}}).setOrigin(.5,.5);this.load.image("logo","/assets/logo_transparent.png"),this.load.on("progress",(function(e){n.clear(),n.fillStyle(16777215,1),n.fillRect(t/3+160,a/2+110,300*e,30),c.setText(parseInt(100*e)+"%")})),this.load.on("fileprogress",(function(e){o.setText("Loading asset: "+e.key)})),this.load.on("complete",(function(){n.destroy(),r.destroy(),i.destroy(),c.destroy(),o.destroy()})),this.load.glsl("shader","assets/shader.frag"),f.a.getInst().fetch().then((function(t){t.assets.forEach((function(t){e.load.image(t.name,t.texture)}))}))}},{key:"create",value:function(){var e=this;this.add.image(window.innerWidth/2,window.innerHeight/2,"logo").setScale(.5).setOrigin(.5),this.cardManager.fetchOpponentDeck().then((function(){e.scene.start("main"),K.getInstance().send("ready",{})}))}}]),a}(R.Scene),te=a(31),ae=function(e){Object(G.a)(a,e);var t=Object(N.a)(a);function a(e){var n,r,i,c,o=e.scene,s=e.id,l=e.canInteract,d=void 0===l||l,u=e.hidden,h=void 0!==u&&u;return Object(P.a)(this,a),(c=t.call(this,o,0,0,h?null===(r=f.a.getInst().data)||void 0===r?void 0:r.cards[s].visual.back_texture:null===(n=f.a.getInst().data)||void 0===n?void 0:n.cards[s].visual.front_texture)).handPosition={transialtion:{x:0,y:0},angle:0},c.cardData=void 0,c.ogDepth=0,c.setInteractive(),c.cardData=null===(i=f.a.getInst().data)||void 0===i?void 0:i.cards[s],c.setDisplaySize(c.cardData.deck_settings.screen_size.x,c.cardData.deck_settings.screen_size.y),d&&(o.input.setDraggable(Object(te.a)(c)),c.on("pointerover",(function(){c.view()})),c.on("pointerout",(function(){c.reset()})),c.on("dragstart",(function(){c.reset()}))),o.add.existing(Object(te.a)(c)),c}return Object(T.a)(a,[{key:"reset",value:function(){this.setAngle(this.handPosition.angle).setDepth(this.ogDepth).setPosition(this.handPosition.transialtion.x,this.handPosition.transialtion.y)}},{key:"view",value:function(){this.ogDepth=this.depth,this.setAngle(0).setDepth(5).setPosition(this.handPosition.transialtion.x,this.handPosition.transialtion.y-100)}}]),a}(R.GameObjects.Sprite),ne=a(647),re=a.n(ne),ie=a(210),ce=null,oe=function(){function e(){var t=this;Object(P.a)(this,e),this.emmiter=M.getInstance(),this.worker=K.getInstance(),this.self=Object(ie.a)({health:30,mana:2e3,turns:0}),this.opponent=Object(ie.a)({health:30,mana:1,turns:0}),this.showOverlay=Object(ie.a)({show:!1,turnOwner:"self"}),this.worker.addListeners("turn_change",(function(){"self"!==t.OverlayProxy.turnOwner&&t.nextTurn()}))}return Object(T.a)(e,null,[{key:"getInstance",value:function(){return null===ce&&(ce=new e),ce}}]),Object(T.a)(e,[{key:"nextTurn",value:function(){"self"===this.OverlayProxy.turnOwner?(this.emmiter.emit("end_of_turn",{owner:"self"}),this.emmiter.emit("start_of_turn",{owner:"opponent"}),this.selfProxy.turns++,this.OverlayProxy.turnOwner="opponent",this.worker.send("turn_change",{test:"self"})):(this.emmiter.emit("end_of_turn",{owner:"opponent"}),this.emmiter.emit("start_of_turn",{owner:"self"}),this.oppoentProxy.turns++,this.OverlayProxy.turnOwner="self",this.worker.send("turn_change",{test:"opponent"}))}},{key:"selfProxy",get:function(){return this.self.proxy}},{key:"oppoentProxy",get:function(){return this.opponent.proxy}},{key:"selfObserve",get:function(){return this.self.observables}},{key:"opponentObserve",get:function(){return this.opponent.observables}},{key:"OverlayProxy",get:function(){return this.showOverlay.proxy}},{key:"OverlayObserve",get:function(){return this.showOverlay.observables}}]),e}();function se(e,t){e.forEach((function(e){"none"!==e.trigger&&t.on(e.trigger,(function(a){t.active&&t.actionPoints>0&&function(e,t,a){"single_use_to_graveyard_before_ability"===t.after_use_state&&e.emit("single_use_send_to_graveyard_before_ability");var n=oe.getInstance();switch(t.type){case"draw_card":for(var r=0;r<t.ability_int;r++)switch(t.affecting_player){case"opponent":e.GameScene.opponent_hand.drawCard("opponent");break;case"self":e.GameScene.player_hand.drawCard("self");break;case"self_and_opponent":e.GameScene.player_hand.drawCard("self"),e.GameScene.opponent_hand.drawCard("opponent")}e.actionPoints--;break;case"increase_attack":e.attack+=t.ability_int,e.actionPoints--;break;case"clone":e.GameScene.spawnCard(t.affecting_player,e.cardData.index,e.getData("dropzone_id"),t.ability_int),e.actionPoints--;break;case"increase_player_health":"self_and_opponent"===t.affecting_player?(n.selfProxy.health+=t.ability_int,n.oppoentProxy.health+=t.ability_int):n[t.affecting_player].proxy.health+=t.ability_int,e.actionPoints--;break;case"retaliation_damage":console.log(a),e.actionPoints--;break;case"damage_all_cards_on_board":switch(t.affecting_player){case"self":case"opponent":e.GameScene.player_1_board_c.getChildren().forEach((function(a,n){a.damageCard(t.ability_int,{id:n,owner:e.owner})}));break;case"self_and_opponent":e.GameScene.player_1_board_c.getChildren().forEach((function(a,n){a.damageCard(t.ability_int,{id:n,owner:e.owner})})),e.GameScene.player_1_board_c.getChildren().forEach((function(a,n){a.damageCard(t.ability_int,{id:n,owner:e.owner})}))}e.actionPoints--;break;case"spawn_card_from_deck":e.GameScene.spawnCard(t.affecting_player,Q.getInstance().getRandomCard(t.affecting_player),e.getData("dropzone_id"),t.ability_int),e.actionPoints--;break;case"give_turn_points_to_all_active_cards":switch(t.affecting_player){case"self":case"opponent":e.GameScene.player_1_board_c.getChildren().forEach((function(e){e.actionPoints+=t.ability_int}));break;case"self_and_opponent":e.GameScene.player_1_board_c.getChildren().forEach((function(e){e.actionPoints+=t.ability_int})),e.GameScene.player_1_board_c.getChildren().forEach((function(e){e.actionPoints+=t.ability_int}))}e.actionPoints--;break;case"increase_turn_points":e.actionPoints+=t.ability_int,e.actionPoints--;break;case"discard_cards_in_hand":switch(t.affecting_player){case"self":e.GameScene.player_hand.discardCard(t.ability_int);break;case"self_and_opponent":e.GameScene.player_hand.discardCard(t.ability_int),e.GameScene.opponent_hand.discardCard(t.ability_int);break;case"opponent":e.GameScene.opponent_hand.discardCard(t.ability_int)}e.actionPoints--;break;case"pickup_first_creature_in_graveyard_to_board":switch(t.affecting_player){case"self":e.GameScene.graveyard_a.addCardToBoard(t.affecting_player);break;case"opponent":e.GameScene.graveyard_b.addCardToBoard(t.affecting_player);break;case"self_and_opponent":e.GameScene.graveyard_a.addCardToBoard("self"),e.GameScene.graveyard_b.addCardToBoard("opponent")}e.actionPoints--;break;case"pickup_first_creature_in_graveyard_to_hand":switch(t.affecting_player){case"self":e.GameScene.graveyard_a.addCardToHand(t.affecting_player);break;case"opponent":e.GameScene.graveyard_b.addCardToHand(t.affecting_player);break;case"self_and_opponent":e.GameScene.graveyard_a.addCardToHand(t.affecting_player),e.GameScene.graveyard_b.addCardToHand(t.affecting_player)}e.actionPoints--;break;case"possess_opponents_card":switch(t.affecting_player){case"opponent":var i=e.GameScene.player_1_board.activeSpots()[0];if(void 0!==i.id){var c=e.GameScene.player_1_board_c.getCardByDropZone(i.id);e.GameScene.player_1_board_c.removeCard(c),i.setData("active",!1),e.GameScene.spawnCard(e.GameScene.ownerInvert(c.owner),c.cardData.index,0)}break;case"self":var o=e.GameScene.player_2_board.activeSpots()[0];if(void 0!==o.id){var s=e.GameScene.player_2_board_c.getCardByDropZone(o.id);e.GameScene.player_2_board_c.removeCard(s),o.setData("active",!1),e.GameScene.spawnCard(e.GameScene.ownerInvert(s.owner),s.cardData.index,0)}}e.actionPoints--;break;case"swap_cards_in_hand":var l=e.GameScene,d=l.opponent_hand.getCardList(),u=l.player_hand.getCardList();l.player_hand.discardAll(),l.opponent_hand.discardAll(),d.forEach((function(e){l.player_hand.addCardById(e)})),u.forEach((function(e){l.opponent_hand.addCardById(e,!0,!1)})),e.actionPoints--;break;default:console.log("Not implemented")}"single_use_to_graveyard_after_ability"===t.after_use_state&&e.emit("single_use_send_to_graveyard_after_ability")}(t,e,a)}))}))}var le=function(e){Object(G.a)(a,e);var t=Object(N.a)(a);function a(e){var n,r,i,c=e.scene,o=e.posistion,s=e.id,l=e.graveyard,d=e.dropzone_id,u=e.owner;if(Object(P.a)(this,a),(i=t.call(this,c,o.x,o.y,null===(n=f.a.getInst().data)||void 0===n?void 0:n.cards[s].visual.front_texture)).cardData=void 0,i.emmiter=void 0,i.lifeSpan=0,i.owner=void 0,i.attack=void 0,i.actionPoints=1,i.graveyard=void 0,i.statusEffects=[],i.owner=null!==u&&void 0!==u?u:"self",i.cardData=null===(r=f.a.getInst().data)||void 0===r?void 0:r.cards[s],"self"===i.owner){var h=null,v=null,p={id:-1,owner:null};i.setInteractive().scene.input.setDraggable(Object(te.a)(i),!0),i.on("dragstart",(function(e,t,a){var n=i.getCenter();h=i.scene.add.rope(n.x,n.y,"shader_stripes",void 0,[new R.Math.Vector2(t,a)]).setDepth(2),v=i.scene.add.sprite(0,0,"").setVisible(!1).setSize(100,100).setDepth(1)})),i.on("drag",(function(e){var t,a,n,r,c;R.Utils.Array.Replace(null===(t=h)||void 0===t?void 0:t.points,null===(a=h)||void 0===a?void 0:a.points[1],new R.Math.Vector2(e.x-i.x,e.y-i.y)),null===(n=h)||void 0===n||n.setDirty(),(null===(r=v)||void 0===r?void 0:r.visible)&&(null===(c=v)||void 0===c||c.setPosition(e.x,e.y))})),i.on("dragend",(function(){var e,t;-1!==p.id&&i.emmiter.emit("attacking",{target_owner:p.owner,target_id:p.id,damage:i.attack,type:i.cardData.attack.damage_type,status_length:i.cardData.attack.status_length,from:{id:i.getData("dropzone_id"),owner:i.owner}}),null===(e=h)||void 0===e||e.destroy(!0),null===(t=v)||void 0===t||t.destroy(!0)})),i.on("dragover",(function(e,t){if(p.id!==t.id)if(t.getData("active")&&i.owner!==t.getData("owner")){var a=i.cardData.attack,n=a.can_attack_cards,r=a.can_attack_player;(n&&r||n&&t.id>=0&&t.id<=5||r&&6===t.id)&&(p={id:t.id,owner:t.getData("owner")})}else p={id:-4,owner:null}})),i.on("dragenter",(function(){var e,t;(null===(e=v)||void 0===e?void 0:e.visible)||(null===(t=v)||void 0===t||t.setVisible(!0))})),i.on("dragleave",(function(){var e,t;(null===(e=v)||void 0===e?void 0:e.visible)&&(null===(t=v)||void 0===t||t.setVisible(!1))}))}return se(i.cardData.abilities,Object(te.a)(i)),i.attack=i.cardData.attack.damage,i.graveyard=l,i.emmiter=M.getInstance(),i.setData("dropzone_id",d).setDisplaySize(i.cardData.deck_settings.screen_size.x,i.cardData.deck_settings.screen_size.y),re.a.AddTo(Object(te.a)(i),i.cardData.health.health,i.cardData.health.health),c.add.existing(Object(te.a)(i)),i.init(),i.on("single_use_send_to_graveyard_before_ability",(function(){return i.toGraveyard()})),i.on("single_use_send_to_graveyard_after_ability",(function(){return i.toGraveyard()})),i.on("die",(function(){return i.toGraveyard()})),i.emmiter.on("start_of_turn",(function(e){e.owner===i.owner&&(i.emit("start_of_turn"),0!==i.cardData.health.life_expectancy&&(i.cardData.health.life_expectancy<=i.lifeSpan?(i.kill(),i.emit("death_by_life_expectancy")):i.lifeSpan++),i.statusEffects.forEach((function(e){e()})))})),i.emmiter.on("end_of_turn",(function(e){e.owner===i.owner&&i.emit("end_of_turn")})),i.emmiter.on("attacking",(function(e){e.target_id===i.getData("dropzone_id")&&i.owner===e.target_owner&&(i.damageCard(e.damage,e.from),"poison"===e.type&&i.statusEffects.push((function(){console.log("Status Effect")})))})),i}return Object(T.a)(a,[{key:"init",value:function(){var e=this;""!==this.cardData.placement_settings.sound_cue_entry&&this.scene.sound.play(this.cardData.placement_settings.sound_cue_entry),this.cardData.placement_settings.entry_particle,setTimeout((function(){e.emit("on_drop")}),1)}},{key:"damageCard",value:function(e,t){this.damage(e),this.emit("takes_damage",t)}},{key:"toGraveyard",value:function(){var e=this;this.emit("sent_to_graveyard"),""!==this.cardData.health.sound_cue_death&&this.scene.sound.play(this.cardData.health.sound_cue_death),this.cardData.health.death_particle,this.setActive(!1),this.scene.tweens.add({targets:this,x:{from:this.x,to:this.graveyard.x},y:{from:this.y,to:this.graveyard.y},duration:100,onComplete:function(){return e.destroy()}}),"self"===this.owner?this.scene.graveyard_a.addCard(this.cardData.index,this.getData("dropzone_id"),this.owner):this.scene.graveyard_b.addCard(this.cardData.index,this.getData("dropzone_id"),this.owner)}},{key:"GameScene",get:function(){return this.scene}}]),a}(R.GameObjects.Sprite),de=function(e){Object(G.a)(a,e);var t=Object(N.a)(a);function a(e){var n,r=e.scene;return Object(P.a)(this,a),(n=t.call(this,r)).scene.add.existing(Object(te.a)(n)),n}return Object(T.a)(a,[{key:"addCard",value:function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=new le({scene:this.scene,posistion:{x:e.x,y:e.y},id:t,graveyard:e.graveyard,dropzone_id:e.id,owner:e.getData("owner")});return this.add(n),a&&e.setData("active",!0),n}},{key:"getCardByDropZone",value:function(e){return this.getChildren().find((function(t){return t.getData("dropzone_id")===e}))}},{key:"removeCard",value:function(e){"self"===e.owner?this.scene.player_1_board.getSlot(e.getData("dropzone_id")).setData("active",!1):this.scene.player_2_board.getSlot(e.getData("dropzone_id")).setData("active",!1);this.remove(e,!0,!0)}}]),a}(R.GameObjects.Group),ue=function(e){Object(G.a)(a,e);var t=Object(N.a)(a);function a(e,n){var r;return Object(P.a)(this,a),(r=t.call(this,e)).cardList=[],r.graveyard_location={x:0,y:0},r.graveyard_location=n,r.scene.add.existing(Object(te.a)(r)),r}return Object(T.a)(a,[{key:"addCard",value:function(e,t,a){var n,r;null===(n=this.getChildren()[0])||void 0===n||n.destroy();var i=null===(r=f.a.getInst().data)||void 0===r?void 0:r.cards[e],c=this.scene.add.sprite(this.graveyard_location.x,this.graveyard_location.y,i.visual.front_texture);(c.setDisplaySize(i.deck_settings.screen_size.x,i.deck_settings.screen_size.y),this.add(c),"self"===a)?this.scene.player_1_board.getSlot(t).setData("active",!1):this.scene.player_2_board.getSlot(t).setData("active",!1);return this.cardList.push(e),this}},{key:"getTopCard",value:function(){var e=this.cardList[0];return this.cardList=this.cardList.slice(0,0),e}},{key:"addCardToBoard",value:function(e){"self"===e?this.scene.spawnCard("self",this.getTopCard(),3):this.scene.spawnCard("opponent",this.getTopCard(),3)}},{key:"addCardToHand",value:function(e){"self"===e?this.scene.player_hand.addCardById(this.getTopCard()):this.scene.opponent_hand.addCardById(this.getTopCard())}}]),a}(R.GameObjects.Group),he=function(e){Object(G.a)(a,e);var t=Object(N.a)(a);function a(e){var n,r,i,c,o,s,l,d,u,h,f,v,p,m,g=e.scene,_=e.children,y=e.config;return Object(P.a)(this,a),(m=t.call(this,g,_)).cards_in_hand=0,m.max_cards_in_hand=30,m.fly_in_direction=!0,m.rotate_cards_to_offset=!0,m.card_offset=0,m.rotation_distance_scale_factor=.15,m.radius_offset=-.05,m.card_spacing=250,m.dynamic_spacing=!0,m.dynamic_spacing_max_offset=100,m.screenOffestX=window.innerWidth/2,m.screenOffestY=100-window.innerHeight,m.card_scale=1,m.cards_in_hand=null!==(n=null===y||void 0===y?void 0:y.cards_in_hand)&&void 0!==n?n:0,m.max_cards_in_hand=null!==(r=null===y||void 0===y?void 0:y.max_cards_in_hand)&&void 0!==r?r:30,m.fly_in_direction=null===(i=null===y||void 0===y?void 0:y.fly_in_direction)||void 0===i||i,m.rotate_cards_to_offset=null===(c=null===y||void 0===y?void 0:y.rotate_cards_to_offset)||void 0===c||c,m.card_offset=null!==(o=null===y||void 0===y?void 0:y.card_offset)&&void 0!==o?o:0,m.rotation_distance_scale_factor=null!==(s=null===y||void 0===y?void 0:y.rotation_distance_scale_factor)&&void 0!==s?s:.15,m.radius_offset=null!==(l=null===y||void 0===y?void 0:y.radius_offset)&&void 0!==l?l:-.05,m.card_spacing=null!==(d=null===y||void 0===y?void 0:y.card_spacing)&&void 0!==d?d:250,m.dynamic_spacing=null===(u=null===y||void 0===y?void 0:y.dynamic_spacing)||void 0===u||u,m.dynamic_spacing_max_offset=null!==(h=null===y||void 0===y?void 0:y.dynamic_spacing_max_offset)&&void 0!==h?h:100,m.screenOffestX=null!==(f=null===y||void 0===y?void 0:y.screenOffestX)&&void 0!==f?f:window.innerWidth/2,m.screenOffestY=null!==(v=null===y||void 0===y?void 0:y.screenOffestY)&&void 0!==v?v:80-window.innerHeight,m.card_scale=null!==(p=null===y||void 0===y?void 0:y.card_scale)&&void 0!==p?p:1,g.add.existing(Object(te.a)(m)),m.init(),m}return Object(T.a)(a,[{key:"getCardPosistion",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.cards_in_hand/this.max_cards_in_hand,a=q(this.dynamic_spacing_max_offset,this.card_spacing,t),n=Z(this.card_spacing,this.dynamic_spacing_max_offset,a),r=X(this.card_spacing,n,this.dynamic_spacing),i=(this.cards_in_hand-1)/2,c=i+this.card_offset,o=e-c,s=o*r,l=s*this.radius_offset,d=l*o,u=-1*d-this.screenOffestY,h=u*this.card_scale,f=X(-1*s,s,this.fly_in_direction),v=this.screenOffestX+f*this.card_scale,p=o*(20*this.rotation_distance_scale_factor),m=-1*p,g=-1*X(0,X(X(p,m,this.fly_in_direction),X(p,m,this.fly_in_direction),e>=c),this.rotate_cards_to_offset);return{transialtion:{y:h,x:v},angle:g}}},{key:"calcCardPosistion",value:function(){var e=this;this.children.entries.forEach((function(t,a){var n=e.getCardPosistion(a);t.x=n.transialtion.x,t.y=n.transialtion.y,t.setAngle(n.angle),t.handPosition=n,t.setDepth(n.angle)}))}},{key:"init",value:function(){this.cards_in_hand=this.children.entries.length,this.calcCardPosistion()}},{key:"addCard",value:function(e){return this.add(e),this.init(),this}},{key:"removeCard",value:function(e){return this.remove(e,!0,!0),this.init(),this}},{key:"getCardList",value:function(){return this.getChildren().map((function(e){return e.cardData.index}))}},{key:"drawCard",value:function(e){var t=new ae({scene:this.scene,id:Q.getInstance().getRandomCard(e)});return this.addCard(t),this}},{key:"addCardById",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.addCard(new ae({scene:this.scene,id:e,canInteract:a,hidden:t})),this}},{key:"discardCard",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.getChildren();if(e>t.length)return this;for(var a=0;a<=e;a++)this.remove(t[a],!0,!0);return this.init(),this}},{key:"discardAll",value:function(){return this.clear(!0,!0),this.init(),this}}]),a}(R.GameObjects.Group),fe=function(e){Object(G.a)(a,e);var t=Object(N.a)(a);function a(e){var n,r=e.scene,i=e.posistion,c=e.owner,o=e.id,s=e.graveyard;return Object(P.a)(this,a),(n=t.call(this,r,i.x,i.y,200,280)).emiter=M.getInstance(),n.id=void 0,n.graveyard=void 0,n.graveyard=s,n.id=o,n.setRectangleDropZone(200,280),n.setData("owner",c),n.setData("active",!1),r.add.existing(Object(te.a)(n)),r.input.enableDebug(Object(te.a)(n)),n}return a}(R.GameObjects.Zone),ve=function(e){Object(G.a)(a,e);var t=Object(N.a)(a);function a(e){var n,r=e.scene,i=e.owner,c=e.start,o=e.spacing,s=e.graveyard;Object(P.a)(this,a),(n=t.call(this,r)).owner=void 0,n.graveyard=void 0,n.owner=i,n.graveyard=s;for(var l=[],d=0;d<6;d++)l.push(new fe({scene:r,posistion:{x:c.x+o,y:c.y},owner:i,id:d,graveyard:s})),c.x+=o;return n.addMultiple(l),n.scene.add.existing(Object(te.a)(n)),n}return Object(T.a)(a,[{key:"unactiveSpots",value:function(){return this.getChildren().filter((function(e){return!1===e.getData("active")}))}},{key:"activeSpots",value:function(){return this.getChildren().filter((function(e){return!0===e.getData("active")}))}},{key:"getSlot",value:function(e){return this.getChildren().find((function(t){return t.id===e}))}},{key:"spawn",value:function(e){for(var t=e.card_id,a=e.zone_id,n=e.amount,r=void 0===n?1:n,i=this.getChildren(),c=1,o=function e(){var t=i[a+c],n=i[a-c];return void 0===t||t.getData("active")?void 0===n||n.getData("active")?c<i.length?(c++,e()):(c=1,null):(n.setData("active",!0),c=1,n):(t.setData("active",!0),c=1,t)},s=0;s<r;s++){var l=o();if(null!==l){var d=this.scene.newCard(this.owner,l,t,!1);d.owner=l.getData("owner"),d.actionPoints=0}else console.error("No space on board")}return this}}]),a}(R.GameObjects.Group),pe=a(648),me=a.n(pe),ge=a(649),_e=a.n(ge),ye=function(e){Object(G.a)(a,e);var t=Object(N.a)(a);function a(){var e;return Object(P.a)(this,a),(e=t.call(this,"main")).settings={uuid:"",online:!1,debug:!1},e.gameState=oe.getInstance(),e.cardManager=Q.getInstance(),e.worker=K.getInstance(),e.player_1_board=void 0,e.player_2_board=void 0,e.player_hand=void 0,e.opponent_hand=void 0,e.player_1_board_c=void 0,e.player_2_board_c=void 0,e.graveyard_a=void 0,e.graveyard_b=void 0,e}return Object(T.a)(a,[{key:"init",value:function(e){this.settings.uuid=e.settings.uuid,this.settings.online="true"===e.settings.online,this.settings.debug&&(this.plugins.install("SceneWatcher",me.a,!0),_e()(this))}},{key:"preload",value:function(){this.gameState.OverlayProxy.show=!0}},{key:"create",value:function(){var e=this;this.add.shader("Stripes",0,0,50,50).setRenderToTexture("shader_stripes"),this.graveyard_a=new ue(this,{x:1700,y:600}),this.graveyard_b=new ue(this,{x:0,y:300}),this.opponent_hand=new he({scene:this,config:{card_scale:1,rotation_distance_scale_factor:-.15,radius_offset:.05,card_spacing:250,screenOffestY:5},children:[new ae({scene:this,id:0,canInteract:!1,hidden:!0}),new ae({scene:this,id:0,canInteract:!1,hidden:!0}),new ae({scene:this,id:0,canInteract:!1,hidden:!0}),new ae({scene:this,id:0,canInteract:!1,hidden:!0})]}),this.player_hand=new he({scene:this,children:[new ae({scene:this,id:this.cardManager.getRandomCard("self")}),new ae({scene:this,id:this.cardManager.getRandomCard("self")}),new ae({scene:this,id:this.cardManager.getRandomCard("self")}),new ae({scene:this,id:this.cardManager.getRandomCard("self")})]}),this.player_1_board=new ve({scene:this,owner:"self",start:{x:75,y:600},spacing:225,graveyard:{x:1700,y:600}}),this.player_1_board_c=new de({scene:this}),this.player_2_board=new ve({scene:this,owner:"opponent",start:{x:75,y:300},spacing:225,graveyard:{x:0,y:300}}),this.player_2_board_c=new de({scene:this}),this.player_2_board_c.addCard(this.player_2_board.getSlot(0),1),this.player_2_board_c.addCard(this.player_2_board.getSlot(5),1),this.input.on("drag",(function(e,t){t instanceof ae&&(t.setAngle(0),t.x=e.x,t.y=e.y)})),this.input.on("dragend",(function(e,t){t instanceof ae&&(t.setPosition(t.handPosition.transialtion.x,t.handPosition.transialtion.y),t.setAngle(t.handPosition.angle))})),this.input.on("drop",(function(t,a,n){a instanceof ae&&a.cardData.placement_settings.mana_cost<=e.gameState.selfProxy.mana&&!n.getData("active")&&(n.getData("owner")===a.cardData.placement_settings.owner||"self_and_opponent"===a.cardData.placement_settings.owner)&&(e.gameState.selfProxy.mana-=a.cardData.placement_settings.mana_cost,e.newCard(n.getData("owner"),n,a.cardData.index),e.player_hand.removeCard(a))}))}},{key:"newCard",value:function(e,t,a){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];switch(e){case"self":return this.player_1_board_c.addCard(t,a,n);case"opponent":return this.player_2_board_c.addCard(t,a,n)}}},{key:"spawnCard",value:function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;switch(e){case"opponent":this.player_2_board.spawn({card_id:t,zone_id:a,amount:n});break;case"self":this.player_1_board.spawn({card_id:t,zone_id:a,amount:n});break;default:console.error("Owner setting not supported")}}},{key:"ownerInvert",value:function(e){return"self"===e?"opponent":"self"}}]),a}(R.Scene);var be=function(e){Object(G.a)(a,e);var t=Object(N.a)(a);function a(e){var n;return Object(P.a)(this,a),(n=t.call(this,e)).settings=u(),n.scene.add("loading",ee,!0,{settings:n.settings}),n.scene.add("main",ye,!1,{settings:n.settings}),n}return a}(R.Game);function ke(e){new be(function(e){return{canvas:e,type:R.WEBGL,width:window.innerWidth,height:window.innerHeight,banner:!1,title:"Kevin Online",scene:void 0,scale:{mode:R.Scale.RESIZE,autoCenter:R.Scale.NO_CENTER},physics:{default:!1},version:"0.2.5-alpha",fps:{min:30,target:60},input:{keyboard:!0,gamepad:!1},plugins:{global:[],scene:[]}}}(e))}var we=function(e){Object(G.a)(a,e);var t=Object(N.a)(a);function a(e){var r;return Object(P.a)(this,a),(r=t.call(this,e)).gameElement=Object(n.createRef)(),r.gameState=oe.getInstance(),r.state={overlay:!1,buttonDisable:!1},r}return Object(T.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.gameState.OverlayObserve.show.subscribe((function(t){return e.setState({overlay:t})})),this.gameState.OverlayObserve.turnOwner.subscribe((function(t){e.setState({buttonDisable:"self"!==t})})),ke(this.gameElement.current)}},{key:"componentWillUnmount",value:function(){K.getInstance().terminate()}},{key:"render",value:function(){return r.a.createElement("div",null,this.Overlay(),r.a.createElement("canvas",{id:"game",ref:this.gameElement}))}},{key:"Overlay",value:function(){var e=this;return this.state.overlay?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"game-overlay"},r.a.createElement(S.a,{type:"secondary"},"Menu")),r.a.createElement("div",{id:"turn_time"},r.a.createElement("p",null,"0.00"),r.a.createElement(S.a,{type:"primary",disabled:this.state.buttonDisable,onClick:function(){return e.gameState.nextTurn()}},"wating")),r.a.createElement(Ee,{owner:this.gameState.selfProxy,observe:this.gameState.selfObserve,css:"player-self"}),r.a.createElement(Ee,{owner:this.gameState.oppoentProxy,observe:this.gameState.opponentObserve,css:"player-opponent "})):null}}]),a}(n.Component);function Ee(e){var t=e.owner,a=e.observe,i=e.css,c=Object(n.useState)(t.mana),o=Object(s.a)(c,2),l=o[0],d=o[1],u=Object(n.useState)(t.health),h=Object(s.a)(u,2),f=h[0],v=h[1],p=Object(n.useState)(t.turns),m=Object(s.a)(p,2),g=m[0],_=m[1];return Object(n.useEffect)((function(){a.health.subscribe((function(e){return v(e)})),a.mana.subscribe((function(e){return d(e)})),a.turns.subscribe((function(e){return _(e)}))}),[a.health,a.mana,a.turns]),r.a.createElement("div",{id:"player-info",className:i},r.a.createElement("p",null,"Mana: ",l),r.a.createElement("p",null,"Health: ",f),r.a.createElement("p",null,"Turns: ",g),r.a.createElement("img",{src:"",alt:"user_logo"}))}var Oe=a(136),xe=a.n(Oe);function je(){var e=Object(n.useState)(!1),t=Object(s.a)(e,2),a=t[0],i=t[1],c=Object(n.useState)(),o=Object(s.a)(c,2),l=o[0],d=o[1];return r.a.createElement("div",{id:"play-home"},r.a.createElement(O.a,{className:"select-play"},r.a.createElement(O.a.Body,{className:"select-art"}),r.a.createElement(O.a.Footer,{className:"select-button"},r.a.createElement(S.a,{type:"link",onClick:function(){return h("/play/singleplayer",{})}},"Singleplayer"))),r.a.createElement(O.a,{className:"select-play"},r.a.createElement(O.a.Body,{className:"select-art"}),r.a.createElement(O.a.Footer,{className:"select-button"},r.a.createElement(S.a,{type:"link",onClick:function(){return i(!0)}},"Multiplayer"))),r.a.createElement(j.a,{visible:a,onClose:function(){return i(!1)},title:"Start Multiplayer",footer:r.a.createElement("div",null,r.a.createElement(S.a,{onClick:function(){return h("/play/multiplayer",{query:{create:"TRUE"}})}},"Start a Game"),r.a.createElement(S.a,{onClick:function(){l?h("/play/multiplayer",{query:{uuid:l}}):xe.a.error("You need a code to join a game!",5,{position:"bottom-right",title:"Join Error"})}},"Join Game"))},r.a.createElement(b.a,{onChange:function(e){d(e)},placeholder:"enter a join code"})))}var Ce=a(164),Se=a.n(Ce),De=a(61),Ie=a.n(De),Pe=a(650),Te=a.n(Pe),Ge=a(654),Ne=a(651),Re=function(e){return window.history.replaceState({},document.title,window.location.pathname)},Ae=Object(n.createContext)(),Me=function(){return Object(n.useContext)(Ae)},ze=function(e){var t=e.children,a=e.onRedirectCallback,i=void 0===a?Re:a,c=Object(Ge.a)(e,["children","onRedirectCallback"]),o=Object(n.useState)(!1),l=Object(s.a)(o,2),d=l[0],u=l[1],h=Object(n.useState)({}),f=Object(s.a)(h,2),v=f[0],p=f[1],m=Object(n.useState)(),g=Object(s.a)(m,2),_=g[0],y=g[1],b=Object(n.useState)(!0),k=Object(s.a)(b,2),w=k[0],E=k[1],O=Object(n.useState)(!1),x=Object(s.a)(O,2),j=x[0],C=x[1];Object(n.useEffect)((function(){(function(){var e=Object(V.a)(H.a.mark((function e(){var t,a,n,r,o;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(Ne.a)(c);case 3:if(t=e.sent,y(t),!window.location.search.includes("code=")||!window.location.search.includes("state=")){e.next=11;break}return e.next=8,t.handleRedirectCallback();case 8:a=e.sent,n=a.appState,i(n);case 11:return e.next=13,t.isAuthenticated();case 13:if(r=e.sent,u(r),!r){e.next=20;break}return e.next=18,t.getUser();case 18:o=e.sent,p(o);case 20:E(!1),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(0),E(!1),console.log(e.t0);case 27:case"end":return e.stop()}}),e,null,[[0,23]])})));return function(){return e.apply(this,arguments)}})()()}),[]);var S=function(){var e=Object(V.a)(H.a.mark((function e(){var t,a,n=arguments;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},C(!0),e.prev=2,e.next=5,_.loginWithPopup(t);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.error(e.t0);case 10:return e.prev=10,C(!1),e.finish(10);case 13:return e.next=15,_.getUser();case 15:a=e.sent,p(a),u(!0);case 18:case"end":return e.stop()}}),e,null,[[2,7,10,13]])})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=Object(V.a)(H.a.mark((function e(){var t;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return E(!0),e.next=3,_.handleRedirectCallback();case 3:return e.next=5,_.getUser();case 5:t=e.sent,E(!1),u(!0),p(t);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(Ae.Provider,{value:{isAuthenticated:d,user:v,loading:w,popupOpen:j,loginWithPopup:S,handleRedirectCallback:D,getIdTokenClaims:function(){return _.getIdTokenClaims.apply(_,arguments)},loginWithRedirect:function(){return _.loginWithRedirect.apply(_,arguments)},getTokenSilently:function(){return _.getTokenSilently.apply(_,arguments)},getTokenWithPopup:function(){return _.getTokenWithPopup.apply(_,arguments)},logout:function(){return _.logout.apply(_,arguments)}}},t)},Le=Q.getInstance(),Ue=null;function We(e,t){switch(t.type){case"logo_name":return e.logo=t.value.logo,e.name=t.value.name,e;case"status":return e.status.status=t.value.status,e.status.button=t.value.button,e.status.text=t.value.text,e;default:return e}}function Be(e,t){switch(t.type){case"user":return e.logo=t.value.logo,e.name=t.value.name,e.status=t.value.status,e;case"status":return e.status=t.value.status,e;default:return e}}function Ye(){var e=Te()(),t=Object(n.useState)(!0),a=Object(s.a)(t,2),i=a[0],c=a[1],l=Object(n.useState)("NO CODE"),d=Object(s.a)(l,2),f=d[0],v=d[1],p=Object(n.useState)([]),m=Object(s.a)(p,2),g=m[0],_=m[1],y=Object(n.useState)(!1),k=Object(s.a)(y,2),E=k[0],O=k[1],x=Object(n.useReducer)(We,{logo:"",name:"USERNAME",status:{status:"Wating",button:"success",text:"Ready"}}),j=Object(s.a)(x,2),C=j[0],D=j[1],I=Object(n.useReducer)(Be,{logo:"",name:"USERNAME",status:"Wating"}),P=Object(s.a)(I,2),T=P[0],G=P[1],N=Object(n.useState)(),A=Object(s.a)(N,2),M=A[0],z=A[1],L=Me(),U=L.loading,W=L.isAuthenticated,B=L.user,Y=Object(o.c)().type,H=Object(n.useCallback)((function(){return"Ready"!==C.status.status||"Ready"!==T.status}),[T.status,C.status.status]);return Object(n.useEffect)((function(){var t,a,n=function(t){z(t),_(Le.getDecks()),c(!1);var a=u();Ue=K.create(Y),Le.init(),Ue.addListeners("websocket_ready",(function(e){var t,n;"TRUE"===(null===a||void 0===a?void 0:a.create)&&(O(!0),null===(n=Ue)||void 0===n||n.send("new_game",{}));(null===a||void 0===a?void 0:a.uuid)&&(null===(t=Ue)||void 0===t||t.send("join_game",{uuid:null===a||void 0===a?void 0:a.uuid}))})),Ue.addListeners("init",(function(t){G({type:"user",value:{name:t.name,status:t.status,logo:t.logo}}),e()})),Ue.addListeners("status_opponent",(function(t){G({type:"status",value:{status:t}}),e()})),Ue.addListeners("join_code",(function(e){var t;v(e.uuid),null===(t=Ue)||void 0===t||t.send("init",{name:C.name,status:C.status.status,logo:C.logo})})),Ue.addListeners("game_start",(function(e){h("/game",{query:{uuid:f,online:!0},replace:!0})})),Ue.addListeners("kick",(function(e){var t;null===(t=Ue)||void 0===t||t.terminate(),xe.a.info("You Where kicked",5,{position:"bottom-right",title:"Kicked"}),h("/play",{replace:!0})})),e()};if(!U)if(W&&"multiplayer"===Y)D({type:"logo_name",value:{logo:null!==(t=null===B||void 0===B?void 0:B.picture)&&void 0!==t?t:"",name:null!==(a=null===B||void 0===B?void 0:B.name)&&void 0!==a?a:"USERNAME"}}),O(!1),n("multiplayer");else if("singleplayer"===Y){var r,i;D({type:"logo_name",value:{logo:null!==(r=null===B||void 0===B?void 0:B.picture)&&void 0!==r?r:"",name:null!==(i=null===B||void 0===B?void 0:B.name)&&void 0!==i?i:"USERNAME"}}),O(!0),n("singleplayer")}else xe.a.error("Failed to Authenticate",5,{position:"bottom-right",title:"Authentication Error"}),h("/play",{replace:!0})}),[U]),i?r.a.createElement("div",{id:"playing"},r.a.createElement(Ie.a,{size:50,name:"cube-grid"})):r.a.createElement("div",{id:"playing"},r.a.createElement("nav",{id:"play-nav"},r.a.createElement(w.a,{noCache:!0,onChange:function(e){return Le.setDeck(e),e},renderItem:function(e){return"".concat(R.Utils.String.UppercaseFirst(e)," Deck")},onCreate:function(e){return e},loading:!1,style:{width:240},data:g,keygen:function(e){return e},placeholder:"Select your deck"})),r.a.createElement("div",null,r.a.createElement("div",{id:"left"}),r.a.createElement("div",{id:"right"}),r.a.createElement("div",{id:"right-profile"},r.a.createElement(Se.a,{shape:"circle",width:150,height:150,title:"user_logo",src:T.logo}),r.a.createElement("h4",null,T.name),r.a.createElement("p",null,"Status: ",T.status),"singleplayer"===M?r.a.createElement(w.a,{onCreate:function(e){return e},onChange:function(e){var t;null===(t=Ue)||void 0===t||t.send("ai_difficlty",{value:e})},keygen:function(e){return e},data:["Easy","Normal","Hard"],defaultValue:[1],style:{width:120},value:"Normal"}):r.a.createElement(S.a,{type:"danger",onClick:function(){var e;G({type:"user",value:{status:"Wating",name:"Wating for User",logo:"no_user"}}),null===(e=Ue)||void 0===e||e.send("kick",{})}},"Kick")),r.a.createElement("div",{id:"left-profile"},r.a.createElement(Se.a,{shape:"circle",width:150,height:150,title:"user_logo",src:C.logo}),r.a.createElement("h4",null,C.name),r.a.createElement("p",null,"Status: ",C.status.status),r.a.createElement(S.a,{type:C.status.button,onClick:function(){var t;Le.deckSet?(D({type:"status",value:"Ready"===C.status.status?{status:"Wating",button:"success",text:"Ready"}:{status:"Ready",button:"danger",text:"Unready"}}),e(),null===(t=Ue)||void 0===t||t.send("status_opponent",{status:C.status.status})):xe.a.error("You need to select a deck!",5,{position:"bottom-right",title:"Error"})}},C.status.text)),r.a.createElement("div",{id:"center"},r.a.createElement("h1",null,"Join Code"),r.a.createElement(b.a,{style:{width:240},placeholder:"d853c4929da544aea121",disabled:!0,defaultValue:f,value:f}),E?r.a.createElement(S.a,{loading:H(),type:"primary",onClick:function(){var e;null===(e=Ue)||void 0===e||e.send("game_start",{}),h("/game",{query:{uuid:f,online:!1},replace:!0})}},"Start"):null)))}function He(){return document.title="Kevin Online - Play",r.a.createElement("div",{id:"play"},r.a.createElement("main",null,r.a.createElement(o.a,{path:"/play/:type"},r.a.createElement(Ye,null)),r.a.createElement(o.a,{exact:!0,path:"/play"},r.a.createElement(je,null))),r.a.createElement(m,{activeTab:1}))}function Ve(){document.title="Kevin Online - Account";var e=Object(n.useState)(!1),t=Object(s.a)(e,2),a=t[0],i=t[1],c=Me(),o=c.loginWithRedirect,l=c.isAuthenticated,d=c.loading,u=c.user,h=c.logout;return Object(n.useEffect)((function(){console.log(l),l?(i(!0),console.log(u)):i(!1)}),[d]),r.a.createElement("div",{id:"account"},d?r.a.createElement("section",{className:"load-account"},r.a.createElement(Ie.a,{name:"cube-grid"})):a?r.a.createElement("section",{className:"view-account"},r.a.createElement(Se.a,{shape:"circle",width:200,height:200,src:u.picture}),r.a.createElement("div",{id:"details"},r.a.createElement("h1",null,u.name),r.a.createElement("p",null,u.sub),r.a.createElement("hr",null),r.a.createElement(S.a,{type:"link",href:"https://visualsource.000webhostapp.com/profile/".concat(encodeURIComponent(u.sub))},"View Account"),r.a.createElement(S.a,{type:"link",onClick:function(){return h()}},"Logout"))):r.a.createElement("section",{id:"account-login"},r.a.createElement(S.a,{type:"primary",onClick:function(){return o()}},"Login")),r.a.createElement(m,{activeTab:3}))}var Fe=a(332),Ke=a.n(Fe),Ze=a(653),qe=a.n(Ze);function Xe(e){}function Je(){return document.title="Kevin Online - Settings",r.a.createElement("div",{id:"settings"},r.a.createElement("div",{id:"settings-content"},r.a.createElement(Ke.a,{onSubmit:Xe},r.a.createElement(Ke.a.Item,{label:"Audio",labelAlign:"top"},r.a.createElement(qe.a,{value:100})))),r.a.createElement(m,{activeTab:4}))}function $e(){return document.title="Kevin Online - Home",r.a.createElement("div",{id:"main-menu"},r.a.createElement("section",{className:"animated-grid"},r.a.createElement("div",{className:"card"},"a"),r.a.createElement("div",{className:"card"},"b"),r.a.createElement("div",{className:"card"},"c"),r.a.createElement("div",{className:"card"},"d"),r.a.createElement("div",{className:"card"},"e"),r.a.createElement("div",{className:"card"},"f"),r.a.createElement("div",{className:"card"},"g"),r.a.createElement("div",{className:"card"},"h"),r.a.createElement("div",{className:"card"},"i"),r.a.createElement("div",{className:"card"},"j"),r.a.createElement("div",{className:"card"},"k"),r.a.createElement("div",{className:"card"},"l"),r.a.createElement("div",{className:"card"},"main")),r.a.createElement(m,{activeTab:0}))}var Qe=function(){return r.a.createElement(o.b,{history:d},r.a.createElement(o.a,{exact:!0,path:"/"},r.a.createElement($e,null)),r.a.createElement(o.a,{path:"/editor"},r.a.createElement(B,null)),r.a.createElement(o.a,{path:"/game"},r.a.createElement(we,null)),r.a.createElement(o.a,{path:"/play"},r.a.createElement(He,null)),r.a.createElement(o.a,{path:"/account"},r.a.createElement(Ve,null)),r.a.createElement(o.a,{path:"/settings"},r.a.createElement(Je,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(1712),a(1713);f.a.createInst({url:"http://localhost:8000/",part:"Kevin/db",cache_id:"card-cache"}).fetch(),f.a.getInst().checkVersion("version","Kevin/profile"),c.a.render(r.a.createElement(ze,{domain:"visualsource.auth0.com",client_id:"gRqZG9p2sUKSntmbI9pj5YNZqeEJohWP",redirect_uri:window.location.origin,onRedirectCallback:function(e){d.push(e&&e.targetUrl?e.targetUrl:window.location.pathname)}},r.a.createElement(Qe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},655:function(e,t,a){e.exports=a(1714)}},[[655,1,2]]]);
//# sourceMappingURL=main.c33b2291.chunk.js.map