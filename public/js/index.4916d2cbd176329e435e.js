/*! For license information please see index.4916d2cbd176329e435e.js.LICENSE.txt */
(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[826],{8308:(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>s,c:()=>i,g:()=>o});var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{};function i(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return s(null==t&&n.path)}},n.exports),n.exports}function o(e){return e&&Object.prototype.hasOwnProperty.call(e,"default")&&1===Object.keys(e).length?e.default:e}function s(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}},9910:(e,t,n)=>{"use strict";n.d(t,{o:()=>l,r:()=>u});var r=n(8308),i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;function a(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var l=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,r,l=a(e),c=1;c<arguments.length;c++){for(var u in n=Object(arguments[c]))o.call(n,u)&&(l[u]=n[u]);if(i){r=i(n);for(var h=0;h<r.length;h++)s.call(n,r[h])&&(l[r[h]]=n[r[h]])}}return l},c=(0,r.c)((function(e,t){var n=60103,r=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var i=60109,o=60110,s=60112;t.Suspense=60113;var a=60115,c=60116;if("function"==typeof Symbol&&Symbol.for){var u=Symbol.for;n=u("react.element"),r=u("react.portal"),t.Fragment=u("react.fragment"),t.StrictMode=u("react.strict_mode"),t.Profiler=u("react.profiler"),i=u("react.provider"),o=u("react.context"),s=u("react.forward_ref"),t.Suspense=u("react.suspense"),a=u("react.memo"),c=u("react.lazy")}var h="function"==typeof Symbol&&Symbol.iterator;function d(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f={};function m(e,t,n){this.props=e,this.context=t,this.refs=f,this.updater=n||p}function v(){}function g(e,t,n){this.props=e,this.context=t,this.refs=f,this.updater=n||p}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(d(85));this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=m.prototype;var y=g.prototype=new v;y.constructor=g,l(y,m.prototype),y.isPureReactComponent=!0;var b={current:null},_=Object.prototype.hasOwnProperty,w={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,r){var i,o={},s=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)_.call(t,i)&&!w.hasOwnProperty(i)&&(o[i]=t[i]);var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===o[i]&&(o[i]=l[i]);return{$$typeof:n,type:e,key:s,ref:a,props:o,_owner:b.current}}function x(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}var T=/\/+/g;function A(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function S(e,t,i,o,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return s=s(l=e),e=""===o?"."+A(l,0):o,Array.isArray(s)?(i="",null!=e&&(i=e.replace(T,"$&/")+"/"),S(s,t,i,"",(function(e){return e}))):null!=s&&(x(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,i+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(T,"$&/")+"/")+e)),t.push(s)),1;if(l=0,o=""===o?".":o+":",Array.isArray(e))for(var c=0;c<e.length;c++){var u=o+A(a=e[c],c);l+=S(a,t,i,u,s)}else if("function"==typeof(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e)))for(e=u.call(e),c=0;!(a=e.next()).done;)l+=S(a=a.value,t,i,u=o+A(a,c++),s);else if("object"===a)throw t=""+e,Error(d(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return l}function O(e,t,n){if(null==e)return e;var r=[],i=0;return S(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function I(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var R={current:null};function M(){var e=R.current;if(null===e)throw Error(d(321));return e}var C={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:b,IsSomeRendererActing:{current:!1},assign:l};t.Children={map:O,forEach:function(e,t,n){O(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return O(e,(function(){t++})),t},toArray:function(e){return O(e,(function(e){return e}))||[]},only:function(e){if(!x(e))throw Error(d(143));return e}},t.Component=m,t.PureComponent=g,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=C,t.cloneElement=function(e,t,r){if(null==e)throw Error(d(267,e));var i=l({},e.props),o=e.key,s=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,a=b.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(u in t)_.call(t,u)&&!w.hasOwnProperty(u)&&(i[u]=void 0===t[u]&&void 0!==c?c[u]:t[u])}var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){c=Array(u);for(var h=0;h<u;h++)c[h]=arguments[h+2];i.children=c}return{$$typeof:n,type:e.type,key:o,ref:s,props:i,_owner:a}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:o,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:i,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:s,render:e}},t.isValidElement=x,t.lazy=function(e){return{$$typeof:c,_payload:{_status:-1,_result:e},_init:I}},t.memo=function(e,t){return{$$typeof:a,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return M().useCallback(e,t)},t.useContext=function(e,t){return M().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return M().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return M().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return M().useLayoutEffect(e,t)},t.useMemo=function(e,t){return M().useMemo(e,t)},t.useReducer=function(e,t,n){return M().useReducer(e,t,n)},t.useRef=function(e){return M().useRef(e)},t.useState=function(e){return M().useState(e)},t.version="17.0.2"})),u=(0,r.c)((function(e){e.exports=c}))},9074:(e,t,n)=>{"use strict";var r=n(2986);let i=null;class o extends r.E{constructor(){if(null!==i)return i;super(),i=this}on(e,t){return this.addEventListener(e,t),this}off(e,t){return this.addEventListener(e,t),this}emit(e){return this.dispatchEvent(e),this}}class s{constructor(){this.events=new o}}n(6282);var a=n(8308);const l=(0,a.c)((function(e,t){e.exports=function e(t,n,r){function i(s,l){if(!n[s]){if(!t[s]){var c="function"==typeof a.b&&a.b;if(!l&&c)return c(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var h=n[s]={exports:{}};t[s][0].call(h.exports,(function(e){var n=t[s][1][e];return i(n||e)}),h,h.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof a.b&&a.b,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){(function(e){var n,r,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var o=0,s=new i(u),a=e.document.createTextNode("");s.observe(a,{characterData:!0}),n=function(){a.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var l=new e.MessageChannel;l.port1.onmessage=u,n=function(){l.port2.postMessage(0)}}var c=[];function u(){var e,t;r=!0;for(var n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}r=!1}function h(e){1!==c.push(e)||r||n()}t.exports=h}).call(this,void 0!==a.a?a.a:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){var r=e(1);function i(){}var o={},s=["REJECTED"],a=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==i&&p(this,e)}function u(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function h(e,t,n){r((function(){var r;try{r=t(n)}catch(t){return o.reject(e,t)}r===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,r)}))}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function p(e,t){var n=!1;function r(t){n||(n=!0,o.reject(e,t))}function i(t){n||(n=!0,o.resolve(e,t))}function s(){t(i,r)}var a=f(s);"error"===a.status&&r(a.value)}function f(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}function m(e){return e instanceof this?e:o.resolve(new this(i),e)}function v(e){var t=new this(i);return o.reject(t,e)}function g(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var s=new Array(n),a=0,l=-1,c=new this(i);++l<n;)u(e[l],l);return c;function u(e,i){function l(e){s[i]=e,++a!==n||r||(r=!0,o.resolve(c,s))}t.resolve(e).then(l,(function(e){r||(r=!0,o.reject(c,e))}))}}function y(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var s=-1,a=new this(i);++s<n;)l(e[s]);return a;function l(e){t.resolve(e).then((function(e){r||(r=!0,o.resolve(a,e))}),(function(e){r||(r=!0,o.reject(a,e))}))}}t.exports=c,c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===s)return this;var n=new this.constructor(i);return this.state!==l?h(n,this.state===a?e:t,this.outcome):this.queue.push(new u(n,e,t)),n},u.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){h(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){o.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){h(this.promise,this.onRejected,e)},o.resolve=function(e,t){var n=f(d,t);if("error"===n.status)return o.reject(e,n.value);var r=n.value;if(r)p(e,r);else{e.state=a,e.outcome=t;for(var i=-1,s=e.queue.length;++i<s;)e.queue[i].callFulfilled(t)}return e},o.reject=function(e,t){e.state=s,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},c.resolve=m,c.reject=v,c.all=g,c.race=y},{1:1}],3:[function(e,t,n){(function(t){"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==a.a?a.a:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}var s=o();function a(){try{if(!s||!s.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}function l(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(i){if("TypeError"!==i.name)throw i;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var c=Promise;function u(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function h(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function d(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function p(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var f="local-forage-detect-blob-support",m=void 0,v={},g=Object.prototype.toString,y="readonly",b="readwrite";function _(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),i=0;i<t;i++)r[i]=e.charCodeAt(i);return n}function w(e){return new c((function(t){var n=e.transaction(f,b),r=l([""]);n.objectStore(f).put(r,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}function E(e){return"boolean"==typeof m?c.resolve(m):w(e).then((function(e){return m=e}))}function x(e){var t=v[e.name],n={};n.promise=new c((function(e,t){n.resolve=e,n.reject=t})),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then((function(){return n.promise})):t.dbReady=n.promise}function T(e){var t=v[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function A(e,t){var n=v[e.name].deferredOperations.pop();if(n)return n.reject(t),n.promise}function S(e,t){return new c((function(n,r){if(v[e.name]=v[e.name]||z(),e.db){if(!t)return n(e.db);x(e),e.db.close()}var i=[e.name];t&&i.push(e.version);var o=s.open.apply(s,i);t&&(o.onupgradeneeded=function(t){var n=o.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(f)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),o.onerror=function(e){e.preventDefault(),r(o.error)},o.onsuccess=function(){n(o.result),T(e)}}))}function O(e){return S(e,!1)}function I(e){return S(e,!0)}function R(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,i=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),i||n){if(n){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function M(e){return new c((function(t,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:e.type})},r.readAsBinaryString(e)}))}function C(e){return l([_(atob(e.data))],{type:e.type})}function L(e){return e&&e.__local_forage_encoded_blob}function N(e){var t=this,n=t._initReady().then((function(){var e=v[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return h(n,e,e),n}function k(e){x(e);for(var t=v[e.name],n=t.forages,r=0;r<n.length;r++){var i=n[r];i._dbInfo.db&&(i._dbInfo.db.close(),i._dbInfo.db=null)}return e.db=null,O(e).then((function(t){return e.db=t,R(e)?I(e):t})).then((function(r){e.db=t.db=r;for(var i=0;i<n.length;i++)n[i]._dbInfo.db=r})).catch((function(t){throw A(e,t),t}))}function P(e,t,n,r){void 0===r&&(r=1);try{var i=e.db.transaction(e.storeName,t);n(null,i)}catch(i){if(r>0&&(!e.db||"InvalidStateError"===i.name||"NotFoundError"===i.name))return c.resolve().then((function(){if(!e.db||"NotFoundError"===i.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),I(e)})).then((function(){return k(e).then((function(){P(e,t,n,r-1)}))})).catch(n);n(i)}}function z(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function D(e){var t=this,n={db:null};if(e)for(var r in e)n[r]=e[r];var i=v[n.name];i||(i=z(),v[n.name]=i),i.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=N);var o=[];function s(){return c.resolve()}for(var a=0;a<i.forages.length;a++){var l=i.forages[a];l!==t&&o.push(l._initReady().catch(s))}var u=i.forages.slice(0);return c.all(o).then((function(){return n.db=i.db,O(n)})).then((function(e){return n.db=e,R(n,t._defaultConfig.version)?I(n):e})).then((function(e){n.db=i.db=e,t._dbInfo=n;for(var r=0;r<u.length;r++){var o=u[r];o!==t&&(o._dbInfo.db=n.db,o._dbInfo.version=n.version)}}))}function U(e,t){var n=this;e=d(e);var r=new c((function(t,r){n.ready().then((function(){P(n._dbInfo,y,(function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName).get(e);s.onsuccess=function(){var e=s.result;void 0===e&&(e=null),L(e)&&(e=C(e)),t(e)},s.onerror=function(){r(s.error)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function F(e,t){var n=this,r=new c((function(t,r){n.ready().then((function(){P(n._dbInfo,y,(function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName).openCursor(),a=1;s.onsuccess=function(){var n=s.result;if(n){var r=n.value;L(r)&&(r=C(r));var i=e(r,n.key,a++);void 0!==i?t(i):n.continue()}else t()},s.onerror=function(){r(s.error)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function j(e,t,n){var r=this;e=d(e);var i=new c((function(n,i){var o;r.ready().then((function(){return o=r._dbInfo,"[object Blob]"===g.call(t)?E(o.db).then((function(e){return e?t:M(t)})):t})).then((function(t){P(r._dbInfo,b,(function(o,s){if(o)return i(o);try{var a=s.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var l=a.put(t,e);s.oncomplete=function(){void 0===t&&(t=null),n(t)},s.onabort=s.onerror=function(){var e=l.error?l.error:l.transaction.error;i(e)}}catch(e){i(e)}}))})).catch(i)}));return u(i,n),i}function H(e,t){var n=this;e=d(e);var r=new c((function(t,r){n.ready().then((function(){P(n._dbInfo,b,(function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName).delete(e);o.oncomplete=function(){t()},o.onerror=function(){r(s.error)},o.onabort=function(){var e=s.error?s.error:s.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function B(e){var t=this,n=new c((function(e,n){t.ready().then((function(){P(t._dbInfo,b,(function(r,i){if(r)return n(r);try{var o=i.objectStore(t._dbInfo.storeName).clear();i.oncomplete=function(){e()},i.onabort=i.onerror=function(){var e=o.error?o.error:o.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return u(n,e),n}function V(e){var t=this,n=new c((function(e,n){t.ready().then((function(){P(t._dbInfo,y,(function(r,i){if(r)return n(r);try{var o=i.objectStore(t._dbInfo.storeName).count();o.onsuccess=function(){e(o.result)},o.onerror=function(){n(o.error)}}catch(e){n(e)}}))})).catch(n)}));return u(n,e),n}function G(e,t){var n=this,r=new c((function(t,r){e<0?t(null):n.ready().then((function(){P(n._dbInfo,y,(function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName),a=!1,l=s.openKeyCursor();l.onsuccess=function(){var n=l.result;n?0===e||a?t(n.key):(a=!0,n.advance(e)):t(null)},l.onerror=function(){r(l.error)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function X(e){var t=this,n=new c((function(e,n){t.ready().then((function(){P(t._dbInfo,y,(function(r,i){if(r)return n(r);try{var o=i.objectStore(t._dbInfo.storeName).openKeyCursor(),s=[];o.onsuccess=function(){var t=o.result;t?(s.push(t.key),t.continue()):e(s)},o.onerror=function(){n(o.error)}}catch(e){n(e)}}))})).catch(n)}));return u(n,e),n}function W(e,t){t=p.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,i=this;if(e.name){var o=e.name===n.name&&i._dbInfo.db?c.resolve(i._dbInfo.db):O(e).then((function(t){var n=v[e.name],r=n.forages;n.db=t;for(var i=0;i<r.length;i++)r[i]._dbInfo.db=t;return t}));r=e.storeName?o.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;x(e);var r=v[e.name],i=r.forages;t.close();for(var o=0;o<i.length;o++){var a=i[o];a._dbInfo.db=null,a._dbInfo.version=n}return new c((function(t,r){var i=s.open(e.name,n);i.onerror=function(e){i.result.close(),r(e)},i.onupgradeneeded=function(){i.result.deleteObjectStore(e.storeName)},i.onsuccess=function(){var e=i.result;e.close(),t(e)}})).then((function(e){r.db=e;for(var t=0;t<i.length;t++){var n=i[t];n._dbInfo.db=e,T(n._dbInfo)}})).catch((function(t){throw(A(e,t)||c.resolve()).catch((function(){})),t}))}})):o.then((function(t){x(e);var n=v[e.name],r=n.forages;t.close();for(var i=0;i<r.length;i++)r[i]._dbInfo.db=null;return new c((function(t,n){var r=s.deleteDatabase(e.name);r.onerror=r.onblocked=function(e){var t=r.result;t&&t.close(),n(e)},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}})).then((function(e){n.db=e;for(var t=0;t<r.length;t++)T(r[t]._dbInfo)})).catch((function(t){throw(A(e,t)||c.resolve()).catch((function(){})),t}))}))}else r=c.reject("Invalid arguments");return u(r,t),r}var $={_driver:"asyncStorage",_initStorage:D,_support:a(),iterate:F,getItem:U,setItem:j,removeItem:H,clear:B,length:V,key:G,keys:X,dropInstance:W};function q(){return"function"==typeof openDatabase}var K="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Y="~~local_forage_type~",Z=/^~~local_forage_type~([^~]+)~/,Q="__lfsc__:",J=Q.length,ee="arbf",te="blob",ne="si08",re="ui08",ie="uic8",oe="si16",se="si32",ae="ur16",le="ui32",ce="fl32",ue="fl64",he=J+ee.length,de=Object.prototype.toString;function pe(e){var t,n,r,i,o,s=.75*e.length,a=e.length,l=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var c=new ArrayBuffer(s),u=new Uint8Array(c);for(t=0;t<a;t+=4)n=K.indexOf(e[t]),r=K.indexOf(e[t+1]),i=K.indexOf(e[t+2]),o=K.indexOf(e[t+3]),u[l++]=n<<2|r>>4,u[l++]=(15&r)<<4|i>>2,u[l++]=(3&i)<<6|63&o;return c}function fe(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=K[n[t]>>2],r+=K[(3&n[t])<<4|n[t+1]>>4],r+=K[(15&n[t+1])<<2|n[t+2]>>6],r+=K[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}function me(e,t){var n="";if(e&&(n=de.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===de.call(e.buffer))){var r,i=Q;e instanceof ArrayBuffer?(r=e,i+=ee):(r=e.buffer,"[object Int8Array]"===n?i+=ne:"[object Uint8Array]"===n?i+=re:"[object Uint8ClampedArray]"===n?i+=ie:"[object Int16Array]"===n?i+=oe:"[object Uint16Array]"===n?i+=ae:"[object Int32Array]"===n?i+=se:"[object Uint32Array]"===n?i+=le:"[object Float32Array]"===n?i+=ce:"[object Float64Array]"===n?i+=ue:t(new Error("Failed to get type for BinaryArray"))),t(i+fe(r))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n=Y+e.type+"~"+fe(this.result);t(Q+te+n)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}}function ve(e){if(e.substring(0,J)!==Q)return JSON.parse(e);var t,n=e.substring(he),r=e.substring(J,he);if(r===te&&Z.test(n)){var i=n.match(Z);t=i[1],n=n.substring(i[0].length)}var o=pe(n);switch(r){case ee:return o;case te:return l([o],{type:t});case ne:return new Int8Array(o);case re:return new Uint8Array(o);case ie:return new Uint8ClampedArray(o);case oe:return new Int16Array(o);case ae:return new Uint16Array(o);case se:return new Int32Array(o);case le:return new Uint32Array(o);case ce:return new Float32Array(o);case ue:return new Float64Array(o);default:throw new Error("Unkown type: "+r)}}var ge={serialize:me,deserialize:ve,stringToBuffer:pe,bufferToString:fe};function ye(e,t,n,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function be(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var i=new c((function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return r(e)}n.db.transaction((function(i){ye(i,n,(function(){t._dbInfo=n,e()}),(function(e,t){r(t)}))}),r)}));return n.serializer=ge,i}function _e(e,t,n,r,i,o){e.executeSql(n,r,i,(function(e,s){s.code===s.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,a){a.rows.length?o(e,s):ye(e,t,(function(){e.executeSql(n,r,i,o)}),o)}),o):o(e,s)}),o)}function we(e,t){var n=this;e=d(e);var r=new c((function(t,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){_e(n,i,"SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=i.serializer.deserialize(r)),t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function Ee(e,t){var n=this,r=new c((function(t,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){_e(n,i,"SELECT * FROM "+i.storeName,[],(function(n,r){for(var o=r.rows,s=o.length,a=0;a<s;a++){var l=o.item(a),c=l.value;if(c&&(c=i.serializer.deserialize(c)),void 0!==(c=e(c,l.key,a+1)))return void t(c)}t()}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function xe(e,t,n,r){var i=this;e=d(e);var o=new c((function(o,s){i.ready().then((function(){void 0===t&&(t=null);var a=t,l=i._dbInfo;l.serializer.serialize(t,(function(t,c){c?s(c):l.db.transaction((function(n){_e(n,l,"INSERT OR REPLACE INTO "+l.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){o(a)}),(function(e,t){s(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(r>0)return void o(xe.apply(i,[e,a,n,r-1]));s(t)}}))}))})).catch(s)}));return u(o,n),o}function Te(e,t,n){return xe.apply(this,[e,t,n,1])}function Ae(e,t){var n=this;e=d(e);var r=new c((function(t,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){_e(n,i,"DELETE FROM "+i.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function Se(e){var t=this,n=new c((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){_e(t,r,"DELETE FROM "+r.storeName,[],(function(){e()}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,e),n}function Oe(e){var t=this,n=new c((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){_e(t,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],(function(t,n){var r=n.rows.item(0).c;e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,e),n}function Ie(e,t){var n=this,r=new c((function(t,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){_e(n,i,"SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function Re(e){var t=this,n=new c((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){_e(t,r,"SELECT key FROM "+r.storeName,[],(function(t,n){for(var r=[],i=0;i<n.rows.length;i++)r.push(n.rows.item(i).key);e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,e),n}function Me(e){return new c((function(t,n){e.transaction((function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(n,r){for(var i=[],o=0;o<r.rows.length;o++)i.push(r.rows.item(o).name);t({db:e,storeNames:i})}),(function(e,t){n(t)}))}),(function(e){n(e)}))}))}function Ce(e,t){t=p.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,i=this;return u(r=e.name?new c((function(t){var r;r=e.name===n.name?i._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:r,storeNames:[e.storeName]}):t(Me(r))})).then((function(e){return new c((function(t,n){e.db.transaction((function(r){function i(e){return new c((function(t,n){r.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){n(t)}))}))}for(var o=[],s=0,a=e.storeNames.length;s<a;s++)o.push(i(e.storeNames[s]));c.all(o).then((function(){t()})).catch((function(e){n(e)}))}),(function(e){n(e)}))}))})):c.reject("Invalid arguments"),t),r}var Le={_driver:"webSQLStorage",_initStorage:be,_support:q(),iterate:Ee,getItem:we,setItem:Te,removeItem:Ae,clear:Se,length:Oe,key:Ie,keys:Re,dropInstance:Ce};function Ne(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function ke(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function Pe(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}function ze(){return!Pe()||localStorage.length>0}function De(e){var t=this,n={};if(e)for(var r in e)n[r]=e[r];return n.keyPrefix=ke(e,t._defaultConfig),ze()?(t._dbInfo=n,n.serializer=ge,c.resolve()):c.reject()}function Ue(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}}));return u(n,e),n}function Fe(e,t){var n=this;e=d(e);var r=n.ready().then((function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r}));return u(r,t),r}function je(e,t){var n=this,r=n.ready().then((function(){for(var t=n._dbInfo,r=t.keyPrefix,i=r.length,o=localStorage.length,s=1,a=0;a<o;a++){var l=localStorage.key(a);if(0===l.indexOf(r)){var c=localStorage.getItem(l);if(c&&(c=t.serializer.deserialize(c)),void 0!==(c=e(c,l.substring(i),s++)))return c}}}));return u(r,t),r}function He(e,t){var n=this,r=n.ready().then((function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t}));return u(r,t),r}function Be(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo,n=localStorage.length,r=[],i=0;i<n;i++){var o=localStorage.key(i);0===o.indexOf(e.keyPrefix)&&r.push(o.substring(e.keyPrefix.length))}return r}));return u(n,e),n}function Ve(e){var t=this.keys().then((function(e){return e.length}));return u(t,e),t}function Ge(e,t){var n=this;e=d(e);var r=n.ready().then((function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return u(r,t),r}function Xe(e,t,n){var r=this;e=d(e);var i=r.ready().then((function(){void 0===t&&(t=null);var n=t;return new c((function(i,o){var s=r._dbInfo;s.serializer.serialize(t,(function(t,r){if(r)o(r);else try{localStorage.setItem(s.keyPrefix+e,t),i(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||o(e),o(e)}}))}))}));return u(i,n),i}function We(e,t){if(t=p.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}var r,i=this;return u(r=e.name?new c((function(t){e.storeName?t(ke(e,i._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}})):c.reject("Invalid arguments"),t),r}var $e={_driver:"localStorageWrapper",_initStorage:De,_support:Ne(),iterate:je,getItem:Fe,setItem:Xe,removeItem:Ge,clear:Ue,length:Ve,key:He,keys:Be,dropInstance:We},qe=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},Ke=function(e,t){for(var n=e.length,r=0;r<n;){if(qe(e[r],t))return!0;r++}return!1},Ye=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Ze={},Qe={},Je={INDEXEDDB:$,WEBSQL:Le,LOCALSTORAGE:$e},et=[Je.INDEXEDDB._driver,Je.WEBSQL._driver,Je.LOCALSTORAGE._driver],tt=["dropInstance"],nt=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(tt),rt={description:"",driver:et.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function it(e,t){e[t]=function(){var n=arguments;return e.ready().then((function(){return e[t].apply(e,n)}))}}function ot(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(Ye(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var st=new(function(){function e(t){for(var n in i(this,e),Je)if(Je.hasOwnProperty(n)){var r=Je[n],o=r._driver;this[n]=o,Ze[o]||this.defineDriver(r)}this._defaultConfig=ot({},rt),this._config=ot({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":r(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new c((function(t,n){try{var r=e._driver,i=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(i);for(var o=nt.concat("_initStorage"),s=0,a=o.length;s<a;s++){var l=o[s];if((!Ke(tt,l)||e[l])&&"function"!=typeof e[l])return void n(i)}!function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),n=c.reject(t);return u(n,arguments[arguments.length-1]),n}},n=0,r=tt.length;n<r;n++){var i=tt[n];e[i]||(e[i]=t(i))}}();var h=function(n){Ze[r]&&console.info("Redefining LocalForage driver: "+r),Ze[r]=e,Qe[r]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(h,n):h(!!e._support):h(!0)}catch(e){n(e)}}));return h(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=Ze[e]?c.resolve(Ze[e]):c.reject(new Error("Driver not found."));return h(r,t,n),r},e.prototype.getSerializer=function(e){var t=c.resolve(ge);return h(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return h(n,e,e),n},e.prototype.setDriver=function(e,t,n){var r=this;Ye(e)||(e=[e]);var i=this._getSupportedDrivers(e);function o(){r._config.driver=r.driver()}function s(e){return r._extend(e),o(),r._ready=r._initStorage(r._config),r._ready}function a(e){return function(){var t=0;function n(){for(;t<e.length;){var i=e[t];return t++,r._dbInfo=null,r._ready=null,r.getDriver(i).then(s).catch(n)}o();var a=new Error("No available storage method found.");return r._driverSet=c.reject(a),r._driverSet}return n()}}var l=null!==this._driverSet?this._driverSet.catch((function(){return c.resolve()})):c.resolve();return this._driverSet=l.then((function(){var e=i[0];return r._dbInfo=null,r._ready=null,r.getDriver(e).then((function(e){r._driver=e._driver,o(),r._wrapLibraryMethodsWithReady(),r._initDriver=a(i)}))})).catch((function(){o();var e=new Error("No available storage method found.");return r._driverSet=c.reject(e),r._driverSet})),h(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!Qe[e]},e.prototype._extend=function(e){ot(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];this.supports(i)&&t.push(i)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=nt.length;e<t;e++)it(this,nt[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=st},{3:3}]},{},[4])(4)}));var c=n(3398);class u extends r.L{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new m(e)})),this.register((function(e){return new g(e)})),this.register((function(e){return new y(e)})),this.register((function(e){return new v(e)})),this.register((function(e){return new p(e)})),this.register((function(e){return new b(e)}))}load(e,t,n,i){const o=this;let s;s=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:r.k.extractUrlBase(e),this.manager.itemStart(e);const a=function(t){i?i(t):console.error(t),o.manager.itemError(e),o.manager.itemEnd(e)},l=new r.l(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,(function(n){try{o.parse(n,s,(function(n){t(n),o.manager.itemEnd(e)}),a)}catch(e){a(e)}}),n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,i){let o;const s={},a={};if("string"==typeof e)o=e;else{if(r.k.decodeText(new Uint8Array(e,0,4))===_){try{s[d.KHR_BINARY_GLTF]=new x(e)}catch(e){return void(i&&i(e))}o=s[d.KHR_BINARY_GLTF].content}else o=r.k.decodeText(new Uint8Array(e))}const l=JSON.parse(o);if(void 0===l.asset||l.asset.version[0]<2)return void(i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const c=new ee(l,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){const t=this.pluginCallbacks[e](c);a[t.name]=t,s[t.name]=!0}if(l.extensionsUsed)for(let e=0;e<l.extensionsUsed.length;++e){const t=l.extensionsUsed[e],n=l.extensionsRequired||[];switch(t){case d.KHR_MATERIALS_UNLIT:s[t]=new f;break;case d.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:s[t]=new O;break;case d.KHR_DRACO_MESH_COMPRESSION:s[t]=new T(l,this.dracoLoader);break;case d.KHR_TEXTURE_TRANSFORM:s[t]=new A;break;case d.KHR_MESH_QUANTIZATION:s[t]=new I;break;default:n.indexOf(t)>=0&&void 0===a[t]&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}c.setExtensions(s),c.setPlugins(a),c.parse(n,i)}}function h(){let e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const d={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class p{constructor(e){this.parser=e,this.name=d.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const r=t[n];r.extensions&&r.extensions[this.name]&&void 0!==r.extensions[this.name].light&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let i=t.cache.get(n);if(i)return i;const o=t.json,s=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e];let a;const l=new r.C(16777215);void 0!==s.color&&l.fromArray(s.color);const c=void 0!==s.range?s.range:0;switch(s.type){case"directional":a=new r.D(l),a.target.position.set(0,0,-1),a.add(a.target);break;case"point":a=new r.P(l),a.distance=c;break;case"spot":a=new r.m(l),a.distance=c,s.spot=s.spot||{},s.spot.innerConeAngle=void 0!==s.spot.innerConeAngle?s.spot.innerConeAngle:0,s.spot.outerConeAngle=void 0!==s.spot.outerConeAngle?s.spot.outerConeAngle:Math.PI/4,a.angle=s.spot.outerConeAngle,a.penumbra=1-s.spot.innerConeAngle/s.spot.outerConeAngle,a.target.position.set(0,0,-1),a.add(a.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+s.type)}return a.position.set(0,0,0),a.decay=2,void 0!==s.intensity&&(a.intensity=s.intensity),a.name=t.createUniqueName(s.name||"light_"+e),i=Promise.resolve(a),t.cache.add(n,i),i}createNodeAttachment(e){const t=this,n=this.parser,r=n.json.nodes[e],i=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===i?null:this._loadLight(i).then((function(e){return n._getNodeRef(t.cache,i,e)}))}}class f{constructor(){this.name=d.KHR_MATERIALS_UNLIT}getMaterialType(){return r.n}extendParams(e,t,n){const i=[];e.color=new r.C(1,1,1),e.opacity=1;const o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){const t=o.baseColorFactor;e.color.fromArray(t),e.opacity=t[3]}void 0!==o.baseColorTexture&&i.push(n.assignTexture(e,"map",o.baseColorTexture))}return Promise.all(i)}}class m{constructor(e){this.parser=e,this.name=d.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?r.o:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const o=[],s=i.extensions[this.name];if(void 0!==s.clearcoatFactor&&(t.clearcoat=s.clearcoatFactor),void 0!==s.clearcoatTexture&&o.push(n.assignTexture(t,"clearcoatMap",s.clearcoatTexture)),void 0!==s.clearcoatRoughnessFactor&&(t.clearcoatRoughness=s.clearcoatRoughnessFactor),void 0!==s.clearcoatRoughnessTexture&&o.push(n.assignTexture(t,"clearcoatRoughnessMap",s.clearcoatRoughnessTexture)),void 0!==s.clearcoatNormalTexture&&(o.push(n.assignTexture(t,"clearcoatNormalMap",s.clearcoatNormalTexture)),void 0!==s.clearcoatNormalTexture.scale)){const e=s.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new r.V(e,-e)}return Promise.all(o)}}class v{constructor(e){this.parser=e,this.name=d.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?r.o:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&i.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(i)}}class g{constructor(e){this.parser=e,this.name=d.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const i=r.extensions[this.name],o=n.images[i.source],s=t.options.ktx2Loader;if(!s){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,o,s)}}class y{constructor(e){this.parser=e,this.name=d.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,i=r.textures[e];if(!i.extensions||!i.extensions[t])return null;const o=i.extensions[t],s=r.images[o.source];let a=n.textureLoader;if(s.uri){const e=n.options.manager.getHandler(s.uri);null!==e&&(a=e)}return this.detectSupport().then((function(i){if(i)return n.loadTextureImage(e,s,a);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class b{constructor(e){this.name=d.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const e=n.extensions[this.name],r=this.parser.getDependency("buffer",e.buffer),i=this.parser.options.meshoptDecoder;if(!i||!i.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([r,i.ready]).then((function(t){const n=e.byteOffset||0,r=e.byteLength||0,o=e.count,s=e.byteStride,a=new ArrayBuffer(o*s),l=new Uint8Array(t[0],n,r);return i.decodeGltfBuffer(new Uint8Array(a),o,s,l,e.mode,e.filter),a}))}return null}}const _="glTF",w=1313821514,E=5130562;class x{constructor(e){this.name=d.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12);if(this.header={magic:r.k.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==_)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-12,i=new DataView(e,12);let o=0;for(;o<n;){const t=i.getUint32(o,!0);o+=4;const n=i.getUint32(o,!0);if(o+=4,n===w){const n=new Uint8Array(e,12+o,t);this.content=r.k.decodeText(n)}else if(n===E){const n=12+o;this.body=e.slice(n,n+t)}o+=t}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class T{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=d.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,i=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,s={},a={},l={};for(const e in o){const t=H[e]||e.toLowerCase();s[t]=o[e]}for(const t in e.attributes){const r=H[t]||t.toLowerCase();if(void 0!==o[t]){const i=n.accessors[e.attributes[t]],o=D[i.componentType];l[r]=o,a[r]=!0===i.normalized}}return t.getDependency("bufferView",i).then((function(e){return new Promise((function(t){r.decodeDracoFile(e,(function(e){for(const t in e.attributes){const n=e.attributes[t],r=a[t];void 0!==r&&(n.normalized=r)}t(e)}),s,l)}))}))}}class A{constructor(){this.name=d.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class S extends r.A{constructor(e){super(),this.isGLTFSpecularGlossinessMaterial=!0;const t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),n=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),i=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),o=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),s=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),a={specular:{value:(new r.C).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=a,this.onBeforeCompile=function(e){for(const t in a)e.uniforms[t]=a[t];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",n).replace("#include <roughnessmap_fragment>",i).replace("#include <metalnessmap_fragment>",o).replace("#include <lights_physical_fragment>",s)},Object.defineProperties(this,{specular:{get:function(){return a.specular.value},set:function(e){a.specular.value=e}},specularMap:{get:function(){return a.specularMap.value},set:function(e){a.specularMap.value=e,e?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return a.glossiness.value},set:function(e){a.glossiness.value=e}},glossinessMap:{get:function(){return a.glossinessMap.value},set:function(e){a.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(e){return super.copy(e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class O{constructor(){this.name=d.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}getMaterialType(){return S}extendParams(e,t,n){const i=t.extensions[this.name];e.color=new r.C(1,1,1),e.opacity=1;const o=[];if(Array.isArray(i.diffuseFactor)){const t=i.diffuseFactor;e.color.fromArray(t),e.opacity=t[3]}if(void 0!==i.diffuseTexture&&o.push(n.assignTexture(e,"map",i.diffuseTexture)),e.emissive=new r.C(0,0,0),e.glossiness=void 0!==i.glossinessFactor?i.glossinessFactor:1,e.specular=new r.C(1,1,1),Array.isArray(i.specularFactor)&&e.specular.fromArray(i.specularFactor),void 0!==i.specularGlossinessTexture){const t=i.specularGlossinessTexture;o.push(n.assignTexture(e,"glossinessMap",t)),o.push(n.assignTexture(e,"specularMap",t))}return Promise.all(o)}createMaterial(e){const t=new S(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=r.p,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}class I{constructor(){this.name=d.KHR_MESH_QUANTIZATION}}class R extends r.a7{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r*3+r;for(let e=0;e!==r;e++)t[e]=n[i+e];return t}}R.prototype.beforeStart_=R.prototype.copySampleValue_,R.prototype.afterEnd_=R.prototype.copySampleValue_,R.prototype.interpolate_=function(e,t,n,r){const i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=2*s,l=3*s,c=r-t,u=(n-t)/c,h=u*u,d=h*u,p=e*l,f=p-l,m=-2*d+3*h,v=d-h,g=1-m,y=v-h+u;for(let e=0;e!==s;e++){const t=o[f+e+s],n=o[f+e+a]*c,r=o[p+e+s],l=o[p+e]*c;i[e]=g*t+y*n+m*r+v*l}return i};const M=0,C=1,L=2,N=3,k=4,P=5,z=6,D={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},U={9728:r.a8,9729:r.u,9984:r.a9,9985:r.aa,9986:r.ab,9987:r.v},F={33071:r.ac,33648:r.ad,10497:r.w},j={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},H={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},B={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},V={CUBICSPLINE:void 0,LINEAR:r.a2,STEP:r.ae},G="OPAQUE",X="MASK",W="BLEND";function $(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}function q(e,t,n){for(const r in n.extensions)void 0===e[r]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[r]=n.extensions[r])}function K(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function Y(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let n=0,r=t.weights.length;n<r;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){const n=t.extras.targetNames;if(e.morphTargetInfluences.length===n.length){e.morphTargetDictionary={};for(let t=0,r=n.length;t<r;t++)e.morphTargetDictionary[n[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Z(e){const t=e.extensions&&e.extensions[d.KHR_DRACO_MESH_COMPRESSION];let n;return n=t?"draco:"+t.bufferView+":"+t.indices+":"+Q(t.attributes):e.indices+":"+Q(e.attributes)+":"+e.mode,n}function Q(e){let t="";const n=Object.keys(e).sort();for(let r=0,i=n.length;r<i;r++)t+=n[r]+":"+e[n[r]]+";";return t}function J(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class ee{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new h,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.textureCache={},this.nodeNamesUsed={},"undefined"!=typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new r.q(this.options.manager):this.textureLoader=new r.T(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new r.l(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,i=this.extensions;this.cache.removeAll(),this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(t){const o={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};q(i,o,r),K(o,r),Promise.all(n._invokeAll((function(e){return e.afterRoot&&e.afterRoot(o)}))).then((function(){e(o)}))})).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let n=0,r=t.length;n<r;n++){const r=t[n].joints;for(let t=0,n=r.length;t<n;t++)e[r[t]].isBone=!0}for(let t=0,r=e.length;t<r;t++){const r=e[t];void 0!==r.mesh&&(this._addNodeRef(this.meshCache,r.mesh),void 0!==r.skin&&(n[r.mesh].isSkinnedMesh=!0)),void 0!==r.camera&&this._addNodeRef(this.cameraCache,r.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone();return r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const i=e(t[r]);i&&n.push(i)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":r=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":r=this.loadSkin(t);break;case"animation":r=this.loadAnimation(t);break;case"camera":r=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,r=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(r.map((function(t,r){return n.getDependency(e,r)}))),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[d.KHR_BINARY_GLTF].body);const r=this.options;return new Promise((function(e,i){n.load($(t.uri,r.path),e,void 0,(function(){i(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){const n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)}))}loadAccessor(e){const t=this,n=this.json,i=this.json.accessors[e];if(void 0===i.bufferView&&void 0===i.sparse)return Promise.resolve(null);const o=[];return void 0!==i.bufferView?o.push(this.getDependency("bufferView",i.bufferView)):o.push(null),void 0!==i.sparse&&(o.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(o).then((function(e){const o=e[0],s=j[i.type],a=D[i.componentType],l=a.BYTES_PER_ELEMENT,c=l*s,u=i.byteOffset||0,h=void 0!==i.bufferView?n.bufferViews[i.bufferView].byteStride:void 0,d=!0===i.normalized;let p,f;if(h&&h!==c){const e=Math.floor(u/h),n="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+e+":"+i.count;let c=t.cache.get(n);c||(p=new a(o,e*h,i.count*h/l),c=new r.r(p,h/l),t.cache.add(n,c)),f=new r.ag(c,s,u%h/l,d)}else p=null===o?new a(i.count*s):new a(o,u,i.count*s),f=new r.s(p,s,d);if(void 0!==i.sparse){const t=j.SCALAR,n=D[i.sparse.indices.componentType],l=i.sparse.indices.byteOffset||0,c=i.sparse.values.byteOffset||0,u=new n(e[1],l,i.sparse.count*t),h=new a(e[2],c,i.sparse.count*s);null!==o&&(f=new r.s(f.array.slice(),f.itemSize,f.normalized));for(let e=0,t=u.length;e<t;e++){const t=u[e];if(f.setX(t,h[e*s]),s>=2&&f.setY(t,h[e*s+1]),s>=3&&f.setZ(t,h[e*s+2]),s>=4&&f.setW(t,h[e*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return f}))}loadTexture(e){const t=this.json,n=this.options,r=t.textures[e],i=t.images[r.source];let o=this.textureLoader;if(i.uri){const e=n.manager.getHandler(i.uri);null!==e&&(o=e)}return this.loadTextureImage(e,i,o)}loadTextureImage(e,t,n){const i=this,o=this.json,s=this.options,a=o.textures[e],l=(t.uri||t.bufferView)+":"+a.sampler;if(this.textureCache[l])return this.textureCache[l];const c=self.URL||self.webkitURL;let u=t.uri||"",h=!1,d=!0;const p=u.search(/\.jpe?g($|\?)/i)>0||0===u.search(/^data\:image\/jpeg/);if(("image/jpeg"===t.mimeType||p)&&(d=!1),void 0!==t.bufferView)u=i.getDependency("bufferView",t.bufferView).then((function(e){if("image/png"===t.mimeType){const t=new DataView(e,25,1).getUint8(0,!1);d=6===t||4===t||3===t}h=!0;const n=new Blob([e],{type:t.mimeType});return u=c.createObjectURL(n),u}));else if(void 0===t.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const f=Promise.resolve(u).then((function(e){return new Promise((function(t,i){let o=t;!0===n.isImageBitmapLoader&&(o=function(e){t(new r.ah(e))}),n.load($(e,s.path),o,void 0,i)}))})).then((function(t){!0===h&&c.revokeObjectURL(u),t.flipY=!1,a.name&&(t.name=a.name),d||(t.format=r.t);const n=(o.samplers||{})[a.sampler]||{};return t.magFilter=U[n.magFilter]||r.u,t.minFilter=U[n.minFilter]||r.v,t.wrapS=F[n.wrapS]||r.w,t.wrapT=F[n.wrapT]||r.w,i.associations.set(t,{type:"textures",index:e}),t}));return this.textureCache[l]=f,f}assignTexture(e,t,n){const r=this;return this.getDependency("texture",n.index).then((function(i){if(void 0===n.texCoord||0==n.texCoord||"aoMap"===t&&1==n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),r.extensions[d.KHR_TEXTURE_TRANSFORM]){const e=void 0!==n.extensions?n.extensions[d.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const t=r.associations.get(i);i=r.extensions[d.KHR_TEXTURE_TRANSFORM].extendTexture(i,e),r.associations.set(i,t)}}e[t]=i}))}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const i=void 0!==t.attributes.tangent,o=void 0!==t.attributes.color,s=void 0===t.attributes.normal,a=Object.keys(t.morphAttributes).length>0,l=a&&void 0!==t.morphAttributes.normal;if(e.isPoints){const e="PointsMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new r.x,r.y.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,t.sizeAttenuation=!1,this.cache.add(e,t)),n=t}else if(e.isLine){const e="LineBasicMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new r.z,r.y.prototype.copy.call(t,n),t.color.copy(n.color),this.cache.add(e,t)),n=t}if(i||o||s||a){let e="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(e+="specular-glossiness:"),i&&(e+="vertex-tangents:"),o&&(e+="vertex-colors:"),s&&(e+="flat-shading:"),a&&(e+="morph-targets:"),l&&(e+="morph-normals:");let t=this.cache.get(e);t||(t=n.clone(),o&&(t.vertexColors=!0),s&&(t.flatShading=!0),a&&(t.morphTargets=!0),l&&(t.morphNormals=!0),i&&(t.vertexTangents=!0,t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(n))),n=t}n.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=n}getMaterialType(){return r.A}loadMaterial(e){const t=this,n=this.json,i=this.extensions,o=n.materials[e];let s;const a={},l=o.extensions||{},c=[];if(l[d.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const e=i[d.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];s=e.getMaterialType(),c.push(e.extendParams(a,o,t))}else if(l[d.KHR_MATERIALS_UNLIT]){const e=i[d.KHR_MATERIALS_UNLIT];s=e.getMaterialType(),c.push(e.extendParams(a,o,t))}else{const n=o.pbrMetallicRoughness||{};if(a.color=new r.C(1,1,1),a.opacity=1,Array.isArray(n.baseColorFactor)){const e=n.baseColorFactor;a.color.fromArray(e),a.opacity=e[3]}void 0!==n.baseColorTexture&&c.push(t.assignTexture(a,"map",n.baseColorTexture)),a.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,a.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(c.push(t.assignTexture(a,"metalnessMap",n.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",n.metallicRoughnessTexture))),s=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),c.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,a)}))))}!0===o.doubleSided&&(a.side=r.J);const u=o.alphaMode||G;return u===W?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,u===X&&(a.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&s!==r.n&&(c.push(t.assignTexture(a,"normalMap",o.normalTexture)),a.normalScale=new r.V(1,-1),void 0!==o.normalTexture.scale&&a.normalScale.set(o.normalTexture.scale,-o.normalTexture.scale)),void 0!==o.occlusionTexture&&s!==r.n&&(c.push(t.assignTexture(a,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(a.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&s!==r.n&&(a.emissive=(new r.C).fromArray(o.emissiveFactor)),void 0!==o.emissiveTexture&&s!==r.n&&c.push(t.assignTexture(a,"emissiveMap",o.emissiveTexture)),Promise.all(c).then((function(){let n;return n=s===S?i[d.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):new s(a),o.name&&(n.name=o.name),n.map&&(n.map.encoding=r.K),n.emissiveMap&&(n.emissiveMap.encoding=r.K),K(n,o),t.associations.set(n,{type:"materials",index:e}),o.extensions&&q(i,n,o),n}))}createUniqueName(e){const t=r.U.sanitizeNodeName(e||"");let n=t;for(let e=1;this.nodeNamesUsed[n];++e)n=t+"_"+e;return this.nodeNamesUsed[n]=!0,n}loadGeometries(e){const t=this,n=this.extensions,i=this.primitiveCache;function o(e){return n[d.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return ne(n,e,t)}))}const s=[];for(let n=0,a=e.length;n<a;n++){const a=e[n],l=Z(a),c=i[l];if(c)s.push(c.promise);else{let e;e=a.extensions&&a.extensions[d.KHR_DRACO_MESH_COMPRESSION]?o(a):ne(new r.X,a,t),i[l]={primitive:a,promise:e},s.push(e)}}return Promise.all(s)}loadMesh(e){const t=this,n=this.json,i=this.extensions,o=n.meshes[e],s=o.primitives,a=[];for(let e=0,t=s.length;e<t;e++){const t=void 0===s[e].material?(void 0===(l=this.cache).DefaultMaterial&&(l.DefaultMaterial=new r.A({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:r.af})),l.DefaultMaterial):this.getDependency("material",s[e].material);a.push(t)}var l;return a.push(t.loadGeometries(s)),Promise.all(a).then((function(n){const a=n.slice(0,n.length-1),l=n[n.length-1],c=[];for(let n=0,u=l.length;n<u;n++){const u=l[n],h=s[n];let d;const p=a[n];if(h.mode===k||h.mode===P||h.mode===z||void 0===h.mode)d=!0===o.isSkinnedMesh?new r.Y(u,p):new r.j(u,p),!0!==d.isSkinnedMesh||d.geometry.attributes.skinWeight.normalized||d.normalizeSkinWeights(),h.mode===P?d.geometry=re(d.geometry,r.ai):h.mode===z&&(d.geometry=re(d.geometry,r.a6));else if(h.mode===C)d=new r.Z(u,p);else if(h.mode===N)d=new r._(u,p);else if(h.mode===L)d=new r.$(u,p);else{if(h.mode!==M)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+h.mode);d=new r.a0(u,p)}Object.keys(d.geometry.morphAttributes).length>0&&Y(d,o),d.name=t.createUniqueName(o.name||"mesh_"+e),K(d,o),h.extensions&&q(i,d,h),t.assignFinalMaterial(d),c.push(d)}if(1===c.length)return c[0];const u=new r.G;for(let e=0,t=c.length;e<t;e++)u.add(c[e]);return u}))}loadCamera(e){let t;const n=this.json.cameras[e],i=n[n.type];if(i)return"perspective"===n.type?t=new r.a1(r.M.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===n.type&&(t=new r.O(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),K(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return n.inverseBindMatrices=e,n}))}loadAnimation(e){const t=this.json.animations[e],n=[],i=[],o=[],s=[],a=[];for(let e=0,r=t.channels.length;e<r;e++){const r=t.channels[e],l=t.samplers[r.sampler],c=r.target,u=void 0!==c.node?c.node:c.id,h=void 0!==t.parameters?t.parameters[l.input]:l.input,d=void 0!==t.parameters?t.parameters[l.output]:l.output;n.push(this.getDependency("node",u)),i.push(this.getDependency("accessor",h)),o.push(this.getDependency("accessor",d)),s.push(l),a.push(c)}return Promise.all([Promise.all(n),Promise.all(i),Promise.all(o),Promise.all(s),Promise.all(a)]).then((function(n){const i=n[0],o=n[1],s=n[2],a=n[3],l=n[4],c=[];for(let e=0,t=i.length;e<t;e++){const t=i[e],n=o[e],u=s[e],h=a[e],d=l[e];if(void 0===t)continue;let p;switch(t.updateMatrix(),t.matrixAutoUpdate=!0,B[d.path]){case B.weights:p=r.al;break;case B.rotation:p=r.ak;break;case B.position:case B.scale:default:p=r.aj}const f=t.name?t.name:t.uuid,m=void 0!==h.interpolation?V[h.interpolation]:r.a2,v=[];B[d.path]===B.weights?t.traverse((function(e){!0===e.isMesh&&e.morphTargetInfluences&&v.push(e.name?e.name:e.uuid)})):v.push(f);let g=u.array;if(u.normalized){const e=J(g.constructor),t=new Float32Array(g.length);for(let n=0,r=g.length;n<r;n++)t[n]=g[n]*e;g=t}for(let e=0,t=v.length;e<t;e++){const t=new p(v[e]+"."+B[d.path],n.array,g,m);"CUBICSPLINE"===h.interpolation&&(t.createInterpolant=function(e){return new R(this.times,this.values,this.getValueSize()/3,e)},t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),c.push(t)}}const u=t.name?t.name:"animation_"+e;return new r.a3(u,void 0,c)}))}createNodeMesh(e){const t=this.json,n=this,r=t.nodes[e];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then((function(e){const t=n._getNodeRef(n.meshCache,r.mesh,e);return void 0!==r.weights&&t.traverse((function(e){if(e.isMesh)for(let t=0,n=r.weights.length;t<n;t++)e.morphTargetInfluences[t]=r.weights[t]})),t}))}loadNode(e){const t=this.json,n=this.extensions,i=this,o=t.nodes[e],s=o.name?i.createUniqueName(o.name):"";return function(){const t=[],n=i._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));return n&&t.push(n),void 0!==o.camera&&t.push(i.getDependency("camera",o.camera).then((function(e){return i._getNodeRef(i.cameraCache,o.camera,e)}))),i._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){t.push(e)})),Promise.all(t)}().then((function(t){let a;if(a=!0===o.isBone?new r.a4:t.length>1?new r.G:1===t.length?t[0]:new r.i,a!==t[0])for(let e=0,n=t.length;e<n;e++)a.add(t[e]);if(o.name&&(a.userData.name=o.name,a.name=s),K(a,o),o.extensions&&q(n,a,o),void 0!==o.matrix){const e=new r.e;e.fromArray(o.matrix),a.applyMatrix4(e)}else void 0!==o.translation&&a.position.fromArray(o.translation),void 0!==o.rotation&&a.quaternion.fromArray(o.rotation),void 0!==o.scale&&a.scale.fromArray(o.scale);return i.associations.set(a,{type:"nodes",index:e}),a}))}loadScene(e){const t=this.json,n=this.extensions,i=this.json.scenes[e],o=this,s=new r.G;i.name&&(s.name=o.createUniqueName(i.name)),K(s,i),i.extensions&&q(n,s,i);const a=i.nodes||[],l=[];for(let e=0,n=a.length;e<n;e++)l.push(te(a[e],s,t,o));return Promise.all(l).then((function(){return s}))}}function te(e,t,n,i){const o=n.nodes[e];return i.getDependency("node",e).then((function(e){if(void 0===o.skin)return e;let t;return i.getDependency("skin",o.skin).then((function(e){t=e;const n=[];for(let e=0,r=t.joints.length;e<r;e++)n.push(i.getDependency("node",t.joints[e]));return Promise.all(n)})).then((function(n){return e.traverse((function(e){if(!e.isMesh)return;const i=[],o=[];for(let e=0,s=n.length;e<s;e++){const s=n[e];if(s){i.push(s);const n=new r.e;void 0!==t.inverseBindMatrices&&n.fromArray(t.inverseBindMatrices.array,16*e),o.push(n)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[e])}e.bind(new r.a5(i,o),e.matrixWorld)})),e}))})).then((function(e){t.add(e);const r=[];if(o.children){const t=o.children;for(let o=0,s=t.length;o<s;o++){const s=t[o];r.push(te(s,e,n,i))}}return Promise.all(r)}))}function ne(e,t,n){const i=t.attributes,o=[];function s(t,r){return n.getDependency("accessor",t).then((function(t){e.setAttribute(r,t)}))}for(const t in i){const n=H[t]||t.toLowerCase();n in e.attributes||o.push(s(i[t],n))}if(void 0!==t.indices&&!e.index){const r=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));o.push(r)}return K(e,t),function(e,t,n){const i=t.attributes,o=new r.B;if(void 0===i.POSITION)return;{const e=n.json.accessors[i.POSITION],t=e.min,s=e.max;if(void 0===t||void 0===s)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(o.set(new r.b(t[0],t[1],t[2]),new r.b(s[0],s[1],s[2])),e.normalized){const t=J(D[e.componentType]);o.min.multiplyScalar(t),o.max.multiplyScalar(t)}}const s=t.targets;if(void 0!==s){const e=new r.b,t=new r.b;for(let r=0,i=s.length;r<i;r++){const i=s[r];if(void 0!==i.POSITION){const r=n.json.accessors[i.POSITION],o=r.min,s=r.max;if(void 0!==o&&void 0!==s){if(t.setX(Math.max(Math.abs(o[0]),Math.abs(s[0]))),t.setY(Math.max(Math.abs(o[1]),Math.abs(s[1]))),t.setZ(Math.max(Math.abs(o[2]),Math.abs(s[2]))),r.normalized){const e=J(D[r.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}o.expandByVector(e)}e.boundingBox=o;const a=new r.f;o.getCenter(a.center),a.radius=o.min.distanceTo(o.max)/2,e.boundingSphere=a}(e,t,n),Promise.all(o).then((function(){return void 0!==t.targets?function(e,t,n){let r=!1,i=!1;for(let e=0,n=t.length;e<n;e++){const n=t[e];if(void 0!==n.POSITION&&(r=!0),void 0!==n.NORMAL&&(i=!0),r&&i)break}if(!r&&!i)return Promise.resolve(e);const o=[],s=[];for(let a=0,l=t.length;a<l;a++){const l=t[a];if(r){const t=void 0!==l.POSITION?n.getDependency("accessor",l.POSITION):e.attributes.position;o.push(t)}if(i){const t=void 0!==l.NORMAL?n.getDependency("accessor",l.NORMAL):e.attributes.normal;s.push(t)}}return Promise.all([Promise.all(o),Promise.all(s)]).then((function(t){const n=t[0],o=t[1];return r&&(e.morphAttributes.position=n),i&&(e.morphAttributes.normal=o),e.morphTargetsRelative=!0,e}))}(e,t.targets,n):e}))}function re(e,t){let n=e.getIndex();if(null===n){const t=[],r=e.getAttribute("position");if(void 0===r)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<r.count;e++)t.push(e);e.setIndex(t),n=e.getIndex()}const i=n.count-2,o=[];if(t===r.a6)for(let e=1;e<=i;e++)o.push(n.getX(0)),o.push(n.getX(e)),o.push(n.getX(e+1));else for(let e=0;e<i;e++)e%2==0?(o.push(n.getX(e)),o.push(n.getX(e+1)),o.push(n.getX(e+2))):(o.push(n.getX(e+2)),o.push(n.getX(e+1)),o.push(n.getX(e)));o.length/3!==i&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=e.clone();return s.setIndex(o),s}const ie=/^[og]\s*(.+)?/,oe=/^mtllib /,se=/^usemtl /,ae=/^usemap /,le=new r.b,ce=new r.b,ue=new r.b,he=new r.b,de=new r.b;function pe(){const e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);const n=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(e,t){const n=this._finalize(!1);n&&(n.inherited||n.groupCount<=0)&&this.materials.splice(n.index,1);const r={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==n?n.smooth:this.smooth,groupStart:void 0!==n?n.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){const t={index:"number"==typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(r),r},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){const t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(let e=this.materials.length-1;e>=0;e--)this.materials[e].groupCount<=0&&this.materials.splice(e,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},n&&n.name&&"function"==typeof n.clone){const e=n.clone(0);e.inherited=!0,this.object.materials.push(e)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseNormalIndex:function(e,t){const n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseUVIndex:function(e,t){const n=parseInt(e,10);return 2*(n>=0?n-1:n+t/2)},addVertex:function(e,t,n){const r=this.vertices,i=this.object.geometry.vertices;i.push(r[e+0],r[e+1],r[e+2]),i.push(r[t+0],r[t+1],r[t+2]),i.push(r[n+0],r[n+1],r[n+2])},addVertexPoint:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,n){const r=this.normals,i=this.object.geometry.normals;i.push(r[e+0],r[e+1],r[e+2]),i.push(r[t+0],r[t+1],r[t+2]),i.push(r[n+0],r[n+1],r[n+2])},addFaceNormal:function(e,t,n){const r=this.vertices,i=this.object.geometry.normals;le.fromArray(r,e),ce.fromArray(r,t),ue.fromArray(r,n),de.subVectors(ue,ce),he.subVectors(le,ce),de.cross(he),de.normalize(),i.push(de.x,de.y,de.z),i.push(de.x,de.y,de.z),i.push(de.x,de.y,de.z)},addColor:function(e,t,n){const r=this.colors,i=this.object.geometry.colors;void 0!==r[e]&&i.push(r[e+0],r[e+1],r[e+2]),void 0!==r[t]&&i.push(r[t+0],r[t+1],r[t+2]),void 0!==r[n]&&i.push(r[n+0],r[n+1],r[n+2])},addUV:function(e,t,n){const r=this.uvs,i=this.object.geometry.uvs;i.push(r[e+0],r[e+1]),i.push(r[t+0],r[t+1]),i.push(r[n+0],r[n+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,n,r,i,o,s,a,l){const c=this.vertices.length;let u=this.parseVertexIndex(e,c),h=this.parseVertexIndex(t,c),d=this.parseVertexIndex(n,c);if(this.addVertex(u,h,d),this.addColor(u,h,d),void 0!==s&&""!==s){const e=this.normals.length;u=this.parseNormalIndex(s,e),h=this.parseNormalIndex(a,e),d=this.parseNormalIndex(l,e),this.addNormal(u,h,d)}else this.addFaceNormal(u,h,d);if(void 0!==r&&""!==r){const e=this.uvs.length;u=this.parseUVIndex(r,e),h=this.parseUVIndex(i,e),d=this.parseUVIndex(o,e),this.addUV(u,h,d),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let n=0,r=e.length;n<r;n++){const r=this.parseVertexIndex(e[n],t);this.addVertexPoint(r),this.addColor(r)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const n=this.vertices.length,r=this.uvs.length;for(let t=0,r=e.length;t<r;t++)this.addVertexLine(this.parseVertexIndex(e[t],n));for(let e=0,n=t.length;e<n;e++)this.addUVLine(this.parseUVIndex(t[e],r))}};return e.startObject("",!1),e}class fe extends r.L{constructor(e){super(e),this.materials=null}load(e,t,n,i){const o=this,s=new r.l(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(n){try{t(o.parse(n))}catch(t){i?i(t):console.error(t),o.manager.itemError(e)}}),n,i)}setMaterials(e){return this.materials=e,this}parse(e){const t=new pe;-1!==e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"\n")),-1!==e.indexOf("\\\n")&&(e=e.replace(/\\\n/g,""));const n=e.split("\n");let i="",o="",s=0,a=[];const l="function"==typeof"".trimLeft;for(let e=0,r=n.length;e<r;e++)if(i=n[e],i=l?i.trimLeft():i.trim(),s=i.length,0!==s&&(o=i.charAt(0),"#"!==o))if("v"===o){const e=i.split(/\s+/);switch(e[0]){case"v":t.vertices.push(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])),e.length>=7?t.colors.push(parseFloat(e[4]),parseFloat(e[5]),parseFloat(e[6])):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]));break;case"vt":t.uvs.push(parseFloat(e[1]),parseFloat(e[2]))}}else if("f"===o){const e=i.substr(1).trim().split(/\s+/),n=[];for(let t=0,r=e.length;t<r;t++){const r=e[t];if(r.length>0){const e=r.split("/");n.push(e)}}const r=n[0];for(let e=1,i=n.length-1;e<i;e++){const i=n[e],o=n[e+1];t.addFace(r[0],i[0],o[0],r[1],i[1],o[1],r[2],i[2],o[2])}}else if("l"===o){const e=i.substring(1).trim().split(" ");let n=[];const r=[];if(-1===i.indexOf("/"))n=e;else for(let t=0,i=e.length;t<i;t++){const i=e[t].split("/");""!==i[0]&&n.push(i[0]),""!==i[1]&&r.push(i[1])}t.addLineGeometry(n,r)}else if("p"===o){const e=i.substr(1).trim().split(" ");t.addPointGeometry(e)}else if(null!==(a=ie.exec(i))){const e=(" "+a[0].substr(1).trim()).substr(1);t.startObject(e)}else if(se.test(i))t.object.startMaterial(i.substring(7).trim(),t.materialLibraries);else if(oe.test(i))t.materialLibraries.push(i.substring(7).trim());else if(ae.test(i))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===o){if(a=i.split(" "),a.length>1){const e=a[1].trim().toLowerCase();t.object.smooth="0"!==e&&"off"!==e}else t.object.smooth=!0;const e=t.object.currentMaterial();e&&(e.smooth=t.object.smooth)}else{if("\0"===i)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+i+'"')}t.finalize();const c=new r.G;c.materialLibraries=[].concat(t.materialLibraries);if(!0===!(1===t.objects.length&&0===t.objects[0].geometry.vertices.length))for(let e=0,n=t.objects.length;e<n;e++){const n=t.objects[e],i=n.geometry,o=n.materials,s="Line"===i.type,a="Points"===i.type;let l=!1;if(0===i.vertices.length)continue;const u=new r.X;u.setAttribute("position",new r.ao(i.vertices,3)),i.normals.length>0&&u.setAttribute("normal",new r.ao(i.normals,3)),i.colors.length>0&&(l=!0,u.setAttribute("color",new r.ao(i.colors,3))),!0===i.hasUVIndices&&u.setAttribute("uv",new r.ao(i.uvs,2));const h=[];for(let e=0,n=o.length;e<n;e++){const n=o[e],i=n.name+"_"+n.smooth+"_"+l;let c=t.materials[i];if(null!==this.materials)if(c=this.materials.create(n.name),!s||!c||c instanceof r.z){if(a&&c&&!(c instanceof r.x)){const e=new r.x({size:10,sizeAttenuation:!1});r.y.prototype.copy.call(e,c),e.color.copy(c.color),e.map=c.map,c=e}}else{const e=new r.z;r.y.prototype.copy.call(e,c),e.color.copy(c.color),c=e}void 0===c&&(c=s?new r.z:a?new r.x({size:1,sizeAttenuation:!1}):new r.am,c.name=n.name,c.flatShading=!n.smooth,c.vertexColors=l,t.materials[i]=c),h.push(c)}let d;if(h.length>1){for(let e=0,t=o.length;e<t;e++){const t=o[e];u.addGroup(t.groupStart,t.groupCount,e)}d=s?new r.Z(u,h):a?new r.a0(u,h):new r.j(u,h)}else d=s?new r.Z(u,h[0]):a?new r.a0(u,h[0]):new r.j(u,h[0]);d.name=n.name,c.add(d)}else if(t.vertices.length>0){const e=new r.x({size:1,sizeAttenuation:!1}),n=new r.X;n.setAttribute("position",new r.ao(t.vertices,3)),t.colors.length>0&&void 0!==t.colors[0]&&(n.setAttribute("color",new r.ao(t.colors,3)),e.vertexColors=!0);const i=new r.a0(n,e);c.add(i)}return c}}class me extends r.L{constructor(e){super(e)}load(e,t,n,i){const o=this,s=""===this.path?r.k.extractUrlBase(e):this.path,a=new r.l(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){try{t(o.parse(n,s))}catch(t){i?i(t):console.error(t),o.manager.itemError(e)}}),n,i)}setMaterialOptions(e){return this.materialOptions=e,this}parse(e,t){const n=e.split("\n");let r={};const i=/\s+/,o={};for(let e=0;e<n.length;e++){let t=n[e];if(t=t.trim(),0===t.length||"#"===t.charAt(0))continue;const s=t.indexOf(" ");let a=s>=0?t.substring(0,s):t;a=a.toLowerCase();let l=s>=0?t.substring(s+1):"";if(l=l.trim(),"newmtl"===a)r={name:l},o[l]=r;else if("ka"===a||"kd"===a||"ks"===a||"ke"===a){const e=l.split(i,3);r[a]=[parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2])]}else r[a]=l}const s=new ve(this.resourcePath||t,this.materialOptions);return s.setCrossOrigin(this.crossOrigin),s.setManager(this.manager),s.setMaterials(o),s}}class ve{constructor(e="",t={}){this.baseUrl=e,this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=void 0!==this.options.side?this.options.side:r.af,this.wrap=void 0!==this.options.wrap?this.options.wrap:r.w}setCrossOrigin(e){return this.crossOrigin=e,this}setManager(e){this.manager=e}setMaterials(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(e){if(!this.options)return e;const t={};for(const n in e){const r=e[n],i={};t[n]=i;for(const e in r){let t=!0,n=r[e];const o=e.toLowerCase();switch(o){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(n=[n[0]/255,n[1]/255,n[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===n[0]&&0===n[1]&&0===n[2]&&(t=!1)}t&&(i[o]=n)}}return t}preload(){for(const e in this.materialsInfo)this.create(e)}getIndex(e){return this.nameLookup[e]}getAsArray(){let e=0;for(const t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray}create(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]}createMaterial_(e){const t=this,n=this.materialsInfo[e],i={name:e,side:this.side};function o(e,n){if(i[e])return;const r=t.getTextureParams(n,i),o=t.loadTexture((s=t.baseUrl,"string"!=typeof(a=r.url)||""===a?"":/^https?:\/\//i.test(a)?a:s+a));var s,a;o.repeat.copy(r.scale),o.offset.copy(r.offset),o.wrapS=t.wrap,o.wrapT=t.wrap,i[e]=o}for(const e in n){const t=n[e];let s;if(""!==t)switch(e.toLowerCase()){case"kd":i.color=(new r.C).fromArray(t);break;case"ks":i.specular=(new r.C).fromArray(t);break;case"ke":i.emissive=(new r.C).fromArray(t);break;case"map_kd":o("map",t);break;case"map_ks":o("specularMap",t);break;case"map_ke":o("emissiveMap",t);break;case"norm":o("normalMap",t);break;case"map_bump":case"bump":o("bumpMap",t);break;case"map_d":o("alphaMap",t),i.transparent=!0;break;case"ns":i.shininess=parseFloat(t);break;case"d":s=parseFloat(t),s<1&&(i.opacity=s,i.transparent=!0);break;case"tr":s=parseFloat(t),this.options&&this.options.invertTrProperty&&(s=1-s),s>0&&(i.opacity=1-s,i.transparent=!0)}}return this.materials[e]=new r.am(i),this.materials[e]}getTextureParams(e,t){const n={scale:new r.V(1,1),offset:new r.V(0,0)},i=e.split(/\s+/);let o;return o=i.indexOf("-bm"),o>=0&&(t.bumpScale=parseFloat(i[o+1]),i.splice(o,2)),o=i.indexOf("-s"),o>=0&&(n.scale.set(parseFloat(i[o+1]),parseFloat(i[o+2])),i.splice(o,4)),o=i.indexOf("-o"),o>=0&&(n.offset.set(parseFloat(i[o+1]),parseFloat(i[o+2])),i.splice(o,4)),n.url=i.join(" ").trim(),n}loadTexture(e,t,n,i,o){const s=void 0!==this.manager?this.manager:r.an;let a=s.getHandler(e);null===a&&(a=new r.T(s)),a.setCrossOrigin&&a.setCrossOrigin(this.crossOrigin);const l=a.load(e,n,i,o);return void 0!==t&&(l.mapping=t),l}}const ge=(e,t)=>{const n={};for(const r of e.mappings)for(const e of r.variants)n[t[e]]={material:null,gltfMaterialIndex:r.material};return n},ye=e=>void 0!==e.material&&e.userData&&e.userData.variantMaterials;class be{constructor(e){this.parser=e,this.name="KHR_materials_variants"}afterRoot(e){const t=this.parser,n=t.json;if(!n.extensions||!n.extensions[this.name])return null;const r=(e=>{const t=[],n={};for(const r of e){let e=r,i=0;for(;void 0!==n[e];)e=r+"."+ ++i;n[e]=!0,t.push(e)}return t})((n.extensions[this.name].variants||[]).map((e=>e.name)));for(const i of e.scenes)i.traverse((e=>{const i=t.associations.get(e);if(!i||"nodes"!==i.type)return;const o=n.nodes[i.index].mesh;if(void 0===o)return;const s=n.meshes[o].primitives,a=e.isMesh?[e]:e.children;for(let e=0;e<s.length;e++){const t=s[e].extensions;t&&t[this.name]&&(a[e].userData.variantMaterials=ge(t[this.name],r))}}));e.userData.variants=r,e.functions=e.functions||{};const i=async(e,n)=>{if(e.userData.originalMaterial||(e.userData.originalMaterial=e.material),null===n||!e.userData.variantMaterials[n])return void(e.material=e.userData.originalMaterial);if(e.userData.variantMaterials[n].material)return void(e.material=e.userData.variantMaterials[n].material);const r=e.userData.variantMaterials[n].gltfMaterialIndex;e.material=await t.getDependency("material",r),t.assignFinalMaterial(e),e.userData.variantMaterials[n].material=e.material},o=e=>{const n=e.material,r=e.userData.variantMaterials,i=[];for(const n in r){const o=r[n];if(o.material)continue;const s=o.gltfMaterialIndex;i.push(t.getDependency("material",s).then((i=>{e.material=i,t.assignFinalMaterial(e),r[n].material=e.material})))}return Promise.all(i).then((()=>{e.material=n}))};e.functions.selectVariant=(e,t,n=!0)=>{const r=[];return n?e.traverse((e=>ye(e)&&r.push(i(e,t)))):ye(e)&&r.push(i(e,t)),Promise.all(r)},e.functions.ensureLoadVariants=(e,t=!0)=>{const n=[];return t?e.traverse((e=>ye(e)&&n.push(o(e)))):ye(e)&&n.push(o(e)),Promise.all(n)}}}var _e,we,Ee,xe,Te,Ae;(we=_e||(_e={})).LOG="LOG",we.ERROR="ERROR",(xe=Ee||(Ee={}))[xe.UnitDeath=0]="UnitDeath",xe[xe.UnitCreated=1]="UnitCreated",xe[xe.UnitHealthChange=2]="UnitHealthChange",xe[xe.UnitPositonChange=3]="UnitPositonChange",xe[xe.UnitReset=4]="UnitReset",(Ae=Te||(Te={}))[Ae.UnitReset=0]="UnitReset",Ae[Ae["ModuleLoader::InstalledModulesLoaded"]=1]="ModuleLoader::InstalledModulesLoaded",Ae[Ae["ModuleLoader::LoadingModulesError"]=2]="ModuleLoader::LoadingModulesError",Ae[Ae["ModuleLoader::InstalledModule"]=3]="ModuleLoader::InstalledModule",Ae[Ae["ModuleLoader::InstallModuleError"]=4]="ModuleLoader::InstallModuleError",Ae[Ae["ModuleLoader::UninstalledModule"]=5]="ModuleLoader::UninstalledModule",Ae[Ae["ModuleLoader::UninstallModuleError"]=6]="ModuleLoader::UninstallModuleError",Ae[Ae["ClickEvent::ObjectSelected"]=7]="ClickEvent::ObjectSelected",Ae[Ae["ClickEvent::MoveUnit"]=8]="ClickEvent::MoveUnit",Ae[Ae["Selection::Reset"]=9]="Selection::Reset";const Se=class{constructor(){if(this._event=new o,this._modules=new Map,null!=Se.INSTANCE)return Se.INSTANCE;l.config({name:"polytopia",description:"Polytopia Module Storage",storeName:"modules"});localStorage.getItem("installed")?this.LoadInstalledModules():(localStorage.setItem("installed","0.5.123"),this.Reinstall().then((()=>{this._event.emit({type:"LOG",id:Te["ModuleLoader::InstalledModulesLoaded"]})})).catch((e=>{this._event.emit({type:_e.ERROR,id:Te["ModuleLoader::LoadingModulesError"],data:{error:e.message}})}))),Se.INSTANCE=this}get Modules(){return this._modules}GetVariant(e,t="polyscript_std"){const n=this._modules.get(t)?.assets;if(!n)throw new Error(`Failed to fetch assest ${e} from module ${t}`);return n.get(e)}GetAsset(e,t="polyscript_std",n=0,r="gltf"){const i=this._modules.get(t)?.assets;if(!i)throw new Error(`Failed to fetch assest ${e} from module ${t}`);if("obj"===r)return i.get(e).children[n];if("gltf"===r&&n.hasOwnProperty("child")){const t=i.get(e),r=t.scene.children[n.child].clone(!0);return t.functions.selectVariant(r,n.variant),r}return i.get(e)?.scene.children[n]}async Reinstall(){l.clear(),await this.InstallModule("module.zip")}async LoadInstalledModules(){try{const e=await l.keys();let t=this;for await(const n of async function*(){let n=0;for(;n<e.length;)yield await t.LoadModule(e[n]),n++;return null}());this._event.emit({type:"LOG",id:Te["ModuleLoader::InstalledModulesLoaded"]})}catch(e){this._event.emit({type:_e.ERROR,id:Te["ModuleLoader::LoadingModulesError"],data:{error:e.message}})}}async InstallModule(e){try{const t=new c.Z,n=await(await fetch(e)).blob(),r=await t.loadAsync(n),i=JSON.parse(await(r.file("manifest.json")?.async("string")));if((await l.keys()).includes(i.name))throw new Error(`Already Installed module '${i.name}'`);let o;const s={manifest:i,scripts:new Map,assets:new Map,icon:o};for await(const e of async function*(e,t="text/javascript"){let n=0;for(;n<e.length;){const i=r.files[e[n]]??r.files[e[n].file],o=new Blob([await i.async("uint8array")],{type:t});yield{path:e[n].file??e[n],data:{name:i.name,date:i.date,blob:o}},n++}return null}(i.assets,""))s.assets.set(e.path,e.data);await l.setItem(i.name,s),this.LoadModule(i.name)}catch(e){this._event.emit({type:_e.ERROR,id:Te["ModuleLoader::InstallModuleError"],data:{error:e.message}})}}async LoadModule(e){if(this._modules.has(e))throw new Error(`Already loaded module '${e}'`);const t=await l.getItem(e);if(null===t)throw new Error(`Failed to load module '${e}'`);const n={manifest:t.manifest,scripts:new Map,assets:new Map};for await(const e of this.LoadAsset(t.assets,n.manifest.assets))n.assets.set(e.name,e.data);this._modules.set(n.manifest.name,n)}async UninstallModule(e){try{await l.removeItem(e),this._event.emit({type:"LOG",id:Te["ModuleLoader::UninstalledModule"]})}catch(e){this._event.emit({type:_e.ERROR,id:Te["ModuleLoader::UninstallModuleError"],data:{error:e.message}})}}async*LoadAsset(e,t){let n=0;const r=new u;for(r.register((e=>new be(e)));n<t.length;){const i=(()=>{let e=t[n].file.split(".");return e[e.length-1]})(),o=e.get(t[n].file);if(o)switch(i){case"glb":case"gltf":yield await new Promise((async(e,i)=>{r.parse(await o.blob.arrayBuffer(),"",(r=>{r||i("Failed Pareing asset"),e({name:t[n].name,data:r})}))}));break;case"obj":yield await new Promise((async(r,i)=>{try{const i=t[n].resource;if(!i)throw new Error(`Missing materials for: ${t[n].name}`);const s=await(e.get(i)?.blob.text());if(!s)throw new Error(`Failed to load asset resource ${t[n].resource}`);const a=new fe,l=(new me).parse(s,"");a.setMaterials(l);const c=a.parse(await o.blob.text());r({name:t[n].name,data:c})}catch(e){i(e)}}))}n++}return null}};let Oe=Se;Oe.INSTANCE=null;const Ie=Oe;var Re=n(9910),Me=Re.r.useEffect,Ce=Re.r.useState,Le=Re.r.version,Ne=n(4345);function ke(e,t){return(ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,ke(e,t)}function ze(){}function De(){}De.resetWarningCache=ze;var Ue=(0,a.c)((function(e){e.exports=function(){function e(e,t,n,r,i,o){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==o){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:De,resetWarningCache:ze};return n.PropTypes=n,n}()}));function Fe(){return(Fe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function je(e){return"/"===e.charAt(0)}function He(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}function Be(e,t){if(!e)throw new Error("Invariant failed")}function Ve(e){return"/"===e.charAt(0)?e:"/"+e}function Ge(e){return"/"===e.charAt(0)?e.substr(1):e}function Xe(e,t){return function(e,t){return 0===e.toLowerCase().indexOf(t.toLowerCase())&&-1!=="/?#".indexOf(e.charAt(t.length))}(e,t)?e.substr(t.length):e}function We(e){return"/"===e.charAt(e.length-1)?e.slice(0,-1):e}function $e(e){var t=e.pathname,n=e.search,r=e.hash,i=t||"/";return n&&"?"!==n&&(i+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(i+="#"===r.charAt(0)?r:"#"+r),i}function qe(e,t,n,r){var i;"string"==typeof e?(i=function(e){var t=e||"/",n="",r="",i=t.indexOf("#");-1!==i&&(r=t.substr(i),t=t.substr(0,i));var o=t.indexOf("?");return-1!==o&&(n=t.substr(o),t=t.substr(0,o)),{pathname:t,search:"?"===n?"":n,hash:"#"===r?"":r}}(e)).state=t:(void 0===(i=Fe({},e)).pathname&&(i.pathname=""),i.search?"?"!==i.search.charAt(0)&&(i.search="?"+i.search):i.search="",i.hash?"#"!==i.hash.charAt(0)&&(i.hash="#"+i.hash):i.hash="",void 0!==t&&void 0===i.state&&(i.state=t));try{i.pathname=decodeURI(i.pathname)}catch(e){throw e instanceof URIError?new URIError('Pathname "'+i.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):e}return n&&(i.key=n),r?i.pathname?"/"!==i.pathname.charAt(0)&&(i.pathname=function(e,t){void 0===t&&(t="");var n,r=e&&e.split("/")||[],i=t&&t.split("/")||[],o=e&&je(e),s=t&&je(t),a=o||s;if(e&&je(e)?i=r:r.length&&(i.pop(),i=i.concat(r)),!i.length)return"/";if(i.length){var l=i[i.length-1];n="."===l||".."===l||""===l}else n=!1;for(var c=0,u=i.length;u>=0;u--){var h=i[u];"."===h?He(i,u):".."===h?(He(i,u),c++):c&&(He(i,u),c--)}if(!a)for(;c--;c)i.unshift("..");!a||""===i[0]||i[0]&&je(i[0])||i.unshift("");var d=i.join("/");return n&&"/"!==d.substr(-1)&&(d+="/"),d}(i.pathname,r.pathname)):i.pathname=r.pathname:i.pathname||(i.pathname="/"),i}function Ke(){var e=null;var t=[];return{setPrompt:function(t){return e=t,function(){e===t&&(e=null)}},confirmTransitionTo:function(t,n,r,i){if(null!=e){var o="function"==typeof e?e(t,n):e;"string"==typeof o?"function"==typeof r?r(o,i):i(!0):i(!1!==o)}else i(!0)},appendListener:function(e){var n=!0;function r(){n&&e.apply(void 0,arguments)}return t.push(r),function(){n=!1,t=t.filter((function(e){return e!==r}))}},notifyListeners:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.forEach((function(e){return e.apply(void 0,n)}))}}}var Ye=!("undefined"==typeof window||!window.document||!window.document.createElement);function Ze(e,t){t(window.confirm(e))}var Qe="popstate",Je="hashchange";function et(){try{return window.history.state||{}}catch(e){return{}}}function tt(e){void 0===e&&(e={}),Ye||Be(!1);var t,n=window.history,r=(-1===(t=window.navigator.userAgent).indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexOf("Chrome")||-1!==t.indexOf("Windows Phone"))&&window.history&&"pushState"in window.history,i=!(-1===window.navigator.userAgent.indexOf("Trident")),o=e,s=o.forceRefresh,a=void 0!==s&&s,l=o.getUserConfirmation,c=void 0===l?Ze:l,u=o.keyLength,h=void 0===u?6:u,d=e.basename?We(Ve(e.basename)):"";function p(e){var t=e||{},n=t.key,r=t.state,i=window.location,o=i.pathname+i.search+i.hash;return d&&(o=Xe(o,d)),qe(o,r,n)}function f(){return Math.random().toString(36).substr(2,h)}var m=Ke();function v(e){Fe(I,e),I.length=n.length,m.notifyListeners(I.location,I.action)}function g(e){(function(e){return void 0===e.state&&-1===navigator.userAgent.indexOf("CriOS")})(e)||_(p(e.state))}function y(){_(p(et()))}var b=!1;function _(e){if(b)b=!1,v();else{m.confirmTransitionTo(e,"POP",c,(function(t){t?v({action:"POP",location:e}):function(e){var t=I.location,n=E.indexOf(t.key);-1===n&&(n=0);var r=E.indexOf(e.key);-1===r&&(r=0);var i=n-r;i&&(b=!0,T(i))}(e)}))}}var w=p(et()),E=[w.key];function x(e){return d+$e(e)}function T(e){n.go(e)}var A=0;function S(e){1===(A+=e)&&1===e?(window.addEventListener(Qe,g),i&&window.addEventListener(Je,y)):0===A&&(window.removeEventListener(Qe,g),i&&window.removeEventListener(Je,y))}var O=!1;var I={length:n.length,action:"POP",location:w,createHref:x,push:function(e,t){var i="PUSH",o=qe(e,t,f(),I.location);m.confirmTransitionTo(o,i,c,(function(e){if(e){var t=x(o),s=o.key,l=o.state;if(r)if(n.pushState({key:s,state:l},null,t),a)window.location.href=t;else{var c=E.indexOf(I.location.key),u=E.slice(0,c+1);u.push(o.key),E=u,v({action:i,location:o})}else window.location.href=t}}))},replace:function(e,t){var i="REPLACE",o=qe(e,t,f(),I.location);m.confirmTransitionTo(o,i,c,(function(e){if(e){var t=x(o),s=o.key,l=o.state;if(r)if(n.replaceState({key:s,state:l},null,t),a)window.location.replace(t);else{var c=E.indexOf(I.location.key);-1!==c&&(E[c]=o.key),v({action:i,location:o})}else window.location.replace(t)}}))},go:T,goBack:function(){T(-1)},goForward:function(){T(1)},block:function(e){void 0===e&&(e=!1);var t=m.setPrompt(e);return O||(S(1),O=!0),function(){return O&&(O=!1,S(-1)),t()}},listen:function(e){var t=m.appendListener(e);return S(1),function(){S(-1),t()}}};return I}var nt="hashchange",rt={hashbang:{encodePath:function(e){return"!"===e.charAt(0)?e:"!/"+Ge(e)},decodePath:function(e){return"!"===e.charAt(0)?e.substr(1):e}},noslash:{encodePath:Ge,decodePath:Ve},slash:{encodePath:Ve,decodePath:Ve}};function it(e){var t=e.indexOf("#");return-1===t?e:e.slice(0,t)}function ot(){var e=window.location.href,t=e.indexOf("#");return-1===t?"":e.substring(t+1)}function st(e){window.location.replace(it(window.location.href)+"#"+e)}function at(e){void 0===e&&(e={}),Ye||Be(!1);var t=window.history,n=(window.navigator.userAgent.indexOf("Firefox"),e),r=n.getUserConfirmation,i=void 0===r?Ze:r,o=n.hashType,s=void 0===o?"slash":o,a=e.basename?We(Ve(e.basename)):"",l=rt[s],c=l.encodePath,u=l.decodePath;function h(){var e=u(ot());return a&&(e=Xe(e,a)),qe(e)}var d=Ke();function p(e){Fe(A,e),A.length=t.length,d.notifyListeners(A.location,A.action)}var f=!1,m=null;function v(){var e,t,n=ot(),r=c(n);if(n!==r)st(r);else{var o=h(),s=A.location;if(!f&&(t=o,(e=s).pathname===t.pathname&&e.search===t.search&&e.hash===t.hash))return;if(m===$e(o))return;m=null,function(e){if(f)f=!1,p();else{var t="POP";d.confirmTransitionTo(e,t,i,(function(n){n?p({action:t,location:e}):function(e){var t=A.location,n=_.lastIndexOf($e(t));-1===n&&(n=0);var r=_.lastIndexOf($e(e));-1===r&&(r=0);var i=n-r;i&&(f=!0,w(i))}(e)}))}}(o)}}var g=ot(),y=c(g);g!==y&&st(y);var b=h(),_=[$e(b)];function w(e){t.go(e)}var E=0;function x(e){1===(E+=e)&&1===e?window.addEventListener(nt,v):0===E&&window.removeEventListener(nt,v)}var T=!1;var A={length:t.length,action:"POP",location:b,createHref:function(e){var t=document.querySelector("base"),n="";return t&&t.getAttribute("href")&&(n=it(window.location.href)),n+"#"+c(a+$e(e))},push:function(e,t){var n="PUSH",r=qe(e,void 0,void 0,A.location);d.confirmTransitionTo(r,n,i,(function(e){if(e){var t=$e(r),i=c(a+t);if(ot()!==i){m=t,function(e){window.location.hash=e}(i);var o=_.lastIndexOf($e(A.location)),s=_.slice(0,o+1);s.push(t),_=s,p({action:n,location:r})}else p()}}))},replace:function(e,t){var n="REPLACE",r=qe(e,void 0,void 0,A.location);d.confirmTransitionTo(r,n,i,(function(e){if(e){var t=$e(r),i=c(a+t);ot()!==i&&(m=t,st(i));var o=_.indexOf($e(A.location));-1!==o&&(_[o]=t),p({action:n,location:r})}}))},go:w,goBack:function(){w(-1)},goForward:function(){w(1)},block:function(e){void 0===e&&(e=!1);var t=d.setPrompt(e);return T||(x(1),T=!0),function(){return T&&(T=!1,x(-1)),t()}},listen:function(e){var t=d.appendListener(e);return x(1),function(){x(-1),t()}}};return A}function lt(e,t,n){return Math.min(Math.max(e,t),n)}function ct(e){void 0===e&&(e={});var t=e,n=t.getUserConfirmation,r=t.initialEntries,i=void 0===r?["/"]:r,o=t.initialIndex,s=void 0===o?0:o,a=t.keyLength,l=void 0===a?6:a,c=Ke();function u(e){Fe(v,e),v.length=v.entries.length,c.notifyListeners(v.location,v.action)}function h(){return Math.random().toString(36).substr(2,l)}var d=lt(s,0,i.length-1),p=i.map((function(e){return qe(e,void 0,"string"==typeof e?h():e.key||h())})),f=$e;function m(e){var t=lt(v.index+e,0,v.entries.length-1),r=v.entries[t];c.confirmTransitionTo(r,"POP",n,(function(e){e?u({action:"POP",location:r,index:t}):u()}))}var v={length:p.length,action:"POP",location:p[d],index:d,entries:p,createHref:f,push:function(e,t){var r="PUSH",i=qe(e,t,h(),v.location);c.confirmTransitionTo(i,r,n,(function(e){if(e){var t=v.index+1,n=v.entries.slice(0);n.length>t?n.splice(t,n.length-t,i):n.push(i),u({action:r,location:i,index:t,entries:n})}}))},replace:function(e,t){var r="REPLACE",i=qe(e,t,h(),v.location);c.confirmTransitionTo(i,r,n,(function(e){e&&(v.entries[v.index]=i,u({action:r,location:i}))}))},go:m,goBack:function(){m(-1)},goForward:function(){m(1)},canGo:function(e){var t=v.index+e;return t>=0&&t<v.entries.length},block:function(e){return void 0===e&&(e=!1),c.setPrompt(e)},listen:function(e){return c.appendListener(e)}};return v}var ut=1073741823,ht="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:{};function dt(e){var t=[];return{on:function(e){t.push(e)},off:function(e){t=t.filter((function(t){return t!==e}))},get:function(){return e},set:function(n,r){e=n,t.forEach((function(t){return t(e,r)}))}}}var pt=Re.r.createContext||function(e,t){var n,r,i,o="__create-react-context-"+((ht[i="__global_unique_id__"]=(ht[i]||0)+1)+"__"),s=function(e){function n(){var t;return(t=e.apply(this,arguments)||this).emitter=dt(t.props.value),t}Pe(n,e);var r=n.prototype;return r.getChildContext=function(){var e;return(e={})[o]=this.emitter,e},r.componentWillReceiveProps=function(e){if(this.props.value!==e.value){var n,r=this.props.value,i=e.value;((o=r)===(s=i)?0!==o||1/o==1/s:o!=o&&s!=s)?n=0:(n="function"==typeof t?t(r,i):ut,0!==(n|=0)&&this.emitter.set(e.value,n))}var o,s},r.render=function(){return this.props.children},n}(Re.r.Component);s.childContextTypes=((n={})[o]=Ue.object.isRequired,n);var a=function(t){function n(){var e;return(e=t.apply(this,arguments)||this).state={value:e.getValue()},e.onUpdate=function(t,n){0!=((0|e.observedBits)&n)&&e.setState({value:e.getValue()})},e}Pe(n,t);var r=n.prototype;return r.componentWillReceiveProps=function(e){var t=e.observedBits;this.observedBits=null==t?ut:t},r.componentDidMount=function(){this.context[o]&&this.context[o].on(this.onUpdate);var e=this.props.observedBits;this.observedBits=null==e?ut:e},r.componentWillUnmount=function(){this.context[o]&&this.context[o].off(this.onUpdate)},r.getValue=function(){return this.context[o]?this.context[o].get():e},r.render=function(){return(e=this.props.children,Array.isArray(e)?e[0]:e)(this.state.value);var e},n}(Re.r.Component);return a.contextTypes=((r={})[o]=Ue.object,r),{Provider:s,Consumer:a}},ft=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)},mt=Rt,vt=wt,gt=function(e,t){return xt(wt(e,t),t)},yt=xt,bt=It,_t=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function wt(e,t){for(var n,r=[],i=0,o=0,s="",a=t&&t.delimiter||"/";null!=(n=_t.exec(e));){var l=n[0],c=n[1],u=n.index;if(s+=e.slice(o,u),o=u+l.length,c)s+=c[1];else{var h=e[o],d=n[2],p=n[3],f=n[4],m=n[5],v=n[6],g=n[7];s&&(r.push(s),s="");var y=null!=d&&null!=h&&h!==d,b="+"===v||"*"===v,_="?"===v||"*"===v,w=n[2]||a,E=f||m;r.push({name:p||i++,prefix:d||"",delimiter:w,optional:_,repeat:b,partial:y,asterisk:!!g,pattern:E?At(E):g?".*":"[^"+Tt(w)+"]+?"})}}return o<e.length&&(s+=e.substr(o)),s&&r.push(s),r}function Et(e){return encodeURI(e).replace(/[\/?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}function xt(e,t){for(var n=new Array(e.length),r=0;r<e.length;r++)"object"==typeof e[r]&&(n[r]=new RegExp("^(?:"+e[r].pattern+")$",Ot(t)));return function(t,r){for(var i="",o=t||{},s=(r||{}).pretty?Et:encodeURIComponent,a=0;a<e.length;a++){var l=e[a];if("string"!=typeof l){var c,u=o[l.name];if(null==u){if(l.optional){l.partial&&(i+=l.prefix);continue}throw new TypeError('Expected "'+l.name+'" to be defined')}if(ft(u)){if(!l.repeat)throw new TypeError('Expected "'+l.name+'" to not repeat, but received `'+JSON.stringify(u)+"`");if(0===u.length){if(l.optional)continue;throw new TypeError('Expected "'+l.name+'" to not be empty')}for(var h=0;h<u.length;h++){if(c=s(u[h]),!n[a].test(c))throw new TypeError('Expected all "'+l.name+'" to match "'+l.pattern+'", but received `'+JSON.stringify(c)+"`");i+=(0===h?l.prefix:l.delimiter)+c}}else{if(c=l.asterisk?encodeURI(u).replace(/[?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})):s(u),!n[a].test(c))throw new TypeError('Expected "'+l.name+'" to match "'+l.pattern+'", but received "'+c+'"');i+=l.prefix+c}}else i+=l}return i}}function Tt(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function At(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function St(e,t){return e.keys=t,e}function Ot(e){return e&&e.sensitive?"":"i"}function It(e,t,n){ft(t)||(n=t||n,t=[]);for(var r=(n=n||{}).strict,i=!1!==n.end,o="",s=0;s<e.length;s++){var a=e[s];if("string"==typeof a)o+=Tt(a);else{var l=Tt(a.prefix),c="(?:"+a.pattern+")";t.push(a),a.repeat&&(c+="(?:"+l+c+")*"),o+=c=a.optional?a.partial?l+"("+c+")?":"(?:"+l+"("+c+"))?":l+"("+c+")"}}var u=Tt(n.delimiter||"/"),h=o.slice(-u.length)===u;return r||(o=(h?o.slice(0,-u.length):o)+"(?:"+u+"(?=$))?"),o+=i?"$":r&&h?"":"(?="+u+"|$)",St(new RegExp("^"+o,Ot(n)),t)}function Rt(e,t,n){return ft(t)||(n=t||n,t=[]),n=n||{},e instanceof RegExp?function(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)t.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return St(e,t)}(e,t):ft(e)?function(e,t,n){for(var r=[],i=0;i<e.length;i++)r.push(Rt(e[i],t,n).source);return St(new RegExp("(?:"+r.join("|")+")",Ot(n)),t)}(e,t,n):function(e,t,n){return It(wt(e,n),t,n)}(e,t,n)}mt.parse=vt,mt.compile=gt,mt.tokensToFunction=yt,mt.tokensToRegExp=bt;var Mt="function"==typeof Symbol&&Symbol.for,Ct=Mt?Symbol.for("react.element"):60103,Lt=Mt?Symbol.for("react.portal"):60106,Nt=Mt?Symbol.for("react.fragment"):60107,kt=Mt?Symbol.for("react.strict_mode"):60108,Pt=Mt?Symbol.for("react.profiler"):60114,zt=Mt?Symbol.for("react.provider"):60109,Dt=Mt?Symbol.for("react.context"):60110,Ut=Mt?Symbol.for("react.async_mode"):60111,Ft=Mt?Symbol.for("react.concurrent_mode"):60111,jt=Mt?Symbol.for("react.forward_ref"):60112,Ht=Mt?Symbol.for("react.suspense"):60113,Bt=Mt?Symbol.for("react.suspense_list"):60120,Vt=Mt?Symbol.for("react.memo"):60115,Gt=Mt?Symbol.for("react.lazy"):60116,Xt=Mt?Symbol.for("react.block"):60121,Wt=Mt?Symbol.for("react.fundamental"):60117,$t=Mt?Symbol.for("react.responder"):60118,qt=Mt?Symbol.for("react.scope"):60119;function Kt(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case Ct:switch(e=e.type){case Ut:case Ft:case Nt:case Pt:case kt:case Ht:return e;default:switch(e=e&&e.$$typeof){case Dt:case jt:case Gt:case Vt:case zt:return e;default:return t}}case Lt:return t}}}function Yt(e){return Kt(e)===Ft}var Zt={AsyncMode:Ut,ConcurrentMode:Ft,ContextConsumer:Dt,ContextProvider:zt,Element:Ct,ForwardRef:jt,Fragment:Nt,Lazy:Gt,Memo:Vt,Portal:Lt,Profiler:Pt,StrictMode:kt,Suspense:Ht,isAsyncMode:function(e){return Yt(e)||Kt(e)===Ut},isConcurrentMode:Yt,isContextConsumer:function(e){return Kt(e)===Dt},isContextProvider:function(e){return Kt(e)===zt},isElement:function(e){return"object"==typeof e&&null!==e&&e.$$typeof===Ct},isForwardRef:function(e){return Kt(e)===jt},isFragment:function(e){return Kt(e)===Nt},isLazy:function(e){return Kt(e)===Gt},isMemo:function(e){return Kt(e)===Vt},isPortal:function(e){return Kt(e)===Lt},isProfiler:function(e){return Kt(e)===Pt},isStrictMode:function(e){return Kt(e)===kt},isSuspense:function(e){return Kt(e)===Ht},isValidElementType:function(e){return"string"==typeof e||"function"==typeof e||e===Nt||e===Ft||e===Pt||e===kt||e===Ht||e===Bt||"object"==typeof e&&null!==e&&(e.$$typeof===Gt||e.$$typeof===Vt||e.$$typeof===zt||e.$$typeof===Dt||e.$$typeof===jt||e.$$typeof===Wt||e.$$typeof===$t||e.$$typeof===qt||e.$$typeof===Xt)},typeOf:Kt},Qt=(0,a.c)((function(e){e.exports=Zt}));function Jt(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}var en={};en[Qt.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},en[Qt.Memo]={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0};var tn=function(e){var t=pt();return t.displayName=e,t}("Router-History"),nn=function(e){var t=pt();return t.displayName=e,t}("Router"),rn=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={location:t.history.location},n._isMounted=!1,n._pendingLocation=null,t.staticContext||(n.unlisten=t.history.listen((function(e){n._isMounted?n.setState({location:e}):n._pendingLocation=e}))),n}Pe(t,e),t.computeRootMatch=function(e){return{path:"/",url:"/",params:{},isExact:"/"===e}};var n=t.prototype;return n.componentDidMount=function(){this._isMounted=!0,this._pendingLocation&&this.setState({location:this._pendingLocation})},n.componentWillUnmount=function(){this.unlisten&&this.unlisten()},n.render=function(){return Re.r.createElement(nn.Provider,{value:{history:this.props.history,location:this.state.location,match:t.computeRootMatch(this.state.location.pathname),staticContext:this.props.staticContext}},Re.r.createElement(tn.Provider,{children:this.props.children||null,value:this.props.history}))},t}(Re.r.Component),on=(Re.r.Component,Re.r.Component,{}),sn=0;function an(e,t){void 0===t&&(t={}),("string"==typeof t||Array.isArray(t))&&(t={path:t});var n=t,r=n.path,i=n.exact,o=void 0!==i&&i,s=n.strict,a=void 0!==s&&s,l=n.sensitive,c=void 0!==l&&l;return[].concat(r).reduce((function(t,n){if(!n&&""!==n)return null;if(t)return t;var r=function(e,t){var n=""+t.end+t.strict+t.sensitive,r=on[n]||(on[n]={});if(r[e])return r[e];var i=[],o={regexp:mt(e,i,t),keys:i};return sn<1e4&&(r[e]=o,sn++),o}(n,{end:o,strict:a,sensitive:c}),i=r.regexp,s=r.keys,l=i.exec(e);if(!l)return null;var u=l[0],h=l.slice(1),d=e===u;return o&&!d?null:{path:n,url:"/"===n&&""===u?"/":u,isExact:d,params:s.reduce((function(e,t,n){return e[t.name]=h[n],e}),{})}}),null)}var ln=function(e){function t(){return e.apply(this,arguments)||this}return Pe(t,e),t.prototype.render=function(){var e=this;return Re.r.createElement(nn.Consumer,null,(function(t){t||Be(!1);var n=e.props.location||t.location,r=Fe({},t,{location:n,match:e.props.computedMatch?e.props.computedMatch:e.props.path?an(n.pathname,e.props):t.match}),i=e.props,o=i.children,s=i.component,a=i.render;return Array.isArray(o)&&0===o.length&&(o=null),Re.r.createElement(nn.Provider,{value:r},r.match?o?"function"==typeof o?o(r):o:s?Re.r.createElement(s,r):a?a(r):null:"function"==typeof o?o(r):null)}))},t}(Re.r.Component);function cn(e){return"/"===e.charAt(0)?e:"/"+e}function un(e,t){if(!e)return t;var n=cn(e);return 0!==t.pathname.indexOf(n)?t:Fe({},t,{pathname:t.pathname.substr(n.length)})}function hn(e){return"string"==typeof e?e:$e(e)}function dn(e){return function(){Be(!1)}}function pn(){}Re.r.Component;var fn=function(e){function t(){return e.apply(this,arguments)||this}return Pe(t,e),t.prototype.render=function(){var e=this;return Re.r.createElement(nn.Consumer,null,(function(t){t||Be(!1);var n,r,i=e.props.location||t.location;return Re.r.Children.forEach(e.props.children,(function(e){if(null==r&&Re.r.isValidElement(e)){n=e;var o=e.props.path||e.props.from;r=o?an(i.pathname,Fe({},e.props,{path:o})):t.match}})),r?Re.r.cloneElement(n,{location:i,computedMatch:r}):null}))},t}(Re.r.Component),mn=Re.r.useContext;function vn(){return mn(tn)}var gn=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this).history=tt(t.props),t}return Pe(t,e),t.prototype.render=function(){return Re.r.createElement(rn,{history:this.history,children:this.props.children})},t}(Re.r.Component),yn=(Re.r.Component,function(e,t){return"function"==typeof e?e(t):e}),bn=function(e,t){return"string"==typeof e?qe(e,null,null,t):e},_n=function(e){return e},wn=Re.r.forwardRef;void 0===wn&&(wn=_n);var En=wn((function(e,t){var n=e.innerRef,r=e.navigate,i=e.onClick,o=Jt(e,["innerRef","navigate","onClick"]),s=o.target,a=Fe({},o,{onClick:function(e){try{i&&i(e)}catch(t){throw e.preventDefault(),t}e.defaultPrevented||0!==e.button||s&&"_self"!==s||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)||(e.preventDefault(),r())}});return a.ref=_n!==wn&&t||n,Re.r.createElement("a",a)})),xn=wn((function(e,t){var n=e.component,r=void 0===n?En:n,i=e.replace,o=e.to,s=e.innerRef,a=Jt(e,["component","replace","to","innerRef"]);return Re.r.createElement(nn.Consumer,null,(function(e){e||Be(!1);var n=e.history,l=bn(yn(o,e.location),e.location),c=l?n.createHref(l):"",u=Fe({},a,{href:c,navigate:function(){var t=yn(o,e.location);(i?n.replace:n.push)(t)}});return _n!==wn?u.ref=t||s:u.innerRef=s,Re.r.createElement(r,u)}))})),Tn=function(e){return e},An=Re.r.forwardRef;void 0===An&&(An=Tn);An((function(e,t){var n=e["aria-current"],r=void 0===n?"page":n,i=e.activeClassName,o=void 0===i?"active":i,s=e.activeStyle,a=e.className,l=e.exact,c=e.isActive,u=e.location,h=e.sensitive,d=e.strict,p=e.style,f=e.to,m=e.innerRef,v=Jt(e,["aria-current","activeClassName","activeStyle","className","exact","isActive","location","sensitive","strict","style","to","innerRef"]);return Re.r.createElement(nn.Consumer,null,(function(e){e||Be(!1);var n=u||e.location,i=bn(yn(f,n),n),g=i.pathname,y=g&&g.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),b=y?an(n.pathname,{path:y,exact:l,sensitive:h,strict:d}):null,_=!!(c?c(b,n):b),w=_?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return e})).join(" ")}(a,o):a,E=_?Fe({},p,{},s):p,x=Fe({"aria-current":_&&r||null,className:w,style:E,to:i},v);return Tn!==An?x.ref=t||m:x.innerRef=m,Re.r.createElement(xn,x)}))}));class Sn{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}const On=new r.O(-1,1,1,-1,0,1),In=new r.X;In.setAttribute("position",new r.ao([-1,3,0,-1,-1,0,3,-1,0],3)),In.setAttribute("uv",new r.ao([0,2,0,0,2,0],2));class Rn{constructor(e){this._mesh=new r.j(In,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,On)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}var Mn={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\t\t}"};class Cn extends Sn{constructor(e,t){super(),this.textureID=void 0!==t?t:"tDiffuse",e instanceof r.ap?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=r.aq.clone(e.uniforms),this.material=new r.ap({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new Rn(this.material)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}}class Ln extends Sn{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,n){const r=e.getContext(),i=e.state;let o,s;i.buffers.color.setMask(!1),i.buffers.depth.setMask(!1),i.buffers.color.setLocked(!0),i.buffers.depth.setLocked(!0),this.inverse?(o=0,s=1):(o=1,s=0),i.buffers.stencil.setTest(!0),i.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),i.buffers.stencil.setFunc(r.ALWAYS,o,4294967295),i.buffers.stencil.setClear(s),i.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),i.buffers.color.setLocked(!1),i.buffers.depth.setLocked(!1),i.buffers.stencil.setLocked(!1),i.buffers.stencil.setFunc(r.EQUAL,1,4294967295),i.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),i.buffers.stencil.setLocked(!0)}}class Nn extends Sn{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class kn{constructor(e,t){if(this.renderer=e,void 0===t){const n={minFilter:r.u,magFilter:r.u,format:r.at},i=e.getSize(new r.V);this._pixelRatio=e.getPixelRatio(),this._width=i.width,this._height=i.height,(t=new r.ar(this._width*this._pixelRatio,this._height*this._pixelRatio,n)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===Mn&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===Cn&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new Cn(Mn),this.clock=new r.as}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let n=!1;for(let t=0,r=this.passes.length;t<r;t++){const r=this.passes[t];if(!1!==r.enabled){if(r.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(t),r.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),r.needsSwap){if(n){const t=this.renderer.getContext(),n=this.renderer.state.buffers.stencil;n.setFunc(t.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),n.setFunc(t.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==Ln&&(r instanceof Ln?n=!0:r instanceof Nn&&(n=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){const t=this.renderer.getSize(new r.V);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(let e=0;e<this.passes.length;e++)this.passes[e].setSize(n,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}new r.O(-1,1,1,-1,0,1);const Pn=new r.X;Pn.setAttribute("position",new r.ao([-1,3,0,-1,-1,0,3,-1,0],3)),Pn.setAttribute("uv",new r.ao([0,2,0,0,2,0],2));class zn extends Sn{constructor(e,t,n,i,o){super(),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=i,this.clearAlpha=void 0!==o?o:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new r.C}render(e,t,n){const r=e.autoClear;let i,o;e.autoClear=!1,void 0!==this.overrideMaterial&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),i=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,i),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=o),e.autoClear=r}}var Dn,Un,Fn=function(e,t){return(Fn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function jn(e){return e.isPerspectiveCamera}function Hn(e){return e.isOrthographicCamera}(Un=Dn||(Dn={}))[Un.NONE=0]="NONE",Un[Un.ROTATE=1]="ROTATE",Un[Un.TRUCK=2]="TRUCK",Un[Un.OFFSET=3]="OFFSET",Un[Un.DOLLY=4]="DOLLY",Un[Un.ZOOM=5]="ZOOM",Un[Un.TOUCH_ROTATE=6]="TOUCH_ROTATE",Un[Un.TOUCH_TRUCK=7]="TOUCH_TRUCK",Un[Un.TOUCH_OFFSET=8]="TOUCH_OFFSET",Un[Un.TOUCH_DOLLY=9]="TOUCH_DOLLY",Un[Un.TOUCH_ZOOM=10]="TOUCH_ZOOM",Un[Un.TOUCH_DOLLY_TRUCK=11]="TOUCH_DOLLY_TRUCK",Un[Un.TOUCH_DOLLY_OFFSET=12]="TOUCH_DOLLY_OFFSET",Un[Un.TOUCH_ZOOM_TRUCK=13]="TOUCH_ZOOM_TRUCK",Un[Un.TOUCH_ZOOM_OFFSET=14]="TOUCH_ZOOM_OFFSET";var Bn=2*Math.PI,Vn=Math.PI/2;function Gn(e){return Math.abs(e)<1e-5}function Xn(e,t){return Math.round(e/t)*t}function Wn(e){return isFinite(e)?e:e<0?-Number.MAX_VALUE:Number.MAX_VALUE}function $n(e){return Math.abs(e)<Number.MAX_VALUE?e:e*(1/0)}function qn(e){return"TouchEvent"in window&&e instanceof TouchEvent}function Kn(e,t){if(t.set(0,0),qn(e)){for(var n=e,r=0;r<n.touches.length;r++)t.x+=n.touches[r].clientX,t.y+=n.touches[r].clientY;return t.x/=n.touches.length,t.y/=n.touches.length,t}var i=e;return t.set(i.clientX,i.clientY),t}function Yn(e,t){return!!Hn(e)&&(console.warn(t+" is not supported in OrthographicCamera"),!0)}function Zn(e){return e.invert?e.invert():e.inverse(),e}var Qn,Jn,er,tr,nr,rr,ir,or,sr,ar,lr,cr,ur,hr,dr,pr,fr,mr,vr,gr,yr=function(){function e(){this._listeners={}}return e.prototype.addEventListener=function(e,t){var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},e.prototype.removeEventListener=function(e,t){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}},e.prototype.removeAllEventListeners=function(e){e?Array.isArray(this._listeners[e])&&(this._listeners[e].length=0):this._listeners={}},e.prototype.dispatchEvent=function(e){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e)}},e}(),br="undefined"!=typeof window&&/Mac/.test(navigator.platform),_r=Object.freeze(Dn),wr=1/8;const Er=function(e){function t(t,n){var r=e.call(this)||this;if(r.minPolarAngle=0,r.maxPolarAngle=Math.PI,r.minAzimuthAngle=-1/0,r.maxAzimuthAngle=1/0,r.minDistance=0,r.maxDistance=1/0,r.infinityDolly=!1,r.minZoom=.01,r.maxZoom=1/0,r.dampingFactor=.05,r.draggingDampingFactor=.25,r.azimuthRotateSpeed=1,r.polarRotateSpeed=1,r.dollySpeed=1,r.truckSpeed=2,r.dollyToCursor=!1,r.dragToOffset=!1,r.verticalDragToForward=!1,r.boundaryFriction=0,r.colliderMeshes=[],r.cancel=function(){},r._enabled=!0,r._state=Dn.NONE,r._viewport=null,r._dollyControlAmount=0,r._boundaryEnclosesCamera=!1,r._needsUpdate=!0,r._updatedLastTime=!1,void 0===Qn&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),r._camera=t,r._yAxisUpSpace=(new Qn.Quaternion).setFromUnitVectors(r._camera.up,er),r._yAxisUpSpaceInverse=Zn(r._yAxisUpSpace.clone()),r._state=Dn.NONE,r._domElement=n,r._target=new Qn.Vector3,r._targetEnd=r._target.clone(),r._focalOffset=new Qn.Vector3,r._focalOffsetEnd=r._focalOffset.clone(),r._spherical=(new Qn.Spherical).setFromVector3(rr.copy(r._camera.position).applyQuaternion(r._yAxisUpSpace)),r._sphericalEnd=r._spherical.clone(),r._zoom=r._camera.zoom,r._zoomEnd=r._zoom,r._nearPlaneCorners=[new Qn.Vector3,new Qn.Vector3,new Qn.Vector3,new Qn.Vector3],r._updateNearPlaneCorners(),r._boundary=new Qn.Box3(new Qn.Vector3(-1/0,-1/0,-1/0),new Qn.Vector3(1/0,1/0,1/0)),r._target0=r._target.clone(),r._position0=r._camera.position.clone(),r._zoom0=r._zoom,r._focalOffset0=r._focalOffset.clone(),r._dollyControlAmount=0,r._dollyControlCoord=new Qn.Vector2,r.mouseButtons={left:Dn.ROTATE,middle:Dn.DOLLY,right:Dn.TRUCK,wheel:jn(r._camera)?Dn.DOLLY:Hn(r._camera)?Dn.ZOOM:Dn.NONE},r.touches={one:Dn.TOUCH_ROTATE,two:jn(r._camera)?Dn.TOUCH_DOLLY_TRUCK:Hn(r._camera)?Dn.TOUCH_ZOOM_TRUCK:Dn.NONE,three:Dn.TOUCH_TRUCK},r._domElement){var i=new Qn.Vector2,o=new Qn.Vector2,s=new Qn.Vector2,a=new Qn.Vector4,l=function(e,t,n){if(jn(r._camera)){var i=r._camera,o=rr.copy(i.position).sub(r._target),s=i.getEffectiveFOV()*Qn.MathUtils.DEG2RAD,l=o.length()*Math.tan(.5*s),c=r.truckSpeed*e*l/a.w,u=r.truckSpeed*t*l/a.w;r.verticalDragToForward?(n?r.setFocalOffset(r._focalOffsetEnd.x+c,r._focalOffsetEnd.y,r._focalOffsetEnd.z,!0):r.truck(c,0,!0),r.forward(-u,!0)):n?r.setFocalOffset(r._focalOffsetEnd.x+c,r._focalOffsetEnd.y+u,r._focalOffsetEnd.z,!0):r.truck(c,u,!0)}else if(Hn(r._camera)){var h=r._camera;c=e*(h.right-h.left)/h.zoom/a.z,u=t*(h.top-h.bottom)/h.zoom/a.w;n?r.setFocalOffset(r._focalOffsetEnd.x+c,r._focalOffsetEnd.y+u,r._focalOffsetEnd.z,!0):r.truck(c,u,!0)}},c=function(e,t){var n=Bn*r.azimuthRotateSpeed*e/a.w,i=Bn*r.polarRotateSpeed*t/a.w;r.rotate(n,i,!0)},u=function(e,t,n){var i=Math.pow(.95,-e*r.dollySpeed),o=r._sphericalEnd.radius*i,s=r._sphericalEnd.radius;r.dollyTo(o),r.infinityDolly&&o<r.minDistance&&(r._camera.getWorldDirection(rr),r._targetEnd.add(rr.normalize().multiplyScalar(s)),r._target.add(rr.normalize().multiplyScalar(s))),r.dollyToCursor&&(r._dollyControlAmount+=r._sphericalEnd.radius-s,r._dollyControlCoord.set(t,n))},h=function(e,t,n){var i=Math.pow(.95,e*r.dollySpeed);r.zoomTo(r._zoom*i),r.dollyToCursor&&(r._dollyControlAmount=r._zoomEnd,r._dollyControlCoord.set(t,n))},d=function(){r._state=Dn.NONE,document.removeEventListener("mousemove",b),document.removeEventListener("touchmove",b,{passive:!1}),document.removeEventListener("mouseup",_),document.removeEventListener("touchend",_)},p=function(e){if(r._enabled){switch(d(),e.button){case Qn.MOUSE.LEFT:r._state=r.mouseButtons.left;break;case Qn.MOUSE.MIDDLE:r._state=r.mouseButtons.middle;break;case Qn.MOUSE.RIGHT:r._state=r.mouseButtons.right}y(e)}},f=function(e){if(r._enabled){switch(d(),e.touches.length){case 1:r._state=r.touches.one;break;case 2:r._state=r.touches.two;break;case 3:r._state=r.touches.three}y(e)}},m=-1,v=function(e){if(r._enabled&&r.mouseButtons.wheel!==Dn.NONE){if(e.preventDefault(),r.dollyToCursor||r.mouseButtons.wheel===Dn.ROTATE||r.mouseButtons.wheel===Dn.TRUCK){var t=performance.now();m-t<1e3&&r._getClientRect(a),m=t}var n=br?-1:-3,i=1===e.deltaMode?e.deltaY/n:e.deltaY/(10*n),o=r.dollyToCursor?(e.clientX-a.x)/a.z*2-1:0,s=r.dollyToCursor?(e.clientY-a.y)/a.w*-2+1:0;switch(r.mouseButtons.wheel){case Dn.ROTATE:c(e.deltaX,e.deltaY);break;case Dn.TRUCK:l(e.deltaX,e.deltaY,!1);break;case Dn.OFFSET:l(e.deltaX,e.deltaY,!0);break;case Dn.DOLLY:u(-i,o,s);break;case Dn.ZOOM:h(-i,o,s)}r.dispatchEvent({type:"control",originalEvent:e})}},g=function(e){r._enabled&&e.preventDefault()},y=function(e){if(r._enabled){if(Kn(e,nr),r._getClientRect(a),i.copy(nr),o.copy(nr),qn(e)&&e.touches.length>=2){var t=e,n=nr.x-t.touches[1].clientX,l=nr.y-t.touches[1].clientY,c=Math.sqrt(n*n+l*l);s.set(0,c);var u=.5*(t.touches[0].clientX+t.touches[1].clientX),h=.5*(t.touches[0].clientY+t.touches[1].clientY);o.set(u,h)}document.addEventListener("mousemove",b),document.addEventListener("touchmove",b,{passive:!1}),document.addEventListener("mouseup",_),document.addEventListener("touchend",_),r.dispatchEvent({type:"controlstart",originalEvent:e})}},b=function(e){if(r._enabled){e.cancelable&&e.preventDefault(),Kn(e,nr);var t=o.x-nr.x,n=o.y-nr.y;switch(o.copy(nr),r._state){case Dn.ROTATE:case Dn.TOUCH_ROTATE:c(t,n);break;case Dn.DOLLY:case Dn.ZOOM:var d=r.dollyToCursor?(i.x-a.x)/a.z*2-1:0,p=r.dollyToCursor?(i.y-a.y)/a.w*-2+1:0;r._state===Dn.DOLLY?u(n*wr,d,p):h(n*wr,d,p);break;case Dn.TOUCH_DOLLY:case Dn.TOUCH_ZOOM:case Dn.TOUCH_DOLLY_TRUCK:case Dn.TOUCH_ZOOM_TRUCK:case Dn.TOUCH_DOLLY_OFFSET:case Dn.TOUCH_ZOOM_OFFSET:var f=e,m=nr.x-f.touches[1].clientX,v=nr.y-f.touches[1].clientY,g=Math.sqrt(m*m+v*v),y=s.y-g;s.set(0,g);d=r.dollyToCursor?(o.x-a.x)/a.z*2-1:0,p=r.dollyToCursor?(o.y-a.y)/a.w*-2+1:0;r._state===Dn.TOUCH_DOLLY||r._state===Dn.TOUCH_DOLLY_TRUCK?u(y*wr,d,p):h(y*wr,d,p),r._state===Dn.TOUCH_DOLLY_TRUCK||r._state===Dn.TOUCH_ZOOM_TRUCK?l(t,n,!1):r._state!==Dn.TOUCH_DOLLY_OFFSET&&r._state!==Dn.TOUCH_ZOOM_OFFSET||l(t,n,!0);break;case Dn.TRUCK:case Dn.TOUCH_TRUCK:l(t,n,!1);break;case Dn.OFFSET:case Dn.TOUCH_OFFSET:l(t,n,!0)}r.dispatchEvent({type:"control",originalEvent:e})}},_=function(e){r._enabled&&(d(),r.dispatchEvent({type:"controlend",originalEvent:e}))};r._domElement.addEventListener("mousedown",p),r._domElement.addEventListener("touchstart",f,{passive:!0}),r._domElement.addEventListener("wheel",v,{passive:!1}),r._domElement.addEventListener("contextmenu",g),r._removeAllEventListeners=function(){r._domElement.removeEventListener("mousedown",p),r._domElement.removeEventListener("touchstart",f,{passive:!0}),r._domElement.removeEventListener("wheel",v,{passive:!1}),r._domElement.removeEventListener("contextmenu",g),document.removeEventListener("mousemove",b),document.removeEventListener("touchmove",b,{passive:!1}),document.removeEventListener("mouseup",_),document.removeEventListener("touchend",_)},r.cancel=function(){d(),r.dispatchEvent({type:"controlend",originalEvent:null})}}return r.update(0),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Fn(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.install=function(e){Qn=e.THREE,Jn=Object.freeze(new Qn.Vector3(0,0,0)),er=Object.freeze(new Qn.Vector3(0,1,0)),tr=Object.freeze(new Qn.Vector3(0,0,1)),nr=new Qn.Vector2,rr=new Qn.Vector3,ir=new Qn.Vector3,or=new Qn.Vector3,sr=new Qn.Vector3,ar=new Qn.Vector3,lr=new Qn.Vector3,cr=new Qn.Spherical,ur=new Qn.Spherical,hr=new Qn.Box3,dr=new Qn.Box3,pr=new Qn.Sphere,fr=new Qn.Quaternion,mr=new Qn.Quaternion,vr=new Qn.Matrix4,gr=new Qn.Raycaster},Object.defineProperty(t,"ACTION",{get:function(){return _r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},set:function(e){this._enabled=e,e||this.cancel()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentAction",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distance",{get:function(){return this._spherical.radius},set:function(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"azimuthAngle",{get:function(){return this._spherical.theta},set:function(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"polarAngle",{get:function(){return this._spherical.phi},set:function(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"phiSpeed",{set:function(e){console.warn("phiSpeed was renamed. use azimuthRotateSpeed instead"),this.azimuthRotateSpeed=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thetaSpeed",{set:function(e){console.warn("thetaSpeed was renamed. use polarRotateSpeed instead"),this.polarRotateSpeed=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"boundaryEnclosesCamera",{get:function(){return this._boundaryEnclosesCamera},set:function(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0},enumerable:!1,configurable:!0}),t.prototype.addEventListener=function(t,n){e.prototype.addEventListener.call(this,t,n)},t.prototype.removeEventListener=function(t,n){e.prototype.removeEventListener.call(this,t,n)},t.prototype.rotate=function(e,t,n){void 0===n&&(n=!1),this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,n)},t.prototype.rotateTo=function(e,t,n){void 0===n&&(n=!1);var r=Qn.MathUtils.clamp(e,this.minAzimuthAngle,this.maxAzimuthAngle),i=Qn.MathUtils.clamp(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=r,this._sphericalEnd.phi=i,this._sphericalEnd.makeSafe(),n||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi),this._needsUpdate=!0},t.prototype.dolly=function(e,t){void 0===t&&(t=!1),this.dollyTo(this._sphericalEnd.radius-e,t)},t.prototype.dollyTo=function(e,t){void 0===t&&(t=!1),this._sphericalEnd.radius=Qn.MathUtils.clamp(e,this.minDistance,this.maxDistance),t||(this._spherical.radius=this._sphericalEnd.radius),this._needsUpdate=!0},t.prototype.zoom=function(e,t){void 0===t&&(t=!1),this.zoomTo(this._zoomEnd+e,t)},t.prototype.zoomTo=function(e,t){void 0===t&&(t=!1),this._zoomEnd=Qn.MathUtils.clamp(e,this.minZoom,this.maxZoom),t||(this._zoom=this._zoomEnd),this._needsUpdate=!0},t.prototype.pan=function(e,t,n){void 0===n&&(n=!1),console.log("`pan` has been renamed to `truck`"),this.truck(e,t,n)},t.prototype.truck=function(e,t,n){void 0===n&&(n=!1),this._camera.updateMatrix(),sr.setFromMatrixColumn(this._camera.matrix,0),ar.setFromMatrixColumn(this._camera.matrix,1),sr.multiplyScalar(e),ar.multiplyScalar(-t);var r=rr.copy(sr).add(ar);this._encloseToBoundary(this._targetEnd,r,this.boundaryFriction),n||this._target.copy(this._targetEnd),this._needsUpdate=!0},t.prototype.forward=function(e,t){void 0===t&&(t=!1),rr.setFromMatrixColumn(this._camera.matrix,0),rr.crossVectors(this._camera.up,rr),rr.multiplyScalar(e),this._encloseToBoundary(this._targetEnd,rr,this.boundaryFriction),t||this._target.copy(this._targetEnd),this._needsUpdate=!0},t.prototype.moveTo=function(e,t,n,r){void 0===r&&(r=!1),this._targetEnd.set(e,t,n),r||this._target.copy(this._targetEnd),this._needsUpdate=!0},t.prototype.fitToBox=function(e,t,n){var r=void 0===n?{}:n,i=r.paddingLeft,o=void 0===i?0:i,s=r.paddingRight,a=void 0===s?0:s,l=r.paddingBottom,c=void 0===l?0:l,u=r.paddingTop,h=void 0===u?0:u,d=e.isBox3?hr.copy(e):hr.setFromObject(e);if(d.isEmpty())console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting");else{var p=Xn(this._sphericalEnd.theta,Vn),f=Xn(this._sphericalEnd.phi,Vn);this.rotateTo(p,f,t);var m=rr.setFromSpherical(this._sphericalEnd).normalize(),v=fr.setFromUnitVectors(m,tr);(function(e,t){return Gn(e-t)})(Math.abs(m.y),1)&&v.multiply(mr.setFromAxisAngle(er,p));var g=dr.makeEmpty();ir.copy(d.min).applyQuaternion(v),g.expandByPoint(ir),ir.copy(d.min).setX(d.max.x).applyQuaternion(v),g.expandByPoint(ir),ir.copy(d.min).setY(d.max.y).applyQuaternion(v),g.expandByPoint(ir),ir.copy(d.max).setZ(d.min.z).applyQuaternion(v),g.expandByPoint(ir),ir.copy(d.min).setZ(d.max.z).applyQuaternion(v),g.expandByPoint(ir),ir.copy(d.max).setY(d.min.y).applyQuaternion(v),g.expandByPoint(ir),ir.copy(d.max).setX(d.min.x).applyQuaternion(v),g.expandByPoint(ir),ir.copy(d.max).applyQuaternion(v),g.expandByPoint(ir),v.setFromUnitVectors(tr,m),g.min.x-=o,g.min.y-=c,g.max.x+=a,g.max.y+=h;var y=g.getSize(rr),b=g.getCenter(ir).applyQuaternion(v);if(jn(this._camera)){var _=this.getDistanceToFitBox(y.x,y.y,y.z);return this.moveTo(b.x,b.y,b.z,t),this.dollyTo(_,t),void this.setFocalOffset(0,0,0,t)}if(Hn(this._camera)){var w=this._camera,E=w.right-w.left,x=w.top-w.bottom,T=Math.min(E/y.x,x/y.y);return this.moveTo(b.x,b.y,b.z,t),this.zoomTo(T,t),void this.setFocalOffset(0,0,0,t)}}},t.prototype.fitTo=function(e,t,n){void 0===n&&(n={}),console.warn("camera-controls: fitTo() has been renamed to fitToBox()"),this.fitToBox(e,t,n)},t.prototype.fitToSphere=function(e,t){var n=e instanceof Qn.Sphere?pr.copy(e):function(e,t){var n=t,r=n.center;e.traverse((function(e){e.isMesh&&hr.expandByObject(e)})),hr.getCenter(r);var i=0;return e.traverse((function(e){if(e.isMesh){var t=e,n=t.geometry.clone();if(n.applyMatrix4(t.matrixWorld),t.geometry.isBufferGeometry)for(var o=0,s=(a=n.attributes.position).count;o<s;o++)rr.fromBufferAttribute(a,o),i=Math.max(i,r.distanceToSquared(rr));else{var a=n.attributes.position,l=new Qn.Vector3;for(o=0,s=a.count;o<s;o++)l.fromBufferAttribute(a,o),i=Math.max(i,r.distanceToSquared(l))}}})),n.radius=Math.sqrt(i),n}(e,pr);if(this.moveTo(n.center.x,n.center.y,n.center.z,t),jn(this._camera)){var r=this.getDistanceToFitSphere(n.radius);this.dollyTo(r,t)}else if(Hn(this._camera)){var i=this._camera.right-this._camera.left,o=this._camera.top-this._camera.bottom,s=2*n.radius,a=Math.min(i/s,o/s);this.zoomTo(a,t)}this.setFocalOffset(0,0,0,t)},t.prototype.setLookAt=function(e,t,n,r,i,o,s){void 0===s&&(s=!1);var a=rr.set(e,t,n),l=ir.set(r,i,o);this._targetEnd.copy(l),this._sphericalEnd.setFromVector3(a.sub(l).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),s||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd)),this._needsUpdate=!0},t.prototype.lerpLookAt=function(e,t,n,r,i,o,s,a,l,c,u,h,d,p){void 0===p&&(p=!1);var f=rr.set(e,t,n),m=ir.set(r,i,o);cr.setFromVector3(f.sub(m).applyQuaternion(this._yAxisUpSpace));var v=rr.set(c,u,h);this._targetEnd.copy(m).lerp(v,d);var g=ir.set(s,a,l);ur.setFromVector3(g.sub(v).applyQuaternion(this._yAxisUpSpace));var y=ur.theta-cr.theta,b=ur.phi-cr.phi,_=ur.radius-cr.radius;this._sphericalEnd.set(cr.radius+_*d,cr.phi+b*d,cr.theta+y*d),this.normalizeRotations(),p||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd)),this._needsUpdate=!0},t.prototype.setPosition=function(e,t,n,r){void 0===r&&(r=!1),this.setLookAt(e,t,n,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,r)},t.prototype.setTarget=function(e,t,n,r){void 0===r&&(r=!1);var i=this.getPosition(rr);this.setLookAt(i.x,i.y,i.z,e,t,n,r)},t.prototype.setFocalOffset=function(e,t,n,r){void 0===r&&(r=!1),this._focalOffsetEnd.set(e,t,n),r||this._focalOffset.copy(this._focalOffsetEnd),this._needsUpdate=!0},t.prototype.setBoundary=function(e){if(!e)return this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),void(this._needsUpdate=!0);this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0},t.prototype.setViewport=function(e,t,n,r){null!==e?(this._viewport=this._viewport||new Qn.Vector4,"number"==typeof e?this._viewport.set(e,t,n,r):this._viewport.copy(e)):this._viewport=null},t.prototype.getDistanceToFitBox=function(e,t,n){if(Yn(this._camera,"getDistanceToFit"))return this._spherical.radius;var r=this._camera,i=e/t,o=r.getEffectiveFOV()*Qn.MathUtils.DEG2RAD,s=r.aspect;return.5*(i<s?t:e/s)/Math.tan(.5*o)+.5*n},t.prototype.getDistanceToFit=function(e,t,n){return console.warn("camera-controls: getDistanceToFit() has been renamed to getDistanceToFitBox()"),this.getDistanceToFitBox(e,t,n)},t.prototype.getDistanceToFitSphere=function(e){if(Yn(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;var t=this._camera,n=t.getEffectiveFOV()*Qn.MathUtils.DEG2RAD,r=2*Math.atan(Math.tan(.5*n)*t.aspect),i=1<t.aspect?n:r;return e/Math.sin(.5*i)},t.prototype.getTarget=function(e){return(e&&e.isVector3?e:new Qn.Vector3).copy(this._targetEnd)},t.prototype.getPosition=function(e){return(e&&e.isVector3?e:new Qn.Vector3).setFromSpherical(this._sphericalEnd).applyQuaternion(this._yAxisUpSpaceInverse).add(this._targetEnd)},t.prototype.getFocalOffset=function(e){return(e&&e.isVector3?e:new Qn.Vector3).copy(this._focalOffsetEnd)},t.prototype.normalizeRotations=function(){this._sphericalEnd.theta=this._sphericalEnd.theta%Bn,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=Bn),this._spherical.theta+=Bn*Math.round((this._sphericalEnd.theta-this._spherical.theta)/Bn)},t.prototype.reset=function(e){void 0===e&&(e=!1),this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)},t.prototype.saveState=function(){this._target0.copy(this._target),this._position0.copy(this._camera.position),this._zoom0=this._zoom},t.prototype.updateCameraUp=function(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,er),Zn(this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace))},t.prototype.update=function(e){var t=this._state===Dn.NONE?this.dampingFactor:this.draggingDampingFactor,n=1-Math.exp(-t*e*62.5),r=this._sphericalEnd.theta-this._spherical.theta,i=this._sphericalEnd.phi-this._spherical.phi,o=this._sphericalEnd.radius-this._spherical.radius,s=rr.subVectors(this._targetEnd,this._target),a=ir.subVectors(this._focalOffsetEnd,this._focalOffset);if(Gn(r)&&Gn(i)&&Gn(o)&&Gn(s.x)&&Gn(s.y)&&Gn(s.z)&&Gn(a.x)&&Gn(a.y)&&Gn(a.z)?(this._spherical.copy(this._sphericalEnd),this._target.copy(this._targetEnd),this._focalOffset.copy(this._focalOffsetEnd)):(this._spherical.set(this._spherical.radius+o*n,this._spherical.phi+i*n,this._spherical.theta+r*n),this._target.add(s.multiplyScalar(n)),this._focalOffset.add(a.multiplyScalar(n)),this._needsUpdate=!0),0!==this._dollyControlAmount){if(jn(this._camera)){var l=this._camera,c=rr.setFromSpherical(this._sphericalEnd).applyQuaternion(this._yAxisUpSpaceInverse).normalize().negate(),u=ir.copy(c).cross(l.up).normalize();0===u.lengthSq()&&(u.x=1);var h=or.crossVectors(u,c),d=this._sphericalEnd.radius*Math.tan(l.getEffectiveFOV()*Qn.MathUtils.DEG2RAD*.5),p=(this._sphericalEnd.radius-this._dollyControlAmount-this._sphericalEnd.radius)/this._sphericalEnd.radius,f=rr.copy(this._targetEnd).add(u.multiplyScalar(this._dollyControlCoord.x*d*l.aspect)).add(h.multiplyScalar(this._dollyControlCoord.y*d));this._targetEnd.lerp(f,p),this._target.copy(this._targetEnd)}else if(Hn(this._camera)){l=this._camera;var m=rr.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(l.near+l.far)/(l.near-l.far)).unproject(l),v=ir.set(0,0,-1).applyQuaternion(l.quaternion),g=v.dot(l.up),y=Gn(g)?-m.dot(l.up):-m.dot(l.up)/g;f=or.copy(m).add(v.multiplyScalar(y));this._targetEnd.lerp(f,1-l.zoom/this._dollyControlAmount),this._target.copy(this._targetEnd)}this._dollyControlAmount=0}var b=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,b),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!Gn(this._focalOffset.x)||!Gn(this._focalOffset.y)||!Gn(this._focalOffset.z))&&(this._camera.updateMatrix(),sr.setFromMatrixColumn(this._camera.matrix,0),ar.setFromMatrixColumn(this._camera.matrix,1),lr.setFromMatrixColumn(this._camera.matrix,2),sr.multiplyScalar(this._focalOffset.x),ar.multiplyScalar(-this._focalOffset.y),lr.multiplyScalar(this._focalOffset.z),rr.copy(sr).add(ar).add(lr),this._camera.position.add(rr)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),rr.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);var _=this._zoomEnd-this._zoom;this._zoom+=_*n,this._camera.zoom!==this._zoom&&(Gn(_)&&(this._zoom=this._zoomEnd),this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0);var w=this._needsUpdate;return w&&!this._updatedLastTime?(this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):w?this.dispatchEvent({type:"update"}):!w&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._updatedLastTime=w,this._needsUpdate=!1,w},t.prototype.toJSON=function(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:Wn(this.maxDistance),minZoom:this.minZoom,maxZoom:Wn(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:Wn(this.maxPolarAngle),minAzimuthAngle:Wn(this.minAzimuthAngle),maxAzimuthAngle:Wn(this.maxAzimuthAngle),dampingFactor:this.dampingFactor,draggingDampingFactor:this.draggingDampingFactor,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:rr.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})},t.prototype.fromJSON=function(e,t){void 0===t&&(t=!1);var n=JSON.parse(e),r=rr.fromArray(n.position);this.enabled=n.enabled,this.minDistance=n.minDistance,this.maxDistance=$n(n.maxDistance),this.minZoom=n.minZoom,this.maxZoom=$n(n.maxZoom),this.minPolarAngle=n.minPolarAngle,this.maxPolarAngle=$n(n.maxPolarAngle),this.minAzimuthAngle=$n(n.minAzimuthAngle),this.maxAzimuthAngle=$n(n.maxAzimuthAngle),this.dampingFactor=n.dampingFactor,this.draggingDampingFactor=n.draggingDampingFactor,this.dollySpeed=n.dollySpeed,this.truckSpeed=n.truckSpeed,this.dollyToCursor=n.dollyToCursor,this.verticalDragToForward=n.verticalDragToForward,this._target0.fromArray(n.target0),this._position0.fromArray(n.position0),this._zoom0=n.zoom0,this._focalOffset0.fromArray(n.focalOffset0),this.moveTo(n.target[0],n.target[1],n.target[2],t),cr.setFromVector3(r.sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(cr.theta,cr.phi,t),this.zoomTo(n.zoom,t),this.setFocalOffset(n.focalOffset[0],n.focalOffset[1],n.focalOffset[2],t),this._needsUpdate=!0},t.prototype.dispose=function(){this._removeAllEventListeners()},t.prototype._encloseToBoundary=function(e,t,n){var r=t.lengthSq();if(0===r)return e;var i=ir.copy(t).add(e),o=this._boundary.clampPoint(i,or).sub(i),s=o.lengthSq();if(0===s)return e.add(t);if(s===r)return e;if(0===n)return e.add(t).add(o);var a=1+n*s/t.dot(o);return e.add(ir.copy(t).multiplyScalar(a)).add(o.multiplyScalar(1-n))},t.prototype._updateNearPlaneCorners=function(){if(jn(this._camera)){var e=(i=this._camera).near,t=i.getEffectiveFOV()*Qn.MathUtils.DEG2RAD,n=Math.tan(.5*t)*e,r=n*i.aspect;this._nearPlaneCorners[0].set(-r,-n,0),this._nearPlaneCorners[1].set(r,-n,0),this._nearPlaneCorners[2].set(r,n,0),this._nearPlaneCorners[3].set(-r,n,0)}else if(Hn(this._camera)){var i,o=1/(i=this._camera).zoom,s=i.left*o,a=i.right*o,l=i.top*o,c=i.bottom*o;this._nearPlaneCorners[0].set(s,l,0),this._nearPlaneCorners[1].set(a,l,0),this._nearPlaneCorners[2].set(a,c,0),this._nearPlaneCorners[3].set(s,c,0)}},t.prototype._collisionTest=function(){var e=1/0;if(!(this.colliderMeshes.length>=1))return e;if(Yn(this._camera,"_collisionTest"))return e;e=this._spherical.radius;var t=rr.setFromSpherical(this._spherical).divideScalar(e);vr.lookAt(Jn,t,this._camera.up);for(var n=0;n<4;n++){var r=ir.copy(this._nearPlaneCorners[n]);r.applyMatrix4(vr);var i=or.addVectors(this._target,r);gr.set(i,t),gr.far=e;var o=gr.intersectObjects(this.colliderMeshes);0!==o.length&&o[0].distance<e&&(e=o[0].distance)}return e},t.prototype._getClientRect=function(e){var t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.z=this._viewport.z,e.w=this._viewport.w):(e.z=t.width,e.w=t.height),e},t.prototype._removeAllEventListeners=function(){},t}(yr);function xr(){const e=navigator.userAgent??navigator.vendor??window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}class Tr{constructor(e,t,n,i){this.pointer=new r.V,xr()||(this.raycaster=e,this.camera=t,this.scene=n,this.canvas=i,this.moveEvent=this.moveEvent.bind(this),this.canvas.addEventListener("pointermove",this.moveEvent),this.update=this.desktop)}moveEvent(e){this.pointer.x=e.clientX/window.innerWidth*2-1,this.pointer.y=-e.clientY/window.innerHeight*2+1}desktop(){if(this.raycaster.setFromCamera(this.pointer,this.camera),!this.scene.children[2]?.children)return;const e=this.raycaster.intersectObjects(this.scene.children[2].children);e.length>0?this.INTERSECTION!=e[0].object&&(this.INTERSECTION=e[0].object,e[0].object?.getItem?document.body.style.cursor=e[0].object.getItem(e[0].instanceId).cursor:document.body.style.cursor="pointer"):(this.INTERSECTION&&(document.body.style.cursor="default"),this.INTERSECTION=null)}update(){}destory(){xr()||this.canvas.removeEventListener("pointermove",this.moveEvent)}}class Ar{constructor(e=document){this.startPosition={x:-1,y:-1},this.currentPosition={x:-1,y:-1};try{this.touchstart=this.touchstart.bind(this),this.touchend=this.touchend.bind(this),this.touchmove=this.touchmove.bind(this),this.touchTapEvent=document.createEvent("Event"),this.touchTapEvent.initEvent("touchtap",!0,!0),e.addEventListener("touchstart",this.touchstart,!1),e.addEventListener("touchend",this.touchend,!1),e.addEventListener("touchcancel",this.touchend,!1),e.addEventListener("touchmove",this.touchmove,!1)}catch(e){}}dispose(e=document){e.removeEventListener("touchstart",this.touchstart,!1),e.removeEventListener("touchend",this.touchend,!1),e.removeEventListener("touchcancel",this.touchend,!1),e.removeEventListener("touchmove",this.touchmove,!1)}getTouchObject(e){return e.originalEvent&&e.originalEvent.targetTouches?e.originalEvent.targetTouches[0]:e.targetTouches?e.targetTouches[0]:e}approximatelyEqual(e,t){return Math.abs(e-t)<2}touchstart(e){const t=this.getTouchObject(e);this.startPosition.x=t.pageX,this.startPosition.y=t.pageY,this.currentPosition.x=t.pageX,this.currentPosition.y=t.pageY,this.isTapLength=!0,this.tapLengthTimeout&&clearTimeout(this.tapLengthTimeout),this.tapLengthTimeout=setTimeout((()=>{this.isTapLength=!1}),200)}touchend(e){this.isTapLength&&this.approximatelyEqual(this.startPosition.x,this.currentPosition.x)&&this.approximatelyEqual(this.startPosition.y,this.currentPosition.y)&&(this.touchTapEvent.customData={touchX:this.currentPosition.x,touchY:this.currentPosition.y},e.target.dispatchEvent(this.touchTapEvent))}touchmove(e){const t=this.getTouchObject(e);this.currentPosition.x=t.pageX,this.currentPosition.y=t.pageY}}const Sr=class extends s{constructor(e){if(Sr.INSTANCE)return Sr.INSTANCE;super(),this.config=e,this.touch=null,this.raycaster=new r.R,this.frustumSize=1e3,this.animationLoop=this.animationLoop.bind(this),this.resize=this.resize.bind(this),Er.install({THREE:{MOUSE:r.a,MathUtils:r.M,Quaternion:r.Q,Spherical:r.d,Vector2:r.V,Vector3:r.b,Vector4:r.c,Matrix4:r.e,Raycaster:r.R,Box3:r.B,Sphere:r.f}}),Sr.INSTANCE=this,this.init()}static Destory(){Sr.INSTANCE?.destory(),Sr.INSTANCE=null}init(){this.renderer=new r.W({antialias:!0,canvas:this.config?.canvas}),this.scene=new r.S;const e=window.innerWidth/window.innerHeight;this.camera=new r.O(this.frustumSize*e/-2,this.frustumSize*e/2,this.frustumSize/2,this.frustumSize/-2,1,1e3),this.composer=new kn(this.renderer),this.composer.addPass(new zn(this.scene,this.camera)),this.composer.setSize(window.innerWidth,window.innerHeight),this.composer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight,!0),this.renderer.setPixelRatio(window.devicePixelRatio),this.controls=new Er(this.camera,this.renderer.domElement),this.controls.setPosition(0,0,5);const t=(new r.T).load(xr()?"mobile_bg.jpg":"desktop_bg.jpg");this.scene.background=t,this.scene.fog=new r.F(0),this.config?.canvas||document.body.appendChild(this.renderer.domElement),document.addEventListener("resize",this.resize,!0),this.controls.setPosition(-49,79,98),this.controls.zoom(21),this.controls.setTarget(21,-2,18),this.controls.maxZoom=36,this.controls.minZoom=5,this.controls.setBoundary(new r.B(new r.b(-40,-10,-40),new r.b(40,10,40))),this.controls.mouseButtons.left=Er.ACTION.TRUCK,this.controls.mouseButtons.middle=Er.ACTION.NONE,this.controls.mouseButtons.right=Er.ACTION.NONE,this.controls.touches.one=Er.ACTION.TOUCH_TRUCK,this.controls.touches.three=Er.ACTION.NONE;const n=new r.G;n.name="Lights";const i=new r.H;i.position.set(0,50,0),n.add(i);const o=new r.D;o.position.set(-1,1.75,1),o.position.multiplyScalar(30),n.add(o),this.scene.add(n),this.init_selection(),this.renderer.setAnimationLoop(this.animationLoop)}selection(e){this.selection_handler(new r.V(e.clientX/window.innerWidth*2-1,-e.clientY/window.innerHeight*2+1))}selection_mobile(e){this.selection_handler(new r.V(e.customData.touchX/window.innerWidth*2-1,-e.customData.touchY/window.innerHeight*2+1))}selection_handler(e){this.raycaster.setFromCamera(e,this.camera);const t=this.scene.getObjectByName("World");if(!t)throw new Error("Selection: Failed to find World Group");const n=this.raycaster.intersectObjects(t.children);if(n.length>0)if(n[0].object?.getItem){const e=n[0].object.getItem(n[0].instanceId);console.log("NAME",n[0].object.name,"REF",e),this.events.emit({type:_e.LOG,id:Te["ClickEvent::ObjectSelected"],data:e})}else this.events.emit({type:_e.LOG,id:Te["ClickEvent::ObjectSelected"],data:{x:n[0].object.position.x/4,y:0,z:n[0].object.position.z/4,dir:0,above:!1,cursor:"pointer"}})}init_selection(){if(this.hover=new Tr(this.raycaster,this.camera,this.scene,this.renderer.domElement),xr())return this.selection_mobile=this.selection_mobile.bind(this),this.touch=new Ar(this.renderer.domElement),void this.renderer.domElement.addEventListener("touchtap",this.selection_mobile);this.selection=this.selection.bind(this),this.renderer.domElement.addEventListener("click",this.selection)}destory(){xr()?(this.renderer.domElement.removeEventListener("touchtap",this.selection_mobile),this.touch?.dispose(this.renderer.domElement)):this.renderer.domElement.removeEventListener("click",this.selection),this.hover.destory(),document.removeEventListener("resize",this.resize),this.renderer.dispose()}addToScene(...e){this.scene.add(...e)}worldToScreen(e){const t=this.renderer.domElement;return e.project(this.camera),e.x=Math.round((.5+e.x/2)*(t.width/window.devicePixelRatio)),e.y=Math.round((.5-e.y/2)*(t.height/window.devicePixelRatio)),e}resize(){const e=window.innerWidth/window.innerHeight;this.camera.left=-this.frustumSize*e/2,this.camera.right=this.frustumSize*e/2,this.camera.top=this.frustumSize/2,this.camera.bottom=-this.frustumSize/2,this.camera.updateProjectionMatrix(),this.composer.setSize(window.innerWidth,window.innerHeight),this.composer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight,!0),this.renderer.setPixelRatio(window.devicePixelRatio)}animationLoop(e){this.hover.update(),this.controls.update(e),this.composer.render(e)}};let Or=Sr;Or.INSTANCE=null;const Ir=Or,Rr=class extends r.I{constructor(e,t,n){super(e,t,225),this.data=n,this.dummy=new r.i,this.instanceMatrix.setUsage(r.h),this.update()}getIndexOf(e){return this.data.filter((t=>t.x===e.x&&t.z===e.z&&t.y===e.y))[0]?.index}setRotation(e,t){this.data[e].dir=t,this.dummy.rotation.set(0,t,0),this.dummy.updateMatrix(),this.setMatrixAt(e,this.dummy.matrix)}setPostion(e,t,n,r){this.data[e].x=t,this.data[e].y=n,this.data[e].z=r,this.dummy.position.set(t*Rr.WORLD_TILE_OFFSET,n*Rr.WORLD_TILE_OFFSET,r*Rr.WORLD_TILE_OFFSET),this.dummy.updateMatrix(),this.setMatrixAt(e,this.dummy.matrix)}getItem(e){return this.data[e]}addInst(e){this.data.push(e),this.update()}removeInst(e){if(e<0||e>=this.data.length)throw new Error("Index out of bounds");const t=this.data.length-1;let n=this.data[e];for(let n=e;n<t;n++)this.data[n]=this.data[n+1];return this.data.length=t,this.update(),n}removeAll(){this.data=[],this.update()}update(){this.count=this.data.length;for(let e=0;e<this.data.length;e++)this.data[e].index=e,this.setPostion(e,this.data[e].x,this.data[e].y,this.data[e].z),this.setRotation(e,this.data[e].dir);this.instanceMatrix.needsUpdate=!0}};let Mr=Rr;Mr.WORLD_TILE_OFFSET=4;const Cr=Mr;class Lr extends Cr{constructor(e,t,n){super(e,t,n),this.is_tile=!0}}class Nr{constructor(e=Math){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(let t=0;t<256;t++)this.p[t]=Math.floor(256*e.random());this.perm=[];for(let e=0;e<512;e++)this.perm[e]=this.p[255&e];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]}dot(e,t,n){return e[0]*t+e[1]*n}dot3(e,t,n,r){return e[0]*t+e[1]*n+e[2]*r}dot4(e,t,n,r,i){return e[0]*t+e[1]*n+e[2]*r+e[3]*i}noise(e,t){let n,r,i;const o=(e+t)*(.5*(Math.sqrt(3)-1)),s=Math.floor(e+o),a=Math.floor(t+o),l=(3-Math.sqrt(3))/6,c=(s+a)*l,u=e-(s-c),h=t-(a-c);let d,p;u>h?(d=1,p=0):(d=0,p=1);const f=u-d+l,m=h-p+l,v=u-1+2*l,g=h-1+2*l,y=255&s,b=255&a,_=this.perm[y+this.perm[b]]%12,w=this.perm[y+d+this.perm[b+p]]%12,E=this.perm[y+1+this.perm[b+1]]%12;let x=.5-u*u-h*h;x<0?n=0:(x*=x,n=x*x*this.dot(this.grad3[_],u,h));let T=.5-f*f-m*m;T<0?r=0:(T*=T,r=T*T*this.dot(this.grad3[w],f,m));let A=.5-v*v-g*g;return A<0?i=0:(A*=A,i=A*A*this.dot(this.grad3[E],v,g)),70*(n+r+i)}noise3d(e,t,n){let r,i,o,s;const a=(e+t+n)*(1/3),l=Math.floor(e+a),c=Math.floor(t+a),u=Math.floor(n+a),h=1/6,d=(l+c+u)*h,p=e-(l-d),f=t-(c-d),m=n-(u-d);let v,g,y,b,_,w;p>=f?f>=m?(v=1,g=0,y=0,b=1,_=1,w=0):p>=m?(v=1,g=0,y=0,b=1,_=0,w=1):(v=0,g=0,y=1,b=1,_=0,w=1):f<m?(v=0,g=0,y=1,b=0,_=1,w=1):p<m?(v=0,g=1,y=0,b=0,_=1,w=1):(v=0,g=1,y=0,b=1,_=1,w=0);const E=p-v+h,x=f-g+h,T=m-y+h,A=p-b+2*h,S=f-_+2*h,O=m-w+2*h,I=p-1+.5,R=f-1+.5,M=m-1+.5,C=255&l,L=255&c,N=255&u,k=this.perm[C+this.perm[L+this.perm[N]]]%12,P=this.perm[C+v+this.perm[L+g+this.perm[N+y]]]%12,z=this.perm[C+b+this.perm[L+_+this.perm[N+w]]]%12,D=this.perm[C+1+this.perm[L+1+this.perm[N+1]]]%12;let U=.6-p*p-f*f-m*m;U<0?r=0:(U*=U,r=U*U*this.dot3(this.grad3[k],p,f,m));let F=.6-E*E-x*x-T*T;F<0?i=0:(F*=F,i=F*F*this.dot3(this.grad3[P],E,x,T));let j=.6-A*A-S*S-O*O;j<0?o=0:(j*=j,o=j*j*this.dot3(this.grad3[z],A,S,O));let H=.6-I*I-R*R-M*M;return H<0?s=0:(H*=H,s=H*H*this.dot3(this.grad3[D],I,R,M)),32*(r+i+o+s)}noise4d(e,t,n,r){const i=this.grad4,o=this.simplex,s=this.perm,a=(Math.sqrt(5)-1)/4,l=(5-Math.sqrt(5))/20;let c,u,h,d,p;const f=(e+t+n+r)*a,m=Math.floor(e+f),v=Math.floor(t+f),g=Math.floor(n+f),y=Math.floor(r+f),b=(m+v+g+y)*l,_=e-(m-b),w=t-(v-b),E=n-(g-b),x=r-(y-b),T=(_>w?32:0)+(_>E?16:0)+(w>E?8:0)+(_>x?4:0)+(w>x?2:0)+(E>x?1:0),A=o[T][0]>=3?1:0,S=o[T][1]>=3?1:0,O=o[T][2]>=3?1:0,I=o[T][3]>=3?1:0,R=o[T][0]>=2?1:0,M=o[T][1]>=2?1:0,C=o[T][2]>=2?1:0,L=o[T][3]>=2?1:0,N=o[T][0]>=1?1:0,k=o[T][1]>=1?1:0,P=o[T][2]>=1?1:0,z=o[T][3]>=1?1:0,D=_-A+l,U=w-S+l,F=E-O+l,j=x-I+l,H=_-R+2*l,B=w-M+2*l,V=E-C+2*l,G=x-L+2*l,X=_-N+3*l,W=w-k+3*l,$=E-P+3*l,q=x-z+3*l,K=_-1+4*l,Y=w-1+4*l,Z=E-1+4*l,Q=x-1+4*l,J=255&m,ee=255&v,te=255&g,ne=255&y,re=s[J+s[ee+s[te+s[ne]]]]%32,ie=s[J+A+s[ee+S+s[te+O+s[ne+I]]]]%32,oe=s[J+R+s[ee+M+s[te+C+s[ne+L]]]]%32,se=s[J+N+s[ee+k+s[te+P+s[ne+z]]]]%32,ae=s[J+1+s[ee+1+s[te+1+s[ne+1]]]]%32;let le=.6-_*_-w*w-E*E-x*x;le<0?c=0:(le*=le,c=le*le*this.dot4(i[re],_,w,E,x));let ce=.6-D*D-U*U-F*F-j*j;ce<0?u=0:(ce*=ce,u=ce*ce*this.dot4(i[ie],D,U,F,j));let ue=.6-H*H-B*B-V*V-G*G;ue<0?h=0:(ue*=ue,h=ue*ue*this.dot4(i[oe],H,B,V,G));let he=.6-X*X-W*W-$*$-q*q;he<0?d=0:(he*=he,d=he*he*this.dot4(i[se],X,W,$,q));let de=.6-K*K-Y*Y-Z*Z-Q*Q;return de<0?p=0:(de*=de,p=de*de*this.dot4(i[ae],K,Y,Z,Q)),27*(c+u+h+d+p)}}class kr{_seed(e,t){if(e===(e||0))return e;{const t=""+e;let n=0;for(let e=0;e<t.length;++e)n^=0|t.charCodeAt(e);return n}}}var Pr=(0,a.c)((function(e){!function(e,t,n){function r(e){var t=this,n=function(){var e=4022871197;return function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)}}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function i(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function o(e,t){var n=new r(e),o=t&&t.state,s=n.next;return s.int32=function(){return 4294967296*n.next()|0},s.double=function(){return s()+11102230246251565e-32*(2097152*s()|0)},s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}t&&t.exports?t.exports=o:this.alea=o}(a.a,e)})),zr=(0,a.c)((function(e){!function(e,t,n){function r(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function o(e,t){var n=new r(e),o=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}t&&t.exports?t.exports=o:this.xor128=o}(a.a,e)})),Dr=(0,a.c)((function(e){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function o(e,t){var n=new r(e),o=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}t&&t.exports?t.exports=o:this.xorwow=o}(a.a,e)})),Ur=(0,a.c)((function(e){!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.x,i=t.i;return e=r[i],n=(e^=e>>>7)^e<<24,n^=(e=r[i+1&7])^e>>>10,n^=(e=r[i+3&7])^e>>>3,n^=(e=r[i+4&7])^e<<7,e=r[i+7&7],n^=(e^=e<<13)^e<<9,r[i]=n,t.i=i+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n&&(r[7]=-1),e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function i(e,t){return t.x=e.x.slice(),t.i=e.i,t}function o(e,t){null==e&&(e=+new Date);var n=new r(e),o=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,o&&(o.x&&i(o,n),s.state=function(){return i(n,{})}),s}t&&t.exports?t.exports=o:this.xorshift7=o}(a.a,e)})),Fr=(0,a.c)((function(e){!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.w,i=t.X,o=t.i;return t.w=r=r+1640531527|0,n=i[o+34&127],e=i[o=o+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=i[o]=n^e,t.i=o,n+(r^r>>>16)|0},function(e,t){var n,r,i,o,s,a=[],l=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,l=Math.max(l,t.length)),i=0,o=-32;o<l;++o)t&&(r^=t.charCodeAt((o+32)%t.length)),0===o&&(s=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(s=s+1640531527|0,i=0==(n=a[127&o]^=r+s)?i+1:0);for(i>=128&&(a[127&(t&&t.length||0)]=-1),i=127,o=512;o>0;--o)r=a[i+34&127],n=a[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,a[i]=r^n;e.w=s,e.X=a,e.i=i}(t,e)}function i(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function o(e,t){null==e&&(e=+new Date);var n=new r(e),o=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,o&&(o.X&&i(o,n),s.state=function(){return i(n,{})}),s}t&&t.exports?t.exports=o:this.xor4096=o}(a.a,e)})),jr=(0,a.c)((function(e){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,i=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^i,t.a=i-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function i(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function o(e,t){var n=new r(e),o=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}t&&t.exports?t.exports=o:this.tychei=o}(a.a,e)})),Hr=Object.freeze({__proto__:null,default:{}}),Br=(0,a.g)(Hr),Vr=(0,a.c)((function(e){!function(t,n,r){var i,o=256,s=r.pow(o,6),a=r.pow(2,52),l=2*a,c=255;function u(e,c,u){var v=[],g=f(p((c=1==c?{entropy:!0}:c||{}).entropy?[e,m(n)]:null==e?function(){try{var e;return i&&(e=i.randomBytes)?e=e(o):(e=new Uint8Array(o),(t.crypto||t.msCrypto).getRandomValues(e)),m(e)}catch(e){var r=t.navigator,s=r&&r.plugins;return[+new Date,t,s,t.screen,m(n)]}}():e,3),v),y=new h(v),b=function(){for(var e=y.g(6),t=s,n=0;e<a;)e=(e+n)*o,t*=o,n=y.g(1);for(;e>=l;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|y.g(4)},b.quick=function(){return y.g(4)/4294967296},b.double=b,f(m(y.S),n),(c.pass||u||function(e,t,n,i){return i&&(i.S&&d(i,y),e.state=function(){return d(y,{})}),n?(r.random=e,t):e})(b,g,"global"in c?c.global:this==r,c.state)}function h(e){var t,n=e.length,r=this,i=0,s=r.i=r.j=0,a=r.S=[];for(n||(e=[n++]);i<o;)a[i]=i++;for(i=0;i<o;i++)a[i]=a[s=c&s+e[i%n]+(t=a[i])],a[s]=t;(r.g=function(e){for(var t,n=0,i=r.i,s=r.j,a=r.S;e--;)t=a[i=c&i+1],n=n*o+a[c&(a[i]=a[s=c&s+t])+(a[s]=t)];return r.i=i,r.j=s,n})(o)}function d(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function p(e,t){var n,r=[],i=typeof e;if(t&&"object"==i)for(n in e)try{r.push(p(e[n],t-1))}catch(e){}return r.length?r:"string"==i?e:e+"\0"}function f(e,t){for(var n,r=e+"",i=0;i<r.length;)t[c&i]=c&(n^=19*t[c&i])+r.charCodeAt(i++);return m(t)}function m(e){return String.fromCharCode.apply(0,e)}if(f(r.random(),n),e.exports){e.exports=u;try{i=Br}catch(e){}}else r.seedrandom=u}("undefined"!=typeof self?self:a.a,[],Math)}));Vr.alea=Pr,Vr.xor128=zr,Vr.xorwow=Dr,Vr.xorshift7=Ur,Vr.xor4096=Fr,Vr.tychei=jr;var Gr=Vr;class Xr extends kr{constructor(e,t){super(),this.seed(e,t)}get name(){return"function"}next(){return this._rng()}seed(e,t){this._rng=e}clone(e,t){return new Xr(this._rng,t)}}var Wr=(...e)=>{const[t="default",...n]=e;switch(typeof t){case"object":if(t instanceof kr)return t;break;case"function":return new Xr(t);case"number":case"string":return new Xr(Gr(...n))}throw new Error(`invalid RNG "${t}"`)},$r=(e,t=0,n=1)=>()=>e.next()*(n-t)+t;function qr(e){return new Kr(e)}class Kr{constructor(e){this.isInt=()=>{if(Number.isInteger(this.n))return this;throw new Error(`Expected number to be an integer, got ${this.n}`)},this.isPositive=()=>{if(this.n>0)return this;throw new Error(`Expected number to be positive, got ${this.n}`)},this.lessThan=e=>{if(this.n<e)return this;throw new Error(`Expected number to be less than ${e}, got ${this.n}`)},this.greaterThanOrEqual=e=>{if(this.n>=e)return this;throw new Error(`Expected number to be greater than or equal to ${e}, got ${this.n}`)},this.greaterThan=e=>{if(this.n>e)return this;throw new Error(`Expected number to be greater than ${e}, got ${this.n}`)},this.n=e}}var Yr=(e,t=0,n=1)=>(void 0===n&&(n=void 0===t?1:t,t=0),qr(t).isInt(),qr(n).isInt(),()=>Math.floor(e.next()*(n-t+1)+t)),Zr=e=>()=>e.next()>=.5;const Qr=[0,0,.6931471805599453,1.791759469228055,3.1780538303479458,4.787491742782046,6.579251212010101,8.525161361065415,10.60460290274525,12.801827480081469],Jr=e=>Qr[e];class ei extends kr{get name(){return"default"}next(){return Math.random()}seed(e,t){}clone(){return new ei}}class ti{constructor(e){this._cache={},this.next=()=>this._rng.next(),this.float=(e,t)=>this.uniform(e,t)(),this.int=(e,t)=>this.uniformInt(e,t)(),this.integer=(e,t)=>this.uniformInt(e,t)(),this.bool=()=>this.uniformBoolean()(),this.boolean=()=>this.uniformBoolean()(),this.uniform=(e,t)=>this._memoize("uniform",$r,e,t),this.uniformInt=(e,t)=>this._memoize("uniformInt",Yr,e,t),this.uniformBoolean=()=>this._memoize("uniformBoolean",Zr),this.normal=(e,t)=>((e,t=0,n=1)=>()=>{let r,i,o;do{r=2*e.next()-1,i=2*e.next()-1,o=r*r+i*i}while(!o||o>1);return t+n*i*Math.sqrt(-2*Math.log(o)/o)})(this,e,t),this.logNormal=(e,t)=>((e,t=0,n=1)=>{const r=e.normal(t,n);return()=>Math.exp(r())})(this,e,t),this.bernoulli=e=>((e,t=.5)=>(qr(t).greaterThanOrEqual(0).lessThan(1),()=>Math.floor(e.next()+t)))(this,e),this.binomial=(e,t)=>((e,t=1,n=.5)=>(qr(t).isInt().isPositive(),qr(n).greaterThanOrEqual(0).lessThan(1),()=>{let r=0,i=0;for(;r++<t;)e.next()<n&&i++;return i}))(this,e,t),this.geometric=e=>((e,t=.5)=>{qr(t).greaterThan(0).lessThan(1);const n=1/Math.log(1-t);return()=>Math.floor(1+Math.log(e.next())*n)})(this,e),this.poisson=e=>((e,t=1)=>{if(qr(t).isPositive(),t<10){const n=Math.exp(-t);return()=>{let r=n,i=0,o=e.next();for(;o>r;)o-=r,r=t*r/++i;return i}}{const n=Math.sqrt(t),r=.931+2.53*n,i=.02483*r-.059,o=1.1239+1.1328/(r-3.4),s=.9277-3.6224/(r-2);return()=>{for(var a;;){let l,c=e.next();if(c<=.86*s)return l=c/s-.43,Math.floor((2*i/(.5-Math.abs(l))+r)*l+t+.445);c>=s?l=e.next()-.5:(l=c/s-.93,l=(l<0?-.5:.5)-l,c=e.next()*s);const u=.5-Math.abs(l);if(u<.013&&c>u)continue;const h=Math.floor((2*i/u+r)*l+t+.445);if(c=c*o/(i/(u*u)+r),h>=10){const e=(h+.5)*Math.log(t/h)-t-.9189385332046727+h-(1/12-(1/360-1/(1260*h*h))/(h*h))/h;if(Math.log(c*n)<=e)return h}else if(h>=0){const e=null!==(a=Jr(h))&&void 0!==a?a:0;if(Math.log(c)<=h*Math.log(t)-t-e)return h}}}}})(this,e),this.exponential=e=>((e,t=1)=>(qr(t).isPositive(),()=>-Math.log(1-e.next())/t))(this,e),this.irwinHall=e=>((e,t=1)=>(qr(t).isInt().greaterThanOrEqual(0),()=>{let n=0;for(let r=0;r<t;++r)n+=e.next();return n}))(this,e),this.bates=e=>((e,t=1)=>{qr(t).isInt().isPositive();const n=e.irwinHall(t);return()=>n()/t})(this,e),this.pareto=e=>((e,t=1)=>{qr(t).greaterThanOrEqual(0);const n=1/t;return()=>1/Math.pow(1-e.next(),n)})(this,e),e&&e instanceof kr?this.use(e):this.use(new ei),this._cache={}}get rng(){return this._rng}clone(...e){return e.length?new ti(Wr(...e)):new ti(this.rng.clone())}use(...e){this._rng=Wr(...e)}patch(){if(this._patch)throw new Error("Math.random already patched");this._patch=Math.random,Math.random=this.uniform()}unpatch(){this._patch&&(Math.random=this._patch,delete this._patch)}_memoize(e,t,...n){const r=`${n.join(";")}`;let i=this._cache[e];return void 0!==i&&i.key===r||(i={key:r,distribution:t(this,...n)},this._cache[e]=i),i.distribution}}const ni=new ti;class ri{static distance(e,t,n){let r=e%n,i=e/n|0,o=t%n,s=t/n|0;return Math.max(Math.abs(r-o),Math.abs(i-s))}static circle(e,t,n){let r=[],i=e/n|0,o=e%n,s=i-t;if(s>=0&&s<n)for(let e=o-t;e<o+t;e++)e>=0&&e<n&&r.push(s*n+e);if(s=i+t,s>=0&&s<n)for(let e=o+t;e>o-t;e--)e>=0&&e<n&&r.push(s*n+e);let a=o-t;if(a>=0&&a<n)for(let e=i+t;e>i-t;e--)e>=0&&e<n&&r.push(e*n+a);if(a=o+t,a>=0&&a<n)for(let e=i-t;e<i+t;e++)e>=0&&e<n&&r.push(e*n+a);return r}static plus_sign(e,t){let n=[],r=e/t|0,i=e%t;return i>0&&n.push(e-1),i<t-1&&n.push(e+1),r>0&&n.push(e-t),r<t-1&&n.push(e+t),n}static rand_array_element(e){return e[ni.int(0,e.length-1)]}}class ii{constructor(){this.dir=0,this.type=0,this.above=null}copy(e,t){return this.tribe=e.tribe,this.above=void 0!==t?t:e.above,this}to_json(){return{dir:this.dir,type:this.type,id:this.tileID,above:this.above?.to_json()??null,tribe:this.tribe}}}const oi=e=>{switch(e){case 1:return"ONE";case 2:return"TWO";case 3:return"THREE";case 4:return"FOUR";case 5:return"FIVE";case 0:default:return"ZERO"}},si=class extends ii{constructor(){super(...arguments),this.type=0,this.dir=0}get tileID(){return si.id}get manifest(){return{asset:`${this.tileID}_${oi(this.type)}`,module:"polyscript_std",item:0,type:"obj"}}};let ai=si;ai.prop=.5,ai.id="WATER";const li=class extends ii{constructor(){super(...arguments),this.type=0,this.dir=0}get tileID(){return li.id}get manifest(){return{asset:`${this.tileID}_${oi(this.type)}`,module:"polyscript_std",item:0,type:"obj"}}};let ci=li;ci.prop=.25,ci.id="OCEAN";const ui=class extends ii{get tileID(){return ui.id}get manifest(){return{asset:this.tileID,module:"polyscript_std",item:0,type:"gltf"}}};let hi=ui;hi.prop=1,hi.id="LAND";const di=class extends ii{get tileID(){return di.id}get manifest(){return{asset:this.tileID,module:"polyscript_std",item:0,type:"gltf"}}};let pi=di;pi.prop=1,pi.id="FOREST";const fi=class extends ii{constructor(){super(...arguments),this.dir=3*Math.PI/2}get tileID(){return fi.id}get manifest(){return{asset:this.tileID,module:"polyscript_std",item:0,type:"gltf"}}};let mi=fi;mi.prop=1,mi.id="MOUNTAIN";const vi=class extends ii{constructor(e){super(),this.tribe=e}get tileID(){return vi.id}get manifest(){return{asset:this.tileID,module:"polyscript_std",item:0,type:"gltf"}}};let gi=vi;gi.prop=0,gi.id="CAPITAL";const yi=class extends ii{constructor(){super()}get tileID(){return yi.id}get manifest(){return{asset:this.tileID,module:"polyscript_std",item:0,type:"gltf"}}};let bi=yi;bi.prop=0,bi.id="VILLAGE";const _i=class extends ii{constructor(){super()}get tileID(){return _i.id}get manifest(){return{asset:this.tileID,module:"polyscript_std",item:0,type:"gltf"}}};let wi=_i;wi.prop=0,wi.id="CROP";const Ei=class extends ii{constructor(){super()}get tileID(){return Ei.id}get manifest(){return{asset:this.tileID,module:"polyscript_std",item:0,type:"gltf"}}};let xi=Ei;xi.prop=0,xi.id="FRUIT";const Ti=class extends ii{constructor(){super()}get tileID(){return Ti.id}get manifest(){return{asset:this.tileID,module:"polyscript_std",item:0,type:"gltf"}}};let Ai=Ti;Ai.prop=0,Ai.id="GAME";const Si=class extends ii{constructor(){super()}get tileID(){return Si.id}get manifest(){return{asset:this.tileID,module:"polyscript_std",item:0,type:"gltf"}}};let Oi=Si;Oi.prop=0,Oi.id="FISH";const Ii=class extends ii{constructor(){super()}get tileID(){return Ii.id}get manifest(){return{asset:this.tileID,module:"polyscript_std",item:0,type:"gltf"}}};let Ri=Ii;Ri.prop=0,Ri.id="WHALE";const Mi=class extends ii{get tileID(){return Mi.id}get manifest(){return{asset:this.tileID,module:"polyscript_std",item:0,type:"gltf"}}};let Ci=Mi;Ci.prop=0,Ci.id="METAL";const Li=class extends ii{get tileID(){return Li.id}get manifest(){return{asset:this.tileID,module:"polyscript_std",item:0,type:"gltf"}}};let Ni=Li;Ni.prop=0,Ni.id="RUIN";class ki{constructor(e){this.config=e}create(){const{map:e,capital_cells:t}=this.capitals(this.initial()),n=this.villages(this.terrain(this.distribution(e,t)),t),r=this.config.gen.StructureGeneration(this.resources(n.map,n.village_map),n.village_map,this.config.worldsize);return this.post(r,t)}initial(){const e=new Nr;let t=[];for(let i=0;i<this.config.worldsize;i++){t.push([]);for(let o=0;o<this.config.worldsize;o++)t[i][o]=this.config.gen.biome((n=i/this.config.worldsize-.5,r=o/this.config.worldsize-.5,e.noise(n,r)/2+.5))}var n,r;return t}capitals(e){let t=[],n={};for(let t of this.config.tribes)for(let t=2;t<this.config.worldsize-2;t++)for(let r=2;r<this.config.worldsize-2;r++)e[t][r].tileID===this.config.gen.tiles.land&&(n[t*this.config.worldsize+r]=0);for(let e of this.config.tribes){let e=0;for(let r in n){n[Number(r)]=this.config.worldsize;for(let e of t)n[Number(r)]=Math.min(n[Number(r)],ri.distance(Number(r),e,this.config.worldsize));e=Math.max(e,n[r])}let r=0;for(let t in n)n[t]===e&&r++;let i=ni.int(0,r-1);for(let r of Object.entries(n))r[1]===e&&(0===i&&t.push(parseInt(r[0])),i--)}for(let n=0;n<t.length;n++)e[t[n]/this.config.worldsize|0][t[n]%this.config.worldsize]=new gi(this.config.tribes[n].name);return{map:e,capital_cells:t}}distribution(e,t){let n=[],r=[];for(let e=0;e<t.length;e++)n[e]=t[e],r[e]=[t[e]];for(;n.length!==this.config.worldsize**2;)for(let t=0;t<this.config.tribes.length;t++)if(r[t].length&&!this.config.tribes[t].override){let i=ni.int(0,r[t].length-1),o=r[t][i],s=ri.circle(o,1,this.config.worldsize),a=s.filter((t=>-1===n.indexOf(t)&&e[t/this.config.worldsize|0][t%this.config.worldsize].tileID!==this.config.gen.tiles.water));if(a.length||(a=s.filter((e=>-1===n.indexOf(e)))),a.length){let i=a[ni.int(0,a.length-1)];e[i/this.config.worldsize|0][i%this.config.worldsize].tribe=this.config.tribes[t].name,r[t].push(i),n.push(i)}else r[t].splice(i,1)}return e}terrain(e){for(let t=0;t<this.config.worldsize;t++)for(let n=0;n<this.config.worldsize;n++)e[t][n].tribe||(e[t][n].tribe=e[t][n-1].tribe),e[t][n].tileID===this.config.gen.tiles.land&&null===e[t][n].above?e[t][n]=this.config.gen.LandGeneration(ni.next(),e[t][n]):e[t][n].tileID===this.config.gen.tiles.water&&null===e[t][n].above?e[t][n]=this.config.gen.WaterGeneration(ni.next(),e[t][n]):e[t][n].tileID===this.config.gen.tiles.ocean&&null===e[t][n].above&&(e[t][n]=this.config.gen.OceanGeneration(ni.next(),e[t][n]));return e}villages(e,t){let n=[];for(let t=0;t<this.config.worldsize**2;t++){let r=t/this.config.worldsize|0,i=t%this.config.worldsize;e[r][i].tileID===this.config.gen.tiles.ocean||e[r][i].tileID===mi.id||0===r||r===this.config.worldsize-1||0===i||i===this.config.worldsize-1?n[t]=-1:n[t]=0}let r=[hi.id,pi.id,mi.id];for(let t=0;t<this.config.worldsize**2;t++){let n=t/this.config.worldsize|0,i=t%this.config.worldsize;if(e[n][i].tileID===this.config.gen.tiles.ocean)for(let o of ri.plus_sign(t,this.config.worldsize)){let t=o/this.config.worldsize|0,s=o%this.config.worldsize;if(-1!==r.indexOf(e[t][s].tileID)){e[n][i]=(new ai).copy(e[n][i]);break}}}for(let e of t){n[e]=3;for(let t of ri.circle(e,1,this.config.worldsize))n[t]=Math.max(n[t],2);for(let t of ri.circle(e,2,this.config.worldsize))n[t]=Math.max(n[t],1)}for(;-1!==n.indexOf(0);){let e=ri.rand_array_element(n.map(((e,t)=>0===e?t:null)).filter((e=>null!==e)));n[e]=3;for(let t of ri.circle(e,1,this.config.worldsize))n[t]=Math.max(n[t],2);for(let t of ri.circle(e,2,this.config.worldsize))n[t]=Math.max(n[t],1);for(let t of ri.circle(e,3,this.config.worldsize))n[t]=Math.max(n[t],2);0}return{map:e,village_map:n}}resources(e,t){for(let n=0;n<this.config.worldsize**2;n++){const r=e=>2===t[n]&&ni.next()<e||1===t[n]&&ni.next()<.25*e;let i=n/this.config.worldsize|0,o=n%this.config.worldsize;e[i][o]=this.config.gen.ResourceGeneration(e[i][o],t[n],r)}return e}post(e,t){const n=(t,n)=>{let r=0;for(let i of ri.circle(n,1,this.config.worldsize)){let n=i/this.config.worldsize|0,o=i%this.config.worldsize;e[n][o].above?.tileID===t&&r++}return r},r=(t,r,i,o)=>{let s=n(t.tileID,o);for(;s<i;){let i=ni.int(0,7),a=ri.circle(o,1,this.config.worldsize),l=a[i]/this.config.worldsize|0,c=a[i]%this.config.worldsize;e[l][c]=r.copy(e[l][c],t);for(let t of ri.plus_sign(a[i],this.config.worldsize)){let n=t/this.config.worldsize|0,r=t%this.config.worldsize;e[n][r].tileID===this.config.gen.tiles.ocean&&(e[n][r]=(new ai).copy(e[n][r]))}s=n(t.tileID,o)}};for(let i of t){let t=i/this.config.worldsize|0,o=i%this.config.worldsize;switch(e[t][o].tribe){case"Imperius":r(new xi,new hi,2,i);break;case"Bardur":r(new Ai,new pi,2,i);break;case"Kickoo":let t=n("fish",i);for(;t<2;){let r=ni.int(0,3),o=ri.plus_sign(i,this.config.worldsize),s=o[r]/this.config.worldsize|0,a=o[r]%this.config.worldsize;e[s][a]=(new ai).copy(e[s][a]);for(let t of ri.plus_sign(o[r],this.config.worldsize)){let n=t/this.config.worldsize|0,r=t%this.config.worldsize;if(e[n][r].tileID===this.config.gen.tiles.water){e[n][r]=(new ci).copy(e[n][r]);for(let n of ri.plus_sign(t,this.config.worldsize)){let t=n/this.config.worldsize|0,r=n%this.config.worldsize;if(e[t][r].tileID!==this.config.gen.tiles.water&&e[t][r].tileID!==this.config.gen.tiles.ocean){e[t][r]=(new ai).copy(e[t][r]);break}}}}t=n("fish",i)}break;case"Zebasi":r(new wi,new hi,1,i);break;case"Elyrion":r(new Ai,new pi,2,i);break;case"Polaris":for(let e of ri.circle(i,1,this.config.worldsize));}}const i=Math.PI/2,o=Math.PI,s=3*Math.PI/2;for(let t=0;t<this.config.worldsize**2;t++){let n=t/this.config.worldsize|0,r=t%this.config.worldsize;const a=e[n][r].tileID;if(a===ai.id||a===ci.id){let t=4,l=0;const c=e[n-1]&&e[n-1][r]?.tileID===a,u=e[n+1]&&e[n+1][r]?.tileID===a,h=e[n][r-1]?.tileID===a,d=e[n][r+1]?.tileID===a;c&&t--,u&&t--,h&&t--,d&&t--,1===t?c&&u&&d?l=s:c&&d&&h?l=0:u&&d&&h?l=o:c&&u&&h&&(l=i):2===t?h&&d?(t=5,l=o):c&&u?(t=5,l=i):h&&c?l=i:h&&u?l=o:u&&d&&(l=s):3===t&&(u?l=o:c?l=0:h?l=i:d&&(l=s)),e[n][r].type=t,e[n][r].dir=l}}return e}}class Pi extends s{constructor(e,t,n=null){super(),this.tile=e,this._isCapital=t,this.unit=n,this._selected=1,this._isSelected=!1,this._unit_move=null,this._attacking_unit=null,this.unit&&(this._selected=0),this.events.on(_e.LOG,(e=>{e.id===Te["Selection::Reset"]&&this.reset()}))}set set_unit_move(e){this._unit_move=e}set set_attack_move(e){this._attacking_unit=e}set_unit(e){this.unit=e}get selected(){return this._selected}get is_selected(){return this._isSelected}get get_tile(){return this.tile}get get_unit(){return this.unit}set_unit_prop(e,t){this.unit[e]=t}get terrain_stats(){return null}reset(){this._isSelected=!1,this._unit_move=null,this._attacking_unit=null,this._selected=this.unit?0:1}to_json(){return{tile:this.tile.to_json(),unit:this.unit?.to_json()??null}}cycle(){return this._unit_move?this._unit_move:this._attacking_unit?this._attacking_unit:this._isSelected?1===this._selected?(this._selected=-1,this._isCapital&&this.events.emit({type:"Capital"}),this.tile):(this._selected=this.unit?0:1,this._isSelected=!1,null):(this.events.emit({type:_e.LOG,id:Te["Selection::Reset"]}),0==this._selected?(this._selected=1,this._isSelected=!0,this.unit):(this._selected=-1,this._isSelected=!0,this.tile))}}class zi{static get(e){switch(e){case"Xin-xi":return Di.terrain_props;case"Imperius":return Ui.terrain_props;default:return}}}class Di extends zi{constructor(){super(...arguments),this.name="Xin-xi",this.override=!1}}Di.terrain_props={water:0,forest:1,mountain:1.5,metal:1,fruit:1,crop:1,game:1,fish:1,whale:1};class Ui extends zi{constructor(){super(...arguments),this.name="Imperius",this.override=!1}}Ui.terrain_props={water:0,forest:1,mountain:1,metal:1,fruit:1,crop:1,game:1,fish:1,whale:1};class Fi extends class{}{constructor(){super(...arguments),this.tiles={land:hi.id,water:ai.id,ocean:ci.id},this.general_props={mountain:.15,forest:.4,fruit:.5,crop:.5,fish:.5,game:.5,whale:.4,metal:.5}}biome(e){return e<ci.prop?new ci:e<ai.prop?new ai:new hi}LandGeneration(e,t){if(e<this.general_props.forest*(zi.get(t.tribe)?.forest??0)){let e=new pi;return e.tribe=t.tribe,e}if(e>1-this.general_props.mountain*(zi.get(t.tribe)?.mountain??0)){let e=new mi;return e.tribe=t.tribe,e}return t}WaterGeneration(e,t){return t}OceanGeneration(e,t){return t}ResourceGeneration(e,t,n){switch(e.tileID){case hi.id:{let r=this.general_props.fruit*(zi.get(e.tribe)?.fruit??0),i=this.general_props.crop*(zi.get(e.tribe)?.crop??0);return 3===t?e.above=new bi:n(r*(1-i/2))?e.above=new xi:n(i*(1-r/2))&&(e.above=new wi),e}case pi.id:return 3===t?e=(new hi).copy(e,new bi):n(this.general_props.game*(zi.get(e.tribe)?.game??0))&&(e.above=new Ai),e;case ai.id:return n(this.general_props.fish*(zi.get(e.tribe)?.fish??0))&&(e.above=new Oi),e;case ci.id:return n(this.general_props.whale*(zi.get(e.tribe)?.whale??0))&&(e.above=new Ri),e;case mi.id:return n(this.general_props.metal*(zi.get(e.tribe)?.metal??0))&&(e.above=new Ci),e;default:return e}}StructureGeneration(e,t,n){let r;r=Math.round(n**2/40);let i=Math.round(r/3),o=0,s=0;for(;o<r;){let r=ri.rand_array_element(t.map(((e,t)=>0===e||1===e||-1===e?t:null)).filter((e=>null!==e))),a=r%n,l=e[r/n|0][a];if(l.tileID!==ai.id&&(s<i||l.tileID!==ci.id)){const e=new Ni;e.above=l.above,l.above=e,l.tileID===ci.id&&s++;for(let e of ri.circle(r,1,n))t[e]=Math.max(t[e],2);o++}}return e}}const ji=e=>{let t;switch(e.id){case ai.id:t=new ai;break;case ci.id:t=new ci;break;case hi.id:t=new hi;break;case pi.id:t=new pi;break;case mi.id:t=new mi;break;case gi.id:t=new gi(e.tribe);break;case bi.id:t=new bi;break;case wi.id:t=new wi;break;case xi.id:t=new xi;break;case Ai.id:t=new Ai;break;case Oi.id:t=new Oi;break;case Ri.id:t=new Ri;break;case Ci.id:t=new Ci;break;case Ni.id:t=new Ni;break;default:throw new Error("Unknown type")}return e.above&&(t.above=ji(e.above)),t.type=e.type,t.dir=e.dir,t.tribe=e.tribe,t},Hi=class{constructor(e=11){if(this.size=e,this.assets=new Ie,this.world=[],Hi.INSTANCE)return Hi.INSTANCE;Hi.INSTANCE=this}static Destory(){Hi.INSTANCE=null}get world_size(){return this.size}generate_level(e){return new ki({worldsize:this.size,gen:e,tribes:[new Di,new Ui]}).create()}create_viewable(e){this.world=[];const t={};for(let n=0;n<this.size;n++){this.world.push([]);for(let r=0;r<this.size;r++){const i=e[n][r];if(i.above){const e=i.above;t[e.manifest.asset]||(t[e.manifest.asset]=[]),t[e.manifest.asset].push({z:n,x:r,y:0,dir:e.dir,above:!0,cursor:"pointer",index:0})}t[i.manifest.asset]||(t[i.manifest.asset]=[]),t[i.manifest.asset].push({z:n,x:r,y:0,dir:i.dir,above:!1,cursor:"pointer",index:0}),this.world[n].push(new Pi(i,"CAPITAL"===i.manifest.asset))}}const n=new r.G;n.name="World";for(const r of Object.keys(t))try{const i=t[r][0];if(i.above&&e[i.z][i.x].above?.tileID===r){const o=e[i.z][i.x].above?.manifest;if(!o)throw new Error(`Tile at Row: ${i.z} Column: ${i.x} does not have a tile above it`);const s=this.assets.GetAsset(o.asset,o.module,o.item,o.type),a=new Lr(s.geometry,s.material,t[r]);a.name=o.asset,a.renderOrder=1,n.add(a);continue}const o=e[i.z][i.x].manifest,s=this.assets.GetAsset(o.asset,o.module,o.item,o.type),a=new Lr(s.geometry,s.material,t[r]);a.name=o.asset,n.add(a)}catch(e){console.warn(`Igore: ${e.message}`)}return n}init(e=11){const t=this.generate_level(new Fi);return this.create_viewable(t)}load_json(e){this.size=e.size,this.world=[];const t=e.world,n={};for(let e=0;e<this.size;e++){this.world.push([]);for(let r=0;r<this.size;r++){const i=ji(t[e][r].tile);if(i.above){const t=i.above;n[t.manifest.asset]||(n[t.manifest.asset]=[]),n[t.manifest.asset].push({z:e,x:r,y:0,dir:t.dir,above:!0,cursor:"pointer",index:0})}n[i.manifest.asset]||(n[i.manifest.asset]=[]),n[i.manifest.asset].push({z:e,x:r,y:0,dir:i.dir,above:!1,cursor:"pointer",index:0}),this.world[e].push(new Pi(i,"CAPITAL"===i.manifest.asset))}}const i=new r.G;i.name="World";for(const e of Object.keys(n))try{const t=n[e][0];if(t.above&&this.world[t.z][t.x].get_tile.above?.tileID===e){const r=this.world[t.z][t.x].get_tile.above?.manifest;if(!r)throw new Error(`Tile at Row: ${t.z} Column: ${t.x} does not have a tile above it`);const o=this.assets.GetAsset(r.asset,r.module,r.item,r.type),s=new Lr(o.geometry,o.material,n[e]);s.name=r.asset,s.renderOrder=1,i.add(s);continue}const r=this.world[t.z][t.x].get_tile.manifest,o=this.assets.GetAsset(r.asset,r.module,r.item,r.type),s=new Lr(o.geometry,o.material,n[e]);s.name=r.asset,i.add(s)}catch(e){console.warn(`Igore: ${e.message}`)}return i}to_json(){return{size:this.size,world:this.world.map((e=>e.map((e=>e.to_json()))))}}};let Bi=Hi;Bi.INSTANCE=null;const Vi=Bi,Gi="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";class Xi{constructor(e){this.id=e,this.owner="",this.actions=0,this.veteran=!1,this.movement_type={land:!0,water:!1},this.uuid=function(e=null){null===e&&(e=10);let t="";for(let n=0;n<e;++n)t+=Gi[Math.floor(Math.random()*Gi.length)];return t}(10)}damage(e){return this.health-=e,this.health}to_json(){return{health:this.health,veteran:this.veteran}}}class Wi extends Xi{constructor(e=""){super("WARRIOR"),this.health=10,this.max_health=10,this.defence=2,this.attack=2,this.movement=1,this.range=1,this.actions=1,this.owner=e}get manifest(){return{asset:"UNIT",module:"polyscript_std",type:"gltf",item:0}}}const $i=class extends s{constructor(){if($i.INSTANCE)return $i.INSTANCE;super(),this.current=0,this.current_turn=0,$i.INSTANCE=this,this.players=[{name:"Player 1",stars:5,score:0,citys:1,tribe:new Ui,tech:{climbing:!1}},{name:"Player 2",stars:5,score:0,citys:1,tribe:new Di,tech:{climbing:!0}}]}static destory(){$i.INSTANCE=null}cycle(){this.current_turn++,this.current++,this.events.emit({type:Ee.UnitReset.toString()}),this.events.emit({type:_e.LOG,id:Te["Selection::Reset"]}),this.current>=this.players.length&&(this.current=0),this.current_player.stars+=2}get_next(){let e=this.current+1;return e>=this.players.length&&(e=0),this.get_player(e)}to_json(){return{}}load_json(e){}stats(){let e=[];for(let t=0;t<this.players.length;t++)e.push({score:this.players[t].score,citys:this.players[t].citys,tribe:this.players[t].tribe.name,owner:`Ruled by ${t===this.current?"you":this.players[t].name}`,active:t===this.current});return e.sort(((e,t)=>t.score-e.score))}get_player(e){return this.players[e]}get current_player(){return this.players[this.current]}};let qi=$i;qi.INSTANCE=null;const Ki=qi;class Yi extends s{constructor(e,t){super();const n=t.clone();n.color=new r.C("Crimson"),this.hit=new Cr(e,n,[]),this.hit.name="AttackableUnits",this.hit.renderOrder=1;const i=t.clone();i.color=new r.C("Aqua"),i.depthFunc=r.N,this.movement=new Cr(e,i,[]),this.movement.name="MovementRange",this.movement.renderOrder=1,this.mesh_hit=this.hit,this.mesh_movement=this.movement,this.events.on(_e.LOG,(e=>{e.id===Te["Selection::Reset"]&&this.destory()}))}get current_player(){if(!Ki.INSTANCE)throw new Error("Player Mannager not created");return Ki.INSTANCE.current_player}get_player(e){if(!Ki.INSTANCE)throw new Error("Player Mannager not created");return Ki.INSTANCE.get_player(e)}world_size(){if(!Vi.INSTANCE)throw new Error("world data mannager not created");return Vi.INSTANCE.world_size}get world(){if(!Vi.INSTANCE)throw new Error("world data mannager not created");return Vi.INSTANCE.world}generate_attack(e,t){const n={x:t.x-e,z:t.z-e},r=this.world,i=this.world_size();this.hit.data=[];for(let o=n.z;o<=t.z+e;o++)for(let s=n.x;s<=t.x+e;s++){if(o===t.z&&s===t.x)continue;if(o<0||s<0||o>=i||s>=i)continue;const e=r[o][s].get_unit;e&&e.owner!==this.current_player.tribe.name&&(r[o][s].set_attack_move={defender:{x:s,z:o,y:0},attacker:{x:t.x,z:t.z,y:t.y}},this.hit.data.push({x:s,z:o,y:0,dir:0,cursor:"pointer",above:!1,index:0}))}this.hit.update()}generate_movement(e,t){const n={x:t.x-e,z:t.z-e},r=this.world,i=this.world_size(),o=r[t.x][t.z].get_unit,s=this.current_player.tech;this.mesh_movement.data=[];for(let a=n.z;a<=t.z+e;a++)for(let l=n.x;l<=t.x+e;l++){if(a===t.z&&l===t.x)continue;if(a<0||l<0||a>=i||l>=i)continue;const e=r[a][l]?.get_tile.tileID;(e!==mi.id||s.climbing)&&((e!==ci.id&&e!==ai.id||o?.movement_type.water)&&(r[a][l].get_unit||(this.world[a][l].set_unit_move=t,this.mesh_movement.data.push({x:l,z:a,y:0,dir:0,cursor:"pointer",above:!1,index:0}))))}this.mesh_movement.update()}destory(){this.hit.removeAll(),this.movement.removeAll()}}class Zi{constructor(e){this.is_selector_tile=!0,this.init(e)}async init(e){const t=new Ie;this.asset=t.GetVariant("SELECTOR","polyscript_std"),this.selector=this.asset.scene.children[0],await this.asset.functions.selectVariant(this.selector,"UnitSelector"),this.selector.visible=!1,this.selector.name="Selector",this.selector.renderOrder=1,this.controls=new Yi(this.selector.geometry.clone(),this.selector.userData.variantMaterials.UnitSelector.material.clone()),this.mesh_hit=this.controls.mesh_hit,this.mesh_movement=this.controls.mesh_movement,e.add(this.mesh_movement,this.mesh_hit,this.selector)}get current_player(){if(!Ki.INSTANCE)throw new Error("Player Mannager not created");return Ki.INSTANCE.current_player}async select(e,t){e?(this.selector.position.set(4*t.x,0,4*t.z),e instanceof Xi?(await this.asset.functions.selectVariant(this.selector,"UnitSelector"),0!==e.actions&&e.owner===this.current_player.tribe.name&&(this.controls.generate_movement(e.movement,t),this.controls.generate_attack(e.range,t))):(this.controls.destory(),await this.asset.functions.selectVariant(this.selector,"TileSelector")),this.selector.visible=!0):this.selector.visible=!1}}class Qi extends Cr{constructor(e,t,n){super(e,t,n),this.is_unit=!0,this.renderOrder=2}}const Ji=class extends s{constructor(){if(Ji.INSTANCE)return Ji.INSTANCE;super(),this.units=new Map,this.assets=new Ie,Ji.INSTANCE=this}static destory(){Ji.INSTANCE=null}get current_player(){if(!Ki.INSTANCE)throw new Error("Method not implemented.");return Ki.INSTANCE.current_player}get_player(e){if(!Ki.INSTANCE)throw new Error("Method not implemented.");return Ki.INSTANCE.get_player(e)}get scene(){if(!Ir.INSTANCE)throw new Error("Game instanced not created!");return Ir.INSTANCE.scene}get world(){if(!Vi.INSTANCE)throw new Error("World instanced not created.");return Vi.INSTANCE.world}move_unit(e){if(!e.move)return;const t=this.world[e.move.z][e.move.x].get_unit;if(!t)return;this.world[e.z][e.x].set_unit(t),this.world[e.move.z][e.move.x].set_unit(null);const n=this.units.get(t.id),r=n?.getIndexOf(e.move);if(void 0===r)throw new Error(`No unit at postion X: ${e.move.x}, Z: ${e.move.z}, Y: ${e.move.y}`);n?.setPostion(r,e.x,e.y,e.z),n?.update(),this.events.emit({type:_e.LOG,id:Te["Selection::Reset"]})}attack_unit(e){const t={data:this.world[e.attacker.z][e.attacker.x].get_unit,index:0};t.index=this.units.get(t.data?.id)?.getIndexOf(e.attacker);const n={data:this.world[e.defender.z][e.defender.x].get_unit,index:0};n.index=this.units.get(n.data?.id)?.getIndexOf(e.defender),console.log("Attacker",t.data.health,"Defender",n.data.health);const r=t.data.attack*(t.data.health/t.data.max_health),i=n.data.defence*(n.data.health/n.data.max_health)*1,o=r+i,s=Math.round(r/o*t.data.attack*4.5),a=Math.round(i/o*n.data.defence*4.5);if(n.data.damage(s)<=0)return this.units.get(n.data.id)?.removeInst(n.index),this.world[e.defender.z][e.defender.x].set_unit(null),void this.events.emit({type:_e.LOG,id:Te["Selection::Reset"]});t.data.damage(a),this.events.emit({type:_e.LOG,id:Te["Selection::Reset"]})}create_unit(e,t,n){if(!this.units.has(n.id)){const{asset:e,type:r,item:i,module:o}=n.manifest,s=this.assets.GetAsset(e,o,i,r);return console.log(n.uuid),this.units.set(n.id,new Qi(s.geometry,s.material,[{uuid:n.uuid,x:t.x,y:t.y,z:t.z,dir:0,above:!1,cursor:"pointer",index:0}])),this.scene.getObjectByName("World")?.add(this.units.get(n.id)),void this.world[t.z][t.x].set_unit(n)}this.units.get(n.id)?.addInst({uuid:n.uuid,x:t.x,y:t.y,z:t.z,dir:0,above:!1,index:0,cursor:"pointer"}),this.world[t.z][t.x].set_unit(n)}remove_unit(e,t,n,r){}};let eo=Ji;eo.INSTANCE=null;const to=eo,no=JSON.parse('{"size":11,"world":[[{"tile":{"dir":0,"type":0,"id":"LAND","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":4.71238898038469,"type":3,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":3.141592653589793,"type":1,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":3.141592653589793,"type":1,"id":"WATER","above":{"dir":0,"type":0,"id":"FISH","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":3.141592653589793,"type":1,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":3.141592653589793,"type":1,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":3.141592653589793,"type":5,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":3.141592653589793,"type":2,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":4.71238898038469,"type":2,"id":"OCEAN","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":3.141592653589793,"type":5,"id":"OCEAN","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":1.5707963267948966,"type":3,"id":"OCEAN","above":{"dir":0,"type":0,"id":"RUIN","above":null,"tribe":null},"tribe":"Imperius"},"unit":null}],[{"tile":{"dir":4.71238898038469,"type":0,"id":"MOUNTAIN","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":4.71238898038469,"type":0,"id":"MOUNTAIN","above":{"dir":0,"type":0,"id":"METAL","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":2,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":1,"id":"WATER","above":{"dir":0,"type":0,"id":"FISH","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":1,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":1.5707963267948966,"type":2,"id":"WATER","above":{"dir":0,"type":0,"id":"FISH","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":{"dir":0,"type":0,"id":"FRUIT","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":1.5707963267948966,"type":5,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":3,"id":"OCEAN","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":4.71238898038469,"type":2,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":1.5707963267948966,"type":3,"id":"WATER","above":{"dir":0,"type":0,"id":"FISH","above":null,"tribe":null},"tribe":"Imperius"},"unit":null}],[{"tile":{"dir":0,"type":0,"id":"FOREST","above":{"dir":0,"type":0,"id":"GAME","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":{"dir":0,"type":0,"id":"FRUIT","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":4.71238898038469,"type":0,"id":"MOUNTAIN","above":{"dir":0,"type":0,"id":"METAL","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":4.71238898038469,"type":0,"id":"MOUNTAIN","above":{"dir":0,"type":0,"id":"METAL","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":{"dir":0,"type":0,"id":"FRUIT","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":0,"id":"CAPITAL","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":4.71238898038469,"type":2,"id":"WATER","above":{"dir":0,"type":0,"id":"FISH","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":0,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":3.141592653589793,"type":1,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":1.5707963267948966,"type":1,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":{"dir":0,"type":0,"id":"FRUIT","above":null,"tribe":null},"tribe":"Imperius"},"unit":null}],[{"tile":{"dir":4.71238898038469,"type":0,"id":"MOUNTAIN","above":{"dir":0,"type":0,"id":"METAL","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":0,"id":"FOREST","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":{"dir":0,"type":0,"id":"CROP","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":4.71238898038469,"type":0,"id":"MOUNTAIN","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":4.71238898038469,"type":1,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":0,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":1,"id":"WATER","above":{"dir":0,"type":0,"id":"FISH","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":1.5707963267948966,"type":1,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":0,"id":"FOREST","above":{"dir":0,"type":0,"id":"GAME","above":null,"tribe":null},"tribe":"Imperius"},"unit":null}],[{"tile":{"dir":0,"type":0,"id":"FOREST","above":{"dir":0,"type":0,"id":"GAME","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":{"dir":0,"type":0,"id":"CROP","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":4.71238898038469,"type":0,"id":"MOUNTAIN","above":{"dir":0,"type":0,"id":"METAL","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":0,"id":"FOREST","above":{"dir":0,"type":0,"id":"GAME","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":0,"id":"FOREST","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":4.71238898038469,"type":1,"id":"WATER","above":{"dir":0,"type":0,"id":"FISH","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":1.5707963267948966,"type":2,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":3.141592653589793,"type":3,"id":"OCEAN","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":1.5707963267948966,"type":5,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":{"dir":0,"type":0,"id":"CROP","above":null,"tribe":null},"tribe":"Imperius"},"unit":null}],[{"tile":{"dir":0,"type":0,"id":"FOREST","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":4.71238898038469,"type":0,"id":"MOUNTAIN","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":{"dir":0,"type":0,"id":"VILLAGE","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":0,"id":"FOREST","above":{"dir":0,"type":0,"id":"GAME","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":{"dir":0,"type":0,"id":"FRUIT","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":1.5707963267948966,"type":5,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":4.71238898038469,"type":2,"id":"OCEAN","above":{"dir":0,"type":0,"id":"WHALE","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":1.5707963267948966,"type":1,"id":"OCEAN","above":{"dir":0,"type":0,"id":"WHALE","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":4.71238898038469,"type":1,"id":"WATER","above":{"dir":0,"type":0,"id":"FISH","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":3.141592653589793,"type":2,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null}],[{"tile":{"dir":0,"type":0,"id":"FOREST","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"FOREST","above":{"dir":0,"type":0,"id":"GAME","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"FOREST","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"FOREST","above":{"dir":0,"type":0,"id":"GAME","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":4.71238898038469,"type":0,"id":"MOUNTAIN","above":{"dir":0,"type":0,"id":"METAL","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"FOREST","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":1.5707963267948966,"type":5,"id":"WATER","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":2,"id":"OCEAN","above":{"dir":0,"type":0,"id":"WHALE","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":1.5707963267948966,"type":1,"id":"OCEAN","above":{"dir":0,"type":0,"id":"WHALE","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":4.71238898038469,"type":1,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null},{"tile":{"dir":1.5707963267948966,"type":1,"id":"WATER","above":{"dir":0,"type":0,"id":"FISH","above":null,"tribe":null},"tribe":"Imperius"},"unit":null}],[{"tile":{"dir":4.71238898038469,"type":0,"id":"MOUNTAIN","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":{"dir":0,"type":0,"id":"FRUIT","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":{"dir":0,"type":0,"id":"RUIN","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"FOREST","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":4.71238898038469,"type":0,"id":"MOUNTAIN","above":{"dir":0,"type":0,"id":"METAL","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"CAPITAL","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":4.71238898038469,"type":1,"id":"WATER","above":{"dir":0,"type":0,"id":"FISH","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":3.141592653589793,"type":2,"id":"WATER","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":3,"id":"OCEAN","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":4.71238898038469,"type":1,"id":"WATER","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":1.5707963267948966,"type":2,"id":"WATER","above":null,"tribe":"Imperius"},"unit":null}],[{"tile":{"dir":0,"type":0,"id":"FOREST","above":{"dir":0,"type":0,"id":"GAME","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":{"dir":0,"type":0,"id":"CROP","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":4.71238898038469,"type":0,"id":"MOUNTAIN","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":{"dir":0,"type":0,"id":"CROP","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"FOREST","above":{"dir":0,"type":0,"id":"GAME","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"FOREST","above":{"dir":0,"type":0,"id":"GAME","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":4.71238898038469,"type":1,"id":"WATER","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"WATER","above":{"dir":0,"type":0,"id":"FISH","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":3.141592653589793,"type":1,"id":"WATER","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":1.5707963267948966,"type":2,"id":"WATER","above":{"dir":0,"type":0,"id":"FISH","above":null,"tribe":null},"tribe":"Imperius"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":{"dir":0,"type":0,"id":"RUIN","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null}],[{"tile":{"dir":3.141592653589793,"type":3,"id":"WATER","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":{"dir":0,"type":0,"id":"VILLAGE","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":{"dir":0,"type":0,"id":"FRUIT","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"FOREST","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":{"dir":0,"type":0,"id":"FRUIT","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":{"dir":0,"type":0,"id":"CROP","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":4.71238898038469,"type":1,"id":"WATER","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"WATER","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":1.5707963267948966,"type":2,"id":"WATER","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":null,"tribe":"Xin-xi"},"unit":null}],[{"tile":{"dir":0,"type":3,"id":"WATER","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"FOREST","above":{"dir":0,"type":0,"id":"GAME","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":{"dir":0,"type":0,"id":"FRUIT","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"FOREST","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":4.71238898038469,"type":0,"id":"MOUNTAIN","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":4.71238898038469,"type":3,"id":"WATER","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":1,"id":"WATER","above":null,"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":1.5707963267948966,"type":2,"id":"WATER","above":{"dir":0,"type":0,"id":"FISH","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":{"dir":0,"type":0,"id":"FRUIT","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"FOREST","above":{"dir":0,"type":0,"id":"GAME","above":null,"tribe":null},"tribe":"Xin-xi"},"unit":null},{"tile":{"dir":0,"type":0,"id":"LAND","above":null,"tribe":"Xin-xi"},"unit":null}]]}');let ro,io,oo,so,ao;const lo=()=>{let e=vn(),[t,n]=Ce(0),[r,i]=Ce();return Me((()=>{try{const t=new o;ro=new Ir({canvas:document.getElementById("polytopia")}),io=new Vi,so=new to,ao=new Ki,i(ao.current_player),ro.addToScene(io.load_json(no)),oo=new Zi(ro.scene.getObjectByName("World")),so.create_unit("Imperius",{x:5,z:2,y:0},new Wi("Imperius")),so.create_unit("Xin-xi",{x:5,z:7,y:0},new Wi("Xin-xi")),t.on("Capital",(()=>{console.log("HIT"),e.push("/spawn")})),t.on(_e.LOG,(e=>{if(e.id===Te["ClickEvent::ObjectSelected"]){const t=io.world[e.data.z][e.data.x].cycle();if(console.log("CYCLE",t),t?.hasOwnProperty("index"))return so.move_unit({x:e.data.x,z:e.data.z,y:0,above:!1,index:0,dir:0,cursor:"none",move:t}),void(oo.selector.visible=!1);if(t?.hasOwnProperty("defender"))return void so.attack_unit(t);oo.select(t,e.data)}}))}catch(t){console.error(t),e.replace("/loading")}return function(){Ir.Destory(),Vi.Destory(),to.destory(),Ki.destory(),oo=void 0}}),[]),Re.r.createElement(Re.r.Fragment,null,Re.r.createElement(fn,null,Re.r.createElement(ln,{path:"/game/tech"},Re.r.createElement("div",{id:"game-tech"},Re.r.createElement("button",{type:"button",className:"btn btn-secondary",onClick:()=>{e.push("/game")}},"<"),Re.r.createElement("img",{src:"./head.png",alt:"tech head"}))),Re.r.createElement(ln,{path:"/game/settings"},Re.r.createElement("div",{id:"game-settings"},Re.r.createElement("button",{type:"button",className:"btn btn-secondary",onClick:()=>{e.push("/game")}},"<"),Re.r.createElement("button",{type:"button",className:"btn btn-danger",onClick:()=>{e.push("/home")}},"EXIT TO MENU"))),Re.r.createElement(ln,{path:"/game/stats"},Re.r.createElement("div",{id:"game-stats"},Re.r.createElement("button",{type:"button",className:"btn btn-secondary",onClick:()=>{e.push("/game")}},"<"),Re.r.createElement("div",{className:"gamemode-info"},Re.r.createElement("h6",null,"Game Mode: Infinity"),Re.r.createElement("span",null,"Play howerver you like, forever and ever")),Re.r.createElement("hr",null),Re.r.createElement("h6",null,"Scores"),Re.r.createElement("div",{id:"player-data"},ao?.stats().map((e=>Re.r.createElement("section",{className:"player-info"+(e.active?" active":""),key:e.tribe},Re.r.createElement("img",{src:"./head.png",alt:"player head"}),Re.r.createElement("main",null,Re.r.createElement("div",{className:"tribe-score"},e.tribe,"........................",e.score),Re.r.createElement("span",{className:"controlled-cities"},e.owner,", ",e.citys," city")))))??null))),Re.r.createElement(ln,{path:"/game/confirm"},Re.r.createElement("div",{id:"next-player-confirm"},Re.r.createElement("h4",null,"-Next up-"),Re.r.createElement("span",null,ao?.get_next()?.name??"PLAYER"),Re.r.createElement("img",{src:"./head.png",alt:"player head"}),Re.r.createElement("button",{type:"button",className:"btn btn-primary",onClick:()=>{e.replace("/game")}},"START"),Re.r.createElement("button",{type:"button",className:"btn btn-link",onClick:()=>{e.replace("/home")}},"Exit")))),Re.r.createElement("div",{id:"game-controls"},Re.r.createElement("div",null,Re.r.createElement("button",{type:"button",className:"btn btn-secondary",onClick:()=>{e.push("/game/settings")}},Re.r.createElement("img",{src:"reorder_black_24dp.svg",alt:"settings"})),Re.r.createElement("span",null,"Settings")),Re.r.createElement("div",null,Re.r.createElement("button",{type:"button",className:"btn btn-primary",onClick:()=>{e.push("/game/stats")}},Re.r.createElement("img",{src:"trending_up_black_24dp.svg",alt:"stats"})),Re.r.createElement("span",null,"Game Stats")),Re.r.createElement("div",null,Re.r.createElement("button",{type:"button",className:"btn btn-primary",onClick:()=>{e.push("/game/tech")}},Re.r.createElement("img",{src:"biotech_black_24dp.svg",alt:"tech"})),Re.r.createElement("span",null,"Tech Tree")),Re.r.createElement("div",null,Re.r.createElement("button",{type:"button",className:"btn btn-secondary",onClick:()=>{e.replace("/game/confirm"),ao.cycle(),n(ao.current_turn),i(ao.current_player)}},Re.r.createElement("img",{src:"done_black_24dp.svg",alt:""})),Re.r.createElement("span",null,"End Turn"))),Re.r.createElement("div",{id:"game-data"},Re.r.createElement("div",null,Re.r.createElement("h6",null,"Score"),Re.r.createElement("span",null,r?.score??0)),Re.r.createElement("div",null,Re.r.createElement("h6",null,"Stars (+2)"),Re.r.createElement("span",null,r?.stars??0)),Re.r.createElement("div",null,Re.r.createElement("div",null,"Turn"),Re.r.createElement("span",null,t))))},co=()=>{const e=vn();return Me((()=>{const t=new o;e.replace("/loading"),t.on(_e.LOG,(t=>{t.id===Te["ModuleLoader::InstalledModulesLoaded"]&&setTimeout((()=>e.replace("/")),5e3)}))}),[]),Re.r.createElement(Re.r.Fragment,null,Re.r.createElement(fn,null,Re.r.createElement(ln,{path:"/about"},Re.r.createElement("div",{id:"about-page"},Re.r.createElement("button",{type:"button",className:"btn btn-secondary",onClick:()=>{e.push("/home")}},"<"),Re.r.createElement("h5",{id:"about-page-head"},"- ABOUT -"),Re.r.createElement("main",null,Re.r.createElement("h6",null,"Version Info"),Re.r.createElement("span",null,"THREE.JS ....... ",r.g),Re.r.createElement("span",null,"REACT.JS ....... ",Le),Re.r.createElement("span",null,"BOOTSTRAP ...... ","5.0.2"),Re.r.createElement("span",null,"LOCALFORAGE ...... ","1.9.0"),Re.r.createElement("span",null,"LOADERS.CSS ...... ","0.1.2"),Re.r.createElement("span",null,"JSZIP ...... ",c.i),Re.r.createElement("h6",null,"Debug Info"),Re.r.createElement("span",null,"Build Version ........ ","0.5.120"),Re.r.createElement("span",null,"Vendor ......... ",navigator.vendor),Re.r.createElement("span",null,"UserAgent ......... ",navigator.userAgent)))),Re.r.createElement(ln,{path:"/loading"},Re.r.createElement("div",{className:"wrapper"},Re.r.createElement("div",{className:"loader-inner pacman"},Re.r.createElement("div",null),Re.r.createElement("div",null),Re.r.createElement("div",null),Re.r.createElement("div",null),Re.r.createElement("div",null),Re.r.createElement("div",null),Re.r.createElement("div",null),Re.r.createElement("div",null)))),Re.r.createElement(ln,{path:"/game"},Re.r.createElement(lo,null)),Re.r.createElement(ln,{path:"/"},Re.r.createElement("div",{id:"home"},Re.r.createElement("header",{id:"title"},Re.r.createElement("span",null,"THE BATTLE OF"),Re.r.createElement("h3",null,"POLYTOPIA")),Re.r.createElement("div",null,Re.r.createElement("button",{type:"button",className:"btn btn-primary",onClick:()=>{e.push("/game")}},"Play")),Re.r.createElement("footer",{id:"home-controls"},Re.r.createElement("div",null,Re.r.createElement("button",{type:"button",className:"btn btn-secondary",onClick:()=>{e.push("/about")}},Re.r.createElement("img",{src:"help_outline_white_24dp.svg",alt:"settings"})),Re.r.createElement("span",null,"About")))))),Re.r.createElement("canvas",{id:"polytopia"}))};window.addEventListener("load",(()=>{const e=new o;new Ie;Ne.Z.render(Re.r.createElement(Re.r.StrictMode,null,Re.r.createElement(gn,null,Re.r.createElement(co,null))),document.getElementById("root")),e.on(_e.ERROR,(e=>{console.error(e.id,e.data.error)}))}))}},e=>{"use strict";e.O(0,[532,170,989,968,282],(()=>{return t=9074,e(e.s=t);var t}));e.O()}]);